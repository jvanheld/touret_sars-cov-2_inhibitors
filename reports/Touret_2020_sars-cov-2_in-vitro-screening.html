<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Franck Touret, Magali Gilles, Karine Barral, Antoine Nougaire1, Etienne Decroly, Xavier de Lamballerie, and Bruno Coutard (2020). Statistical analysis by Jacques van Helden" />

<meta name="date" content="2020-04-13" />

<title>Statistical analysis of in vitro screening for inhibitors of viral infection</title>

<script src="Touret_2020_sars-cov-2_in-vitro-screening_files/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="Touret_2020_sars-cov-2_in-vitro-screening_files/bootstrap-3.3.5/css/cerulean.min.css" rel="stylesheet" />
<script src="Touret_2020_sars-cov-2_in-vitro-screening_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="Touret_2020_sars-cov-2_in-vitro-screening_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="Touret_2020_sars-cov-2_in-vitro-screening_files/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="Touret_2020_sars-cov-2_in-vitro-screening_files/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="Touret_2020_sars-cov-2_in-vitro-screening_files/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="Touret_2020_sars-cov-2_in-vitro-screening_files/tocify-1.9.1/jquery.tocify.js"></script>
<script src="Touret_2020_sars-cov-2_in-vitro-screening_files/navigation-1.1/tabsets.js"></script>
<script src="Touret_2020_sars-cov-2_in-vitro-screening_files/navigation-1.1/codefolding.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  { color: #cccccc; background-color: #303030; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ffcfaf; } /* Alert */
code span.an { color: #7f9f7f; font-weight: bold; } /* Annotation */
code span.at { } /* Attribute */
code span.bn { color: #dca3a3; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #f0dfaf; } /* ControlFlow */
code span.ch { color: #dca3a3; } /* Char */
code span.cn { color: #dca3a3; font-weight: bold; } /* Constant */
code span.co { color: #7f9f7f; } /* Comment */
code span.cv { color: #7f9f7f; font-weight: bold; } /* CommentVar */
code span.do { color: #7f9f7f; } /* Documentation */
code span.dt { color: #dfdfbf; } /* DataType */
code span.dv { color: #dcdccc; } /* DecVal */
code span.er { color: #c3bf9f; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #c0bed1; } /* Float */
code span.fu { color: #efef8f; } /* Function */
code span.im { } /* Import */
code span.in { color: #7f9f7f; font-weight: bold; } /* Information */
code span.kw { color: #f0dfaf; } /* Keyword */
code span.op { color: #f0efd0; } /* Operator */
code span.ot { color: #efef8f; } /* Other */
code span.pp { color: #ffcfaf; font-weight: bold; } /* Preprocessor */
code span.sc { color: #dca3a3; } /* SpecialChar */
code span.ss { color: #cc9393; } /* SpecialString */
code span.st { color: #cc9393; } /* String */
code span.va { } /* Variable */
code span.vs { color: #cc9393; } /* VerbatimString */
code span.wa { color: #7f9f7f; font-weight: bold; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Statistical analysis of <em>in vitro</em> screening for inhibitors of viral infection</h1>
<h3 class="subtitle">Normalization and target selection methods</h3>
<h4 class="author">Franck Touret, Magali Gilles, Karine Barral, Antoine Nougaire1, Etienne Decroly, Xavier de Lamballerie, and Bruno Coutard (2020). Statistical analysis by Jacques van Helden</h4>
<h4 class="date">2020-04-13</h4>

</div>


<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co">#### Define colors and pch to highlight specific points on the plots ####</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="co">## Highlight colors</span></a>
<a class="sourceLine" id="cb1-4" data-line-number="4">markColor &lt;-<span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb1-5" data-line-number="5">  <span class="dt">cellCtl =</span> <span class="st">&quot;grey&quot;</span>,</a>
<a class="sourceLine" id="cb1-6" data-line-number="6">  <span class="dt">virusCtl =</span> <span class="st">&quot;red&quot;</span>,</a>
<a class="sourceLine" id="cb1-7" data-line-number="7">  <span class="dt">treated =</span> <span class="st">&quot;blue&quot;</span>,</a>
<a class="sourceLine" id="cb1-8" data-line-number="8">  <span class="dt">Arbidol =</span> <span class="st">&quot;black&quot;</span>,</a>
<a class="sourceLine" id="cb1-9" data-line-number="9">  <span class="dt">Hydroxychloroquite =</span> <span class="st">&quot;orange&quot;</span></a>
<a class="sourceLine" id="cb1-10" data-line-number="10">)</a>
<a class="sourceLine" id="cb1-11" data-line-number="11"></a>
<a class="sourceLine" id="cb1-12" data-line-number="12"><span class="co">## Highlight point shaapes</span></a>
<a class="sourceLine" id="cb1-13" data-line-number="13">markPCh &lt;-<span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb1-14" data-line-number="14">  <span class="dt">cellCtl =</span> <span class="dv">5</span>,</a>
<a class="sourceLine" id="cb1-15" data-line-number="15">  <span class="dt">virusCtl =</span> <span class="dv">17</span>,</a>
<a class="sourceLine" id="cb1-16" data-line-number="16">  <span class="dt">treated =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb1-17" data-line-number="17">  <span class="dt">Arbidol =</span> <span class="dv">19</span>,</a>
<a class="sourceLine" id="cb1-18" data-line-number="18">  <span class="dt">Hydroxychloroquite =</span> <span class="dv">13</span></a>
<a class="sourceLine" id="cb1-19" data-line-number="19">)</a></code></pre></div>
<div id="introduction" class="section level1">
<h1>Introduction</h1>
</div>
<div id="data" class="section level1">
<h1>Data</h1>
<div id="supplementary-data-tables" class="section level2">
<h2>Supplementary data tables</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co">#### Directories ####</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="kw">message</span>(<span class="st">&quot;Directories and files&quot;</span>)</a>
<a class="sourceLine" id="cb2-3" data-line-number="3"></a>
<a class="sourceLine" id="cb2-4" data-line-number="4">dir &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">data =</span> <span class="st">&quot;../data&quot;</span>, </a>
<a class="sourceLine" id="cb2-5" data-line-number="5">         <span class="dt">results =</span> <span class="st">&quot;../results&quot;</span>,</a>
<a class="sourceLine" id="cb2-6" data-line-number="6">         <span class="dt">figures =</span> <span class="st">&quot;figures&quot;</span>)</a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="kw">dir.create</span>(dir[<span class="st">&quot;results&quot;</span>], <span class="dt">showWarnings =</span> <span class="ot">FALSE</span>, <span class="dt">recursive =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb2-8" data-line-number="8"></a>
<a class="sourceLine" id="cb2-9" data-line-number="9"><span class="co">## Data file</span></a>
<a class="sourceLine" id="cb2-10" data-line-number="10">supTableFile &lt;-<span class="st"> </span><span class="kw">file.path</span>(dir[<span class="st">&quot;data&quot;</span>], <span class="st">&quot;suppl-table_Touret-2020.xlsx&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="co">#### Load data from Excel workbook ####</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="kw">message</span>(<span class="st">&quot;Loading data from excel workbook.&quot;</span>)</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">supTable &lt;-<span class="st"> </span><span class="kw">read.xlsx</span>(<span class="dt">file =</span> supTableFile, <span class="dt">sheetIndex =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="co">#supTable &lt;- read_xlsx(path = supTableFile, sheet = 1, col_names = TRUE)</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="co"># dim(supTable)</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="co"># View(supTable)</span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="co"># names(supTable)</span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8"></a>
<a class="sourceLine" id="cb3-9" data-line-number="9">colNames &lt;-<span class="st"> </span><span class="kw">colnames</span>(supTable)</a>
<a class="sourceLine" id="cb3-10" data-line-number="10">colNames[<span class="dv">1</span>] &lt;-<span class="st"> &quot;ID&quot;</span></a>
<a class="sourceLine" id="cb3-11" data-line-number="11"><span class="kw">colnames</span>(supTable) &lt;-<span class="st"> </span>colNames</a>
<a class="sourceLine" id="cb3-12" data-line-number="12"></a>
<a class="sourceLine" id="cb3-13" data-line-number="13"><span class="co">## Suppress the last row (NA)</span></a>
<a class="sourceLine" id="cb3-14" data-line-number="14">supTable &lt;-<span class="st"> </span>supTable[<span class="op">!</span><span class="kw">is.na</span>(supTable<span class="op">$</span>ID), ]</a>
<a class="sourceLine" id="cb3-15" data-line-number="15"><span class="co"># dim(supTable)</span></a>
<a class="sourceLine" id="cb3-16" data-line-number="16"></a>
<a class="sourceLine" id="cb3-17" data-line-number="17"><span class="co">## Assign row names for convenience</span></a>
<a class="sourceLine" id="cb3-18" data-line-number="18"><span class="co"># View(supTable)</span></a>
<a class="sourceLine" id="cb3-19" data-line-number="19"></a>
<a class="sourceLine" id="cb3-20" data-line-number="20"></a>
<a class="sourceLine" id="cb3-21" data-line-number="21"><span class="co">## Extract plate number</span></a>
<a class="sourceLine" id="cb3-22" data-line-number="22">supTable<span class="op">$</span>plateNumber &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">substr</span>(supTable[, <span class="dv">1</span>], <span class="dt">start =</span> <span class="dv">1</span>, <span class="dt">stop =</span> <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb3-23" data-line-number="23"><span class="co"># table(supTable$plateNumber)</span></a>
<a class="sourceLine" id="cb3-24" data-line-number="24">plateNumbers &lt;-<span class="st"> </span><span class="kw">unique</span>(supTable<span class="op">$</span>plateNumber)</a>
<a class="sourceLine" id="cb3-25" data-line-number="25"></a>
<a class="sourceLine" id="cb3-26" data-line-number="26"><span class="co">## Assign a color to each molecule according to its plate number</span></a>
<a class="sourceLine" id="cb3-27" data-line-number="27">plateColor &lt;-<span class="st"> </span><span class="kw">rainbow</span>(<span class="dt">n =</span> <span class="kw">length</span>(plateNumbers))</a>
<a class="sourceLine" id="cb3-28" data-line-number="28"><span class="kw">names</span>(plateColor) &lt;-<span class="st"> </span><span class="kw">unique</span>(supTable<span class="op">$</span>plateNumber)</a>
<a class="sourceLine" id="cb3-29" data-line-number="29"></a>
<a class="sourceLine" id="cb3-30" data-line-number="30">supTable<span class="op">$</span>color &lt;-<span class="st"> </span>plateColor[supTable<span class="op">$</span>plateNumber]</a>
<a class="sourceLine" id="cb3-31" data-line-number="31"><span class="kw">message</span>(<span class="st">&quot;</span><span class="ch">\t</span><span class="st">Loaded main table with &quot;</span>, <span class="kw">nrow</span>(supTable), <span class="st">&quot; rows &quot;</span>)</a></code></pre></div>
<p>The supplementary table downloaded from bioRxiv contains 1520 molecules.</p>
</div>
</div>
<div id="raw-viability-measurements" class="section level1">
<h1>Raw viability measurements</h1>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="co">#### Load raw data ####</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="kw">message</span>(<span class="st">&quot;Loading raw data&quot;</span>)</a>
<a class="sourceLine" id="cb4-3" data-line-number="3">nbPlates &lt;-<span class="st"> </span><span class="dv">19</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4">rowsPerPlate &lt;-<span class="st"> </span><span class="dv">8</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5">columnsPerPlate &lt;-<span class="st"> </span><span class="dv">12</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"></a>
<a class="sourceLine" id="cb4-7" data-line-number="7">dataPerPlate &lt;-<span class="st"> </span><span class="kw">list</span>()</a>
<a class="sourceLine" id="cb4-8" data-line-number="8"></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="co">## Control 1: uninfected cells</span></a>
<a class="sourceLine" id="cb4-10" data-line-number="10">cellControl &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">matrix</span>(<span class="dt">ncol =</span> <span class="dv">8</span>, <span class="dt">nrow =</span> nbPlates))</a>
<a class="sourceLine" id="cb4-11" data-line-number="11"><span class="kw">colnames</span>(cellControl) &lt;-<span class="st"> </span>LETTERS[<span class="dv">1</span><span class="op">:</span>rowsPerPlate]</a>
<a class="sourceLine" id="cb4-12" data-line-number="12"></a>
<a class="sourceLine" id="cb4-13" data-line-number="13"><span class="co">## Control 2: untreated infected cells</span></a>
<a class="sourceLine" id="cb4-14" data-line-number="14">virusControl &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">matrix</span>(<span class="dt">ncol =</span> <span class="dv">6</span>, <span class="dt">nrow =</span> nbPlates))</a>
<a class="sourceLine" id="cb4-15" data-line-number="15"><span class="kw">colnames</span>(virusControl) &lt;-<span class="st"> </span>LETTERS[<span class="dv">3</span><span class="op">:</span>rowsPerPlate]</a>
<a class="sourceLine" id="cb4-16" data-line-number="16"></a>
<a class="sourceLine" id="cb4-17" data-line-number="17"><span class="co">## Prepare a table to store the raw data</span></a>
<a class="sourceLine" id="cb4-18" data-line-number="18">inhibTable &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">matrix</span>(<span class="dt">ncol =</span> <span class="dv">8</span>, <span class="dt">nrow =</span> nbPlates<span class="op">*</span>rowsPerPlate <span class="op">*</span><span class="st"> </span>columnsPerPlate))</a>
<a class="sourceLine" id="cb4-19" data-line-number="19"><span class="kw">colnames</span>(inhibTable) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;ID&quot;</span>, </a>
<a class="sourceLine" id="cb4-20" data-line-number="20">                          <span class="st">&quot;Plate&quot;</span>, </a>
<a class="sourceLine" id="cb4-21" data-line-number="21">                          <span class="st">&quot;Row&quot;</span>, </a>
<a class="sourceLine" id="cb4-22" data-line-number="22">                          <span class="st">&quot;Column&quot;</span>, </a>
<a class="sourceLine" id="cb4-23" data-line-number="23">                          <span class="st">&quot;viability&quot;</span>, </a>
<a class="sourceLine" id="cb4-24" data-line-number="24">                          <span class="st">&quot;cellControl&quot;</span>, </a>
<a class="sourceLine" id="cb4-25" data-line-number="25">                          <span class="st">&quot;virusControl&quot;</span>,</a>
<a class="sourceLine" id="cb4-26" data-line-number="26">                          <span class="st">&quot;Chemical.name&quot;</span>)</a>
<a class="sourceLine" id="cb4-27" data-line-number="27"></a>
<a class="sourceLine" id="cb4-28" data-line-number="28">i &lt;-<span class="st"> </span><span class="dv">2</span> <span class="co">## for quick test</span></a>
<a class="sourceLine" id="cb4-29" data-line-number="29"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>nbPlates) {</a>
<a class="sourceLine" id="cb4-30" data-line-number="30">  <span class="kw">message</span>(<span class="st">&quot;</span><span class="ch">\t</span><span class="st">Loading data from plate &quot;</span>, i)</a>
<a class="sourceLine" id="cb4-31" data-line-number="31">  sheetName &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;Plate&quot;</span>, i)</a>
<a class="sourceLine" id="cb4-32" data-line-number="32">  </a>
<a class="sourceLine" id="cb4-33" data-line-number="33">  <span class="co">## Raw measures</span></a>
<a class="sourceLine" id="cb4-34" data-line-number="34">  <span class="co"># rawMeasures &lt;- read.xlsx(file = supTableFile, </span></a>
<a class="sourceLine" id="cb4-35" data-line-number="35">  <span class="co">#                          sheetName = sheetName, </span></a>
<a class="sourceLine" id="cb4-36" data-line-number="36">  <span class="co">#                          rowIndex = 30:37,</span></a>
<a class="sourceLine" id="cb4-37" data-line-number="37">  <span class="co">#                          colIndex = 2:13, header = FALSE)</span></a>
<a class="sourceLine" id="cb4-38" data-line-number="38">  rawMeasures &lt;-<span class="st"> </span><span class="kw">read_xlsx</span>(<span class="dt">path =</span> supTableFile, <span class="dt">col_names =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb4-39" data-line-number="39">                           <span class="dt">sheet =</span> sheetName, </a>
<a class="sourceLine" id="cb4-40" data-line-number="40">                           <span class="dt">range =</span> <span class="st">&quot;B30:M37&quot;</span>, <span class="dt">progress =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb4-41" data-line-number="41">  rawMeasures &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(rawMeasures)</a>
<a class="sourceLine" id="cb4-42" data-line-number="42">  <span class="kw">rownames</span>(rawMeasures) &lt;-<span class="st"> </span>LETTERS[<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(rawMeasures)]</a>
<a class="sourceLine" id="cb4-43" data-line-number="43">  <span class="kw">colnames</span>(rawMeasures) &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(rawMeasures)</a>
<a class="sourceLine" id="cb4-44" data-line-number="44">  <span class="co"># dim(rawMeasures)</span></a>
<a class="sourceLine" id="cb4-45" data-line-number="45">  <span class="co"># View(rawMeasures)</span></a>
<a class="sourceLine" id="cb4-46" data-line-number="46"></a>
<a class="sourceLine" id="cb4-47" data-line-number="47">  <span class="co">## Extract control values</span></a>
<a class="sourceLine" id="cb4-48" data-line-number="48">  cellControl[i, ] &lt;-<span class="st"> </span><span class="kw">as.vector</span>(rawMeasures[,<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb4-49" data-line-number="49">  virusControl[i, ] &lt;-<span class="st"> </span><span class="kw">as.vector</span>(rawMeasures[<span class="dv">3</span><span class="op">:</span><span class="dv">8</span>,<span class="dv">12</span>])</a>
<a class="sourceLine" id="cb4-50" data-line-number="50">  plateVC &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">unlist</span>(virusControl[i, ]))</a>
<a class="sourceLine" id="cb4-51" data-line-number="51">  plateCC &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">unlist</span>(cellControl[i, ]))</a>
<a class="sourceLine" id="cb4-52" data-line-number="52"></a>
<a class="sourceLine" id="cb4-53" data-line-number="53">  <span class="co">## Extract all values</span></a>
<a class="sourceLine" id="cb4-54" data-line-number="54">  r &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb4-55" data-line-number="55">  <span class="cf">for</span> (r <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>rowsPerPlate) {</a>
<a class="sourceLine" id="cb4-56" data-line-number="56">    currentRowName &lt;-<span class="st"> </span>LETTERS[r]</a>
<a class="sourceLine" id="cb4-57" data-line-number="57">    currentValues &lt;-<span class="st"> </span><span class="kw">unlist</span>(rawMeasures[currentRowName,])</a>
<a class="sourceLine" id="cb4-58" data-line-number="58">    id &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">sprintf</span>(<span class="st">&quot;%02d&quot;</span>,i),</a>
<a class="sourceLine" id="cb4-59" data-line-number="59">                 currentRowName, </a>
<a class="sourceLine" id="cb4-60" data-line-number="60">                 <span class="kw">sprintf</span>(<span class="st">&quot;%02d&quot;</span>,<span class="dv">1</span><span class="op">:</span>columnsPerPlate))</a>
<a class="sourceLine" id="cb4-61" data-line-number="61">    </a>
<a class="sourceLine" id="cb4-62" data-line-number="62">    <span class="co">## Compute the start index for the data table</span></a>
<a class="sourceLine" id="cb4-63" data-line-number="63">    startIndex &lt;-<span class="st"> </span>(i <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>(rowsPerPlate <span class="op">*</span><span class="st"> </span>columnsPerPlate) <span class="op">+</span><span class="st"> </span>(r <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>columnsPerPlate <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb4-64" data-line-number="64">    <span class="co"># message(cat(&quot;\t\tIDs\t&quot;,  startIndex, id))</span></a>
<a class="sourceLine" id="cb4-65" data-line-number="65">    indices &lt;-<span class="st"> </span>startIndex<span class="op">:</span>(startIndex <span class="op">+</span><span class="st"> </span>columnsPerPlate <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb4-66" data-line-number="66">    <span class="co"># length(indices)</span></a>
<a class="sourceLine" id="cb4-67" data-line-number="67">    inhibTable[indices, <span class="st">&quot;ID&quot;</span>] &lt;-<span class="st"> </span>id</a>
<a class="sourceLine" id="cb4-68" data-line-number="68">    inhibTable[indices, <span class="st">&quot;Plate&quot;</span>] &lt;-<span class="st"> </span>i</a>
<a class="sourceLine" id="cb4-69" data-line-number="69">    inhibTable[indices, <span class="st">&quot;Row&quot;</span>] &lt;-<span class="st"> </span>currentRowName</a>
<a class="sourceLine" id="cb4-70" data-line-number="70">    inhibTable[indices, <span class="st">&quot;Column&quot;</span>] &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span>columnsPerPlate</a>
<a class="sourceLine" id="cb4-71" data-line-number="71">    inhibTable[indices, <span class="st">&quot;viability&quot;</span>] &lt;-<span class="st"> </span>currentValues</a>
<a class="sourceLine" id="cb4-72" data-line-number="72">    inhibTable[indices, <span class="st">&quot;virusControl&quot;</span>] &lt;-<span class="st"> </span>plateVC</a>
<a class="sourceLine" id="cb4-73" data-line-number="73">    inhibTable[indices, <span class="st">&quot;cellControl&quot;</span>] &lt;-<span class="st"> </span>plateCC</a>
<a class="sourceLine" id="cb4-74" data-line-number="74">  }</a>
<a class="sourceLine" id="cb4-75" data-line-number="75">  </a>
<a class="sourceLine" id="cb4-76" data-line-number="76">  dataPerPlate[[i]] &lt;-<span class="st"> </span><span class="kw">list</span>()</a>
<a class="sourceLine" id="cb4-77" data-line-number="77">  dataPerPlate[[i]][[<span class="st">&quot;rawMeasures&quot;</span>]] &lt;-<span class="st"> </span>rawMeasures</a>
<a class="sourceLine" id="cb4-78" data-line-number="78">}</a>
<a class="sourceLine" id="cb4-79" data-line-number="79"></a>
<a class="sourceLine" id="cb4-80" data-line-number="80"><span class="co"># dim(inhibTable)</span></a>
<a class="sourceLine" id="cb4-81" data-line-number="81"><span class="co"># names(inhibTable)</span></a>
<a class="sourceLine" id="cb4-82" data-line-number="82"><span class="co"># View(inhibTable)</span></a>
<a class="sourceLine" id="cb4-83" data-line-number="83"><span class="co"># View(dataPerPlate)</span></a>
<a class="sourceLine" id="cb4-84" data-line-number="84"><span class="co"># View(dataPerPlate[[1]][[&quot;rawMeasures&quot;]])</span></a>
<a class="sourceLine" id="cb4-85" data-line-number="85"><span class="co"># table(inhibTable$Row, inhibTable$Column) ## Check that there are 19 entries for each plate position</span></a>
<a class="sourceLine" id="cb4-86" data-line-number="86"></a>
<a class="sourceLine" id="cb4-87" data-line-number="87"><span class="co">## Use the plate well ID as rowname</span></a>
<a class="sourceLine" id="cb4-88" data-line-number="88"><span class="kw">rownames</span>(inhibTable) &lt;-<span class="st"> </span>inhibTable<span class="op">$</span>ID</a>
<a class="sourceLine" id="cb4-89" data-line-number="89"></a>
<a class="sourceLine" id="cb4-90" data-line-number="90"><span class="co">## Check consistency between IDs in supplementary Touret Table 1</span></a>
<a class="sourceLine" id="cb4-91" data-line-number="91"><span class="co">##  and those created here</span></a>
<a class="sourceLine" id="cb4-92" data-line-number="92">touretIDs &lt;-<span class="st"> </span><span class="kw">unlist</span>(supTable<span class="op">$</span>ID)</a>
<a class="sourceLine" id="cb4-93" data-line-number="93"><span class="co"># length(touretIDs)</span></a>
<a class="sourceLine" id="cb4-94" data-line-number="94">inhibIDs &lt;-<span class="st"> </span>inhibTable<span class="op">$</span>ID</a>
<a class="sourceLine" id="cb4-95" data-line-number="95"><span class="co"># length(inhibIDs)</span></a>
<a class="sourceLine" id="cb4-96" data-line-number="96"></a>
<a class="sourceLine" id="cb4-97" data-line-number="97"><span class="co">## Cell control: uninfected cells</span></a>
<a class="sourceLine" id="cb4-98" data-line-number="98">cellControlIndices &lt;-<span class="st"> </span>inhibTable<span class="op">$</span>Column <span class="op">==</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb4-99" data-line-number="99">inhibTable[cellControlIndices, <span class="st">&quot;Chemical.name&quot;</span>] &lt;-<span class="st"> &quot;uninfected&quot;</span></a>
<a class="sourceLine" id="cb4-100" data-line-number="100"></a>
<a class="sourceLine" id="cb4-101" data-line-number="101"><span class="co">## Virus control: infected cells, no treatment</span></a>
<a class="sourceLine" id="cb4-102" data-line-number="102">virusControlIndices &lt;-<span class="st"> </span>(inhibTable<span class="op">$</span>Column <span class="op">==</span><span class="st"> </span><span class="dv">12</span>) <span class="op">&amp;</span><span class="st"> </span>(inhibTable<span class="op">$</span>Row <span class="op">%in%</span><span class="st"> </span>LETTERS[<span class="dv">3</span><span class="op">:</span><span class="dv">8</span>])</a>
<a class="sourceLine" id="cb4-103" data-line-number="103"><span class="co"># table(virusControlIndices)</span></a>
<a class="sourceLine" id="cb4-104" data-line-number="104">inhibTable[virusControlIndices, <span class="st">&quot;Chemical.name&quot;</span>] &lt;-<span class="st"> &quot;infected no treatment&quot;</span></a>
<a class="sourceLine" id="cb4-105" data-line-number="105"></a>
<a class="sourceLine" id="cb4-106" data-line-number="106"><span class="co">## Define the treatment type</span></a>
<a class="sourceLine" id="cb4-107" data-line-number="107">wellType &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb4-108" data-line-number="108">wellType[cellControlIndices] &lt;-<span class="st"> &quot;cellCtl&quot;</span></a>
<a class="sourceLine" id="cb4-109" data-line-number="109">wellType[virusControlIndices] &lt;-<span class="st"> &quot;virusCtl&quot;</span></a>
<a class="sourceLine" id="cb4-110" data-line-number="110"></a>
<a class="sourceLine" id="cb4-111" data-line-number="111"><span class="co">## All the other ones are treated with a given molecule</span></a>
<a class="sourceLine" id="cb4-112" data-line-number="112">wellType[<span class="op">!</span>(virusControlIndices <span class="op">|</span><span class="st"> </span>cellControlIndices)] &lt;-<span class="st"> &quot;treated&quot;</span></a>
<a class="sourceLine" id="cb4-113" data-line-number="113"></a>
<a class="sourceLine" id="cb4-114" data-line-number="114">inhibTable[, <span class="st">&quot;wellType&quot;</span>] &lt;-<span class="st"> </span>wellType</a>
<a class="sourceLine" id="cb4-115" data-line-number="115"></a>
<a class="sourceLine" id="cb4-116" data-line-number="116"></a>
<a class="sourceLine" id="cb4-117" data-line-number="117"><span class="co">#### Retrieve fields from the bioRxiv supplementary Table 1 ####</span></a>
<a class="sourceLine" id="cb4-118" data-line-number="118"></a>
<a class="sourceLine" id="cb4-119" data-line-number="119"><span class="cf">for</span> (field <span class="cf">in</span> <span class="kw">c</span>(<span class="st">&quot;Chemical.name&quot;</span>,</a>
<a class="sourceLine" id="cb4-120" data-line-number="120">                <span class="st">&quot;Broad.Therapeutic.class&quot;</span>,</a>
<a class="sourceLine" id="cb4-121" data-line-number="121">                <span class="st">&quot;Reported.therapeutic.effect&quot;</span>,</a>
<a class="sourceLine" id="cb4-122" data-line-number="122">                <span class="st">&quot;Inhibition.Index&quot;</span>)) {</a>
<a class="sourceLine" id="cb4-123" data-line-number="123">  inhibTable[, field] &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb4-124" data-line-number="124">  inhibTable[inhibTable<span class="op">$</span>ID <span class="op">%in%</span><span class="st"> </span>touretIDs, field] &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb4-125" data-line-number="125"><span class="st">    </span><span class="kw">as.vector</span>(supTable[, field])</a>
<a class="sourceLine" id="cb4-126" data-line-number="126">}</a>
<a class="sourceLine" id="cb4-127" data-line-number="127"></a>
<a class="sourceLine" id="cb4-128" data-line-number="128"></a>
<a class="sourceLine" id="cb4-129" data-line-number="129"><span class="co"># ## Retrieve the molecule names from Table 1 of the bioRxiv workbook</span></a>
<a class="sourceLine" id="cb4-130" data-line-number="130"><span class="co"># inhibTable$Chemical.name &lt;- NA</span></a>
<a class="sourceLine" id="cb4-131" data-line-number="131"><span class="co"># inhibTable[inhibTable$ID %in% touretIDs, &quot;Chemical.name&quot;] &lt;- </span></a>
<a class="sourceLine" id="cb4-132" data-line-number="132"><span class="co">#   as.vector(supTable$Chemical.name)</span></a>
<a class="sourceLine" id="cb4-133" data-line-number="133"></a>
<a class="sourceLine" id="cb4-134" data-line-number="134"></a>
<a class="sourceLine" id="cb4-135" data-line-number="135"></a>
<a class="sourceLine" id="cb4-136" data-line-number="136"></a>
<a class="sourceLine" id="cb4-137" data-line-number="137"><span class="kw">kable</span>(<span class="kw">t</span>(<span class="kw">table</span>(inhibTable<span class="op">$</span>wellType)), <span class="dt">caption =</span> <span class="st">&quot;Well types. cellCtl: no infection; virusCtl: infection without treatment; treated: inhected and treated with one molecule&quot;</span>, )</a></code></pre></div>
<table>
<caption>Well types. cellCtl: no infection; virusCtl: infection without treatment; treated: inhected and treated with one molecule</caption>
<thead>
<tr class="header">
<th align="right">cellCtl</th>
<th align="right">treated</th>
<th align="right">virusCtl</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">152</td>
<td align="right">1558</td>
<td align="right">114</td>
</tr>
</tbody>
</table>
<p>The raw data contains 19 plates with 8 rows (indiced A to H) and 12 columns (indiced from 1 to 12. )</p>
<p>The raw data consists of viability measurements in cell cultures.</p>
<div id="distribution-of-raw-viability-values" class="section level2">
<h2>Distribution of raw viability values</h2>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="co">#### Distribution of raw measurements ####</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2">classInterval &lt;-<span class="st"> </span><span class="dv">500</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="co"># xmin &lt;- floor(min(inhibTable$viability)/classInterval) * classInterval</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4">xmin &lt;-<span class="st"> </span><span class="dv">0</span> <span class="co">## Intently start the scale at0 to show the remnant viability</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5">xmax &lt;-<span class="st"> </span><span class="kw">ceiling</span>(<span class="kw">max</span>(inhibTable<span class="op">$</span>viability)<span class="op">/</span>classInterval) <span class="op">*</span><span class="st"> </span>classInterval</a>
<a class="sourceLine" id="cb5-6" data-line-number="6">breaks =<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from =</span> xmin, <span class="dt">to =</span> xmax, <span class="dt">by =</span> classInterval)</a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="co"># range(inhibTable$viability)</span></a>
<a class="sourceLine" id="cb5-8" data-line-number="8"></a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb5-11" data-line-number="11"><span class="kw">hist</span>(inhibTable[wellType <span class="op">==</span><span class="st"> &quot;cellCtl&quot;</span>, <span class="st">&quot;viability&quot;</span>], </a>
<a class="sourceLine" id="cb5-12" data-line-number="12">     <span class="dt">main =</span> <span class="st">&quot;Uninfected (cell control)&quot;</span>,</a>
<a class="sourceLine" id="cb5-13" data-line-number="13">     <span class="dt">xlab =</span> <span class="st">&quot;Viability&quot;</span>,</a>
<a class="sourceLine" id="cb5-14" data-line-number="14">     <span class="dt">ylab =</span> <span class="st">&quot;Number of plate wells&quot;</span>,</a>
<a class="sourceLine" id="cb5-15" data-line-number="15">     <span class="dt">las =</span> <span class="dv">1</span>, </a>
<a class="sourceLine" id="cb5-16" data-line-number="16">     <span class="dt">breaks =</span> breaks, <span class="dt">col =</span> <span class="st">&quot;palegreen&quot;</span>, <span class="dt">border =</span> <span class="st">&quot;palegreen&quot;</span>)</a>
<a class="sourceLine" id="cb5-17" data-line-number="17"></a>
<a class="sourceLine" id="cb5-18" data-line-number="18"><span class="kw">hist</span>(inhibTable[wellType <span class="op">==</span><span class="st"> &quot;virusCtl&quot;</span>, <span class="st">&quot;viability&quot;</span>], </a>
<a class="sourceLine" id="cb5-19" data-line-number="19">     <span class="dt">main =</span> <span class="st">&quot;Infected, no treatment (virus control))&quot;</span>,</a>
<a class="sourceLine" id="cb5-20" data-line-number="20">     <span class="dt">xlab =</span> <span class="st">&quot;Viability&quot;</span>,</a>
<a class="sourceLine" id="cb5-21" data-line-number="21">     <span class="dt">ylab =</span> <span class="st">&quot;Number of plate wells&quot;</span>,</a>
<a class="sourceLine" id="cb5-22" data-line-number="22">     <span class="dt">las =</span> <span class="dv">1</span>, </a>
<a class="sourceLine" id="cb5-23" data-line-number="23">     <span class="dt">breaks =</span> breaks, <span class="dt">col =</span> <span class="st">&quot;orange&quot;</span>, <span class="dt">border =</span> <span class="st">&quot;orange&quot;</span>)</a>
<a class="sourceLine" id="cb5-24" data-line-number="24"></a>
<a class="sourceLine" id="cb5-25" data-line-number="25"><span class="kw">hist</span>(inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;viability&quot;</span>], </a>
<a class="sourceLine" id="cb5-26" data-line-number="26">     <span class="dt">main =</span> <span class="st">&quot;Treated cells&quot;</span>,</a>
<a class="sourceLine" id="cb5-27" data-line-number="27">     <span class="dt">xlab =</span> <span class="st">&quot;Viability&quot;</span>,</a>
<a class="sourceLine" id="cb5-28" data-line-number="28">     <span class="dt">ylab =</span> <span class="st">&quot;Number of plate wells&quot;</span>,</a>
<a class="sourceLine" id="cb5-29" data-line-number="29">     <span class="dt">las =</span> <span class="dv">1</span>, </a>
<a class="sourceLine" id="cb5-30" data-line-number="30">     <span class="dt">breaks =</span> breaks, <span class="dt">col =</span> <span class="st">&quot;#AACCFF&quot;</span>, <span class="dt">border =</span> <span class="st">&quot;#AACCFF&quot;</span>)</a></code></pre></div>
<div class="figure" style="text-align: center">
<img src="figures/touret_sars-cov-2_inhibitorsraw_viab_distrib-1.png" alt="Distributions of the raw viability measures. Top: uninfected cells. Middle: infected cells without treatment. Bottom: infected cells treated with a specific molecule. " width="80%" />
<p class="caption">
Distributions of the raw viability measures. Top: uninfected cells. Middle: infected cells without treatment. Bottom: infected cells treated with a specific molecule.
</p>
</div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw">par</span>(par.ori)</a></code></pre></div>
<ul>
<li><p><strong><em>Cell control</em></strong>.</p>
<ul>
<li>The top panel (green) shows the distribution of viability measurements in controls cultures, where the cells were neither infected by the virus nor treated with a drug.</li>
<li>Each plate contains 8 wells with uninfected cells (total = 152).</li>
</ul></li>
<li><p><strong><em>Virus control</em></strong>.</p>
<ul>
<li>The middle panel (orange) shows the distribution of viability measurements in infected cells without drug treatment</li>
<li>The virus control was performed on 6 wells per plate, total = 114).</li>
</ul></li>
<li><p><strong><em>Treated cells</em></strong>.</p>
<ul>
<li><p>The bottom distribution (pale blue) shows the viability values for cells infected and treated with a given drug.</p></li>
<li><p>Note that each drug was tested on a single well (no replicates). Indeed, in order to face the COVID-19 emergency, the study attempted to test as fast as possible a wide range of molecules. This first screening was thus performed without replicates. This has to be taken into account for the normalization, which should be done with no estimation of the variance for the individual drugs.</p></li>
<li><p>The distribution is strongly asymmetrical, and seems bi- or multi-modal. This distribution can be considered as a mixture between different distributions;</p>
<ul>
<li>all the drugs that have no inhibitory effect (and are thus expected to have a viability similar to the virus control);</li>
<li>various drugs that inhibit the action of the virus, each one with its specific level of inhibition. This probably corresponds to the widely dispersed values above the bulk of distribution (and above the virus control distribution)</li>
</ul></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="co">#### Plate-wise colors ####</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2"></a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="co">## Assign a color to each plate</span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="co">## A trick: we alternate the colors of the rainbow in order </span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="co">## to see the contrast between successive plates</span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6">platePalette &lt;-<span class="st"> </span><span class="kw">rainbow</span>(<span class="dt">n =</span> <span class="kw">length</span>(plateNumbers))</a>
<a class="sourceLine" id="cb7-7" data-line-number="7">plateColor &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="dt">length =</span> nbPlates)</a>
<a class="sourceLine" id="cb7-8" data-line-number="8">oddIndices &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>, nbPlates, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb7-9" data-line-number="9">evenIndices &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">2</span>, nbPlates, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb7-10" data-line-number="10">plateColor[oddIndices] &lt;-<span class="st"> </span>platePalette[<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(oddIndices)]</a>
<a class="sourceLine" id="cb7-11" data-line-number="11">plateColor[evenIndices] &lt;-<span class="st"> </span>platePalette[(<span class="kw">length</span>(oddIndices) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)<span class="op">:</span>nbPlates]</a>
<a class="sourceLine" id="cb7-12" data-line-number="12"><span class="kw">names</span>(plateColor) &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span>nbPlates</a>
<a class="sourceLine" id="cb7-13" data-line-number="13"></a>
<a class="sourceLine" id="cb7-14" data-line-number="14"><span class="co">## Assign a color to each result according to its plate</span></a>
<a class="sourceLine" id="cb7-15" data-line-number="15">inhibTable<span class="op">$</span>color &lt;-<span class="st"> </span>plateColor[inhibTable<span class="op">$</span>Plate]</a>
<a class="sourceLine" id="cb7-16" data-line-number="16">inhibTable<span class="op">$</span>pch &lt;-<span class="st"> </span><span class="dv">1</span> <span class="co"># default point type for dot plots</span></a>
<a class="sourceLine" id="cb7-17" data-line-number="17">inhibTable[inhibTable<span class="op">$</span>wellType <span class="op">==</span><span class="st"> &quot;cellCtl&quot;</span>, <span class="st">&quot;pch&quot;</span>] &lt;-<span class="st"> </span>markPCh[<span class="st">&quot;cellCtl&quot;</span>]</a>
<a class="sourceLine" id="cb7-18" data-line-number="18">inhibTable[inhibTable<span class="op">$</span>wellType <span class="op">==</span><span class="st"> &quot;virusCtl&quot;</span>, <span class="st">&quot;pch&quot;</span>] &lt;-<span class="st"> </span>markPCh[<span class="st">&quot;virusCtl&quot;</span>]</a>
<a class="sourceLine" id="cb7-19" data-line-number="19"><span class="co"># table(inhibTable$color) ## Check that each plate has 96 wells</span></a>
<a class="sourceLine" id="cb7-20" data-line-number="20"><span class="co"># table(inhibTable$pch)</span></a></code></pre></div>
<div id="arbidol-treatment" class="section level3">
<h3>Arbidol treatment</h3>
<p>A treatment with 10µM Arbidol – a broad-spectrum antiviral – was used as control, with duplicate test in 2 wells per plate.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="co">#### Select arbidol duplicates as plate-wise milestones ####</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2">arbidolWells &lt;-<span class="st"> </span>(inhibTable<span class="op">$</span>Column <span class="op">==</span><span class="st"> </span><span class="dv">12</span>) <span class="op">&amp;</span><span class="st"> </span>(inhibTable<span class="op">$</span>Row <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>))</a>
<a class="sourceLine" id="cb8-3" data-line-number="3">inhibTable[arbidolWells, <span class="st">&quot;Chemical.name&quot;</span>] &lt;-<span class="st"> &quot;Arbidol&quot;</span></a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="co"># inhibTable[arbidolWells, c(&quot;ID&quot;, &quot;Chemical.name&quot;)]</span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5"></a>
<a class="sourceLine" id="cb8-6" data-line-number="6"><span class="co">#### Extract raw viability measures per plate for arbidol ####</span></a>
<a class="sourceLine" id="cb8-7" data-line-number="7">arbidoltV &lt;-<span class="st"> </span>inhibTable[arbidolWells, <span class="kw">c</span>(<span class="st">&quot;Plate&quot;</span>, <span class="st">&quot;viability&quot;</span>)]</a>
<a class="sourceLine" id="cb8-8" data-line-number="8">inhibTable[arbidolWells, <span class="st">&quot;color&quot;</span>] &lt;-<span class="st"> </span>markColor[<span class="st">&quot;Arbidol&quot;</span>]</a>
<a class="sourceLine" id="cb8-9" data-line-number="9">inhibTable[arbidolWells, <span class="st">&quot;pch&quot;</span>] &lt;-<span class="st"> </span>markPCh[<span class="st">&quot;Arbidol&quot;</span>]</a>
<a class="sourceLine" id="cb8-10" data-line-number="10"></a>
<a class="sourceLine" id="cb8-11" data-line-number="11"></a>
<a class="sourceLine" id="cb8-12" data-line-number="12"><span class="co"># table(inhibTable$color)</span></a></code></pre></div>
</div>
<div id="hydroxychloroquine-sulfate" class="section level3">
<h3>Hydroxychloroquine sulfate</h3>
<p>We assin a specific label to Hydroxychloroquine sulfate, which has a specific interest since it is one of the molecules tested in an European clinical trial.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">HOClSindex &lt;-<span class="st"> </span><span class="kw">which</span>(inhibTable<span class="op">$</span>Chemical.name <span class="op">==</span><span class="st"> &quot;Hydroxychloroquine sulfate&quot;</span>)</a>
<a class="sourceLine" id="cb9-2" data-line-number="2">HOClSpch &lt;-<span class="st"> </span><span class="dv">13</span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3">inhibTable[HOClSindex, <span class="st">&quot;color&quot;</span>] &lt;-<span class="st"> </span>markColor[<span class="st">&quot;Hydroxychloroquine&quot;</span>]</a>
<a class="sourceLine" id="cb9-4" data-line-number="4">inhibTable[HOClSindex, <span class="st">&quot;pch&quot;</span>] &lt;-<span class="st"> </span>HOClSpch</a></code></pre></div>
</div>
</div>
<div id="raw-viability-boxplots" class="section level2">
<h2>Raw viability boxplots</h2>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="co">#### Boxplots per plate  ####</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2"></a>
<a class="sourceLine" id="cb10-3" data-line-number="3">rawBoxPlot &lt;-<span class="st"> </span><span class="kw">boxplot</span>(viability <span class="op">~</span><span class="st"> </span>Plate <span class="op">+</span><span class="st"> </span>wellType, </a>
<a class="sourceLine" id="cb10-4" data-line-number="4">        <span class="dt">main =</span> <span class="st">&quot;Raw viability per plate&quot;</span>,</a>
<a class="sourceLine" id="cb10-5" data-line-number="5">        <span class="dt">data =</span> inhibTable, </a>
<a class="sourceLine" id="cb10-6" data-line-number="6">        <span class="dt">las =</span> <span class="dv">1</span>, <span class="dt">col =</span> plateColor, </a>
<a class="sourceLine" id="cb10-7" data-line-number="7">        <span class="dt">xlab =</span> <span class="st">&quot;Viability (raw)&quot;</span>, </a>
<a class="sourceLine" id="cb10-8" data-line-number="8">        <span class="dt">cex.axis =</span> <span class="fl">0.5</span>, <span class="dt">cex =</span> <span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb10-9" data-line-number="9">        <span class="dt">horizontal =</span> <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb10-10" data-line-number="10">        )</a>
<a class="sourceLine" id="cb10-11" data-line-number="11"><span class="kw">abline</span>(<span class="dt">v =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="kw">max</span>(inhibTable<span class="op">$</span>viability), <span class="dt">by =</span> <span class="dv">2000</span>), <span class="dt">col =</span> <span class="st">&quot;#EEEEEE&quot;</span>, <span class="dt">lty =</span> <span class="st">&quot;dashed&quot;</span>)</a>
<a class="sourceLine" id="cb10-12" data-line-number="12"><span class="kw">abline</span>(<span class="dt">v =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="kw">max</span>(inhibTable<span class="op">$</span>viability), <span class="dt">by =</span> <span class="dv">10000</span>), <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>)</a>
<a class="sourceLine" id="cb10-13" data-line-number="13"><span class="co"># View(rawBoxPlot)</span></a>
<a class="sourceLine" id="cb10-14" data-line-number="14"></a>
<a class="sourceLine" id="cb10-15" data-line-number="15"><span class="co">## Add points to denote the arbidol controls</span></a>
<a class="sourceLine" id="cb10-16" data-line-number="16"><span class="kw">stripchart</span>(viability <span class="op">~</span><span class="st"> </span>Plate, <span class="dt">vertical =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb10-17" data-line-number="17">           <span class="dt">data =</span> inhibTable[arbidolWells, ],</a>
<a class="sourceLine" id="cb10-18" data-line-number="18">           <span class="dt">method =</span> <span class="st">&quot;jitter&quot;</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>, <span class="dt">cex =</span> <span class="fl">0.7</span>, </a>
<a class="sourceLine" id="cb10-19" data-line-number="19">           <span class="dt">col =</span> markColor[<span class="st">&quot;Arbidol&quot;</span>], <span class="dt">pch =</span> markPCh[<span class="st">&quot;Arbidol&quot;</span>])</a>
<a class="sourceLine" id="cb10-20" data-line-number="20"></a>
<a class="sourceLine" id="cb10-21" data-line-number="21"></a>
<a class="sourceLine" id="cb10-22" data-line-number="22"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">legend =</span> <span class="kw">names</span>(plateColor), </a>
<a class="sourceLine" id="cb10-23" data-line-number="23">       <span class="dt">title =</span> <span class="st">&quot;Plate&quot;</span>, <span class="dt">fill =</span> plateColor, <span class="dt">cex =</span> <span class="fl">0.8</span>)</a></code></pre></div>
<div class="figure" style="text-align: center">
<img src="figures/touret_sars-cov-2_inhibitorsboxplots_per_plate_raw-1.png" alt="Distribution of raw viability values per plate. Top virus control (untreated infected cells); middle: treated cells; bottom: cell control (uninfected). Black plain circles: arbidol control duplicates.  " width="80%" />
<p class="caption">
Distribution of raw viability values per plate. Top virus control (untreated infected cells); middle: treated cells; bottom: cell control (uninfected). Black plain circles: arbidol control duplicates.
</p>
</div>
<p>The boxplot of the raw viability measurements highlights a plate effect, for the treated cells (middle barplots) but also for the untreated virus control (top boxplots) and uninfected cell control (bottom boxplots).</p>
<ul>
<li><p><strong>Treated:</strong></p>
<ul>
<li>The medians and interquartile ranges show strong variations between plates.</li>
<li>In particular, plate 1 (in red) has a the smallest median and a remarkably compact interquartile range. There are many statistical outliers (empty circles) in this plate, which might correspond to the molecules having a significant inhibitory effect.</li>
<li>In contrast, plates 11 to 15 show a high median and a wide dispersion of the viability measures, and there is not a single statistical outlier.</li>
</ul></li>
<li><p><strong>Virus control</strong></p>
<ul>
<li>Not surprisingly, untreated infected cells generally gave a very small viability, with small variations (very compact interquartile rectangles)</li>
<li>There is an obvious problem for plate 17, which shows a broad range of values, with a third quartile falling in the range of the uninfected cells. This suggests a problem with at least 2 of the 6 replicates (missed infection ?). Noticeably, the median falls in the same range as for the virus control of the other plates.</li>
</ul></li>
<li><p><strong>Cell control</strong></p>
<ul>
<li>The cell control performed as expected in all the plates, with high viability values.</li>
<li>Note however that the viability measurements show inter-plate variations, with median values ranging from ~37,000 to ~53,000.</li>
</ul></li>
</ul>
<p>Importantly, there is a consistency between the inter-plate differences observed for virus control, treated cells and cell control, respectively. For example, plate 2 whose consistently higher value than the other plates for the three types of wells. This highlights the importances to perform a plate-wise standardization.</p>
</div>
<div id="log2-viability-boxplots" class="section level2">
<h2>Log2 viability boxplots</h2>
<p>We performed a log2 transformation of the raw viability measures in order to normalize them.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="co">#### Boxplots of log2_transformed viability per plate ####</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2">inhibTable<span class="op">$</span>log2V &lt;-<span class="st"> </span><span class="kw">log2</span>(inhibTable<span class="op">$</span>viability)</a>
<a class="sourceLine" id="cb11-3" data-line-number="3"></a>
<a class="sourceLine" id="cb11-4" data-line-number="4"><span class="co">## Box plot per plate and well type</span></a>
<a class="sourceLine" id="cb11-5" data-line-number="5"><span class="kw">boxplot</span>(log2V <span class="op">~</span><span class="st"> </span>Plate <span class="op">+</span><span class="st"> </span>wellType, </a>
<a class="sourceLine" id="cb11-6" data-line-number="6">        <span class="dt">main =</span> <span class="st">&quot;log2-transformed viability&quot;</span>,</a>
<a class="sourceLine" id="cb11-7" data-line-number="7">        <span class="dt">data =</span> inhibTable, </a>
<a class="sourceLine" id="cb11-8" data-line-number="8">        <span class="dt">las =</span> <span class="dv">1</span>, <span class="dt">col =</span> plateColor, </a>
<a class="sourceLine" id="cb11-9" data-line-number="9">        <span class="dt">xlab =</span> <span class="st">&quot;log2(V)&quot;</span>, </a>
<a class="sourceLine" id="cb11-10" data-line-number="10">        <span class="dt">cex.axis =</span> <span class="fl">0.5</span>, <span class="dt">cex =</span> <span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb11-11" data-line-number="11">        <span class="dt">horizontal =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb11-12" data-line-number="12"><span class="kw">abline</span>(<span class="dt">v =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">12</span>, <span class="dt">to =</span> <span class="kw">max</span>(inhibTable<span class="op">$</span>log2V), <span class="dt">by =</span> <span class="fl">0.2</span>), <span class="dt">col =</span> <span class="st">&quot;#EEEEEE&quot;</span>, <span class="dt">lty =</span> <span class="st">&quot;dashed&quot;</span>)</a>
<a class="sourceLine" id="cb11-13" data-line-number="13"><span class="kw">abline</span>(<span class="dt">v =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">12</span>, <span class="dt">to =</span> <span class="kw">max</span>(inhibTable<span class="op">$</span>log2V), <span class="dt">by =</span> <span class="dv">1</span>), <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>)</a>
<a class="sourceLine" id="cb11-14" data-line-number="14"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">legend =</span> <span class="kw">names</span>(plateColor), </a>
<a class="sourceLine" id="cb11-15" data-line-number="15">       <span class="dt">title =</span> <span class="st">&quot;Plate&quot;</span>, <span class="dt">fill =</span> plateColor, <span class="dt">cex =</span> <span class="fl">0.8</span>)</a>
<a class="sourceLine" id="cb11-16" data-line-number="16"></a>
<a class="sourceLine" id="cb11-17" data-line-number="17"><span class="co">## Add points to denote the arbidol controls</span></a>
<a class="sourceLine" id="cb11-18" data-line-number="18"><span class="kw">stripchart</span>(log2V <span class="op">~</span><span class="st"> </span>Plate, <span class="dt">vertical =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb11-19" data-line-number="19">           <span class="dt">data =</span> inhibTable[arbidolWells, ],</a>
<a class="sourceLine" id="cb11-20" data-line-number="20">           <span class="dt">method =</span> <span class="st">&quot;jitter&quot;</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>, <span class="dt">cex =</span> <span class="fl">0.7</span>, </a>
<a class="sourceLine" id="cb11-21" data-line-number="21">           <span class="dt">col =</span> markColor[<span class="st">&quot;Arbidol&quot;</span>], <span class="dt">pch =</span> markPCh[<span class="st">&quot;Arbidol&quot;</span>])</a></code></pre></div>
<div class="figure" style="text-align: center">
<img src="figures/touret_sars-cov-2_inhibitorsboxplots_per_plate_log2-1.png" alt="Distribution of log2-transformed viability values per plate. Top virus control (untreated infected cells); middle: treated cells; bottom: cell control (uninfected). Black plain circles: arbidol control duplicates. " width="80%" />
<p class="caption">
Distribution of log2-transformed viability values per plate. Top virus control (untreated infected cells); middle: treated cells; bottom: cell control (uninfected). Black plain circles: arbidol control duplicates.
</p>
</div>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw">par</span>(par.ori)</a></code></pre></div>
<p>The barplots of log2-transformed viability measures show yet another potential plate bias: in plates 11 to 19, several molecules are associated to a much smaller viability than in any of the untreated cells. This might reflect a cytotoxic effect of the drug that would enforce the viral infection, but there is a priori no reason to expect such effects to be concentrated on the last plates.</p>
<p><strong>Note: I (JvH) think this should be reported to the company that produces these plates</strong></p>
</div>
</div>
<div id="plate-wise-standardization" class="section level1">
<h1>Plate-wise standardization</h1>
<div id="two-points-scaling-defining-a-relative-viability-v_r" class="section level2">
<h2>Two-points scaling: defining a relative viability (<span class="math inline">\(v_r\)</span>)</h2>
<p>Taking into account the above-reported results, we apply the following procedure to standardize the individual viability measures.</p>
<ol style="list-style-type: decimal">
<li><p>For each plate, we define two standard values:</p>
<ul>
<li><span class="math inline">\(V_c\)</span> is the median viability of the 8 cell controls (uninfected cells)</li>
<li><span class="math inline">\(V_v\)</span> is the median viability of the 6 virus controls (infected untreated cells)</li>
</ul>
<p>These two values are deliberately estimated with the median measurement of the control replicate, in order to avoid the effect of outliers as denoted for the virus control of plate 17.</p></li>
<li><p>A <strong>relative viability index</strong> <span class="math inline">\(v_r\)</span> is computed for each treatment as follows.</p>
<p><span class="math display">\[v_r = \frac{v - V_c}{V_v - V_c} \cdot 100\]</span></p>
<ul>
<li><span class="math inline">\(v_r\)</span> provides a viability measurement on a scale where 0 corresponds to the median of infected untreated cells, and 100 to the median of uninfected cells.</li>
<li>Note that <span class="math inline">\(V_c\)</span> values lower than 0 denote treatments with a lower viability than the untreated virus infection. This might result from a cytotoxic effect of the drug, or from a plate bias.</li>
<li><span class="math inline">\(V_c\)</span> values can in principle also take values higher than 100, denoting a highly efficient treatment.</li>
</ul></li>
</ol>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="co">#### Compute relative viability ####</span></a>
<a class="sourceLine" id="cb13-2" data-line-number="2"></a>
<a class="sourceLine" id="cb13-3" data-line-number="3"><span class="co">## Plate-wise virus control</span></a>
<a class="sourceLine" id="cb13-4" data-line-number="4">vcMed &lt;-<span class="st"> </span><span class="kw">as.vector</span>(<span class="kw">by</span>(<span class="dt">data =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;virusCtl&quot;</span>, <span class="st">&quot;viability&quot;</span>], </a>
<a class="sourceLine" id="cb13-5" data-line-number="5">                               <span class="dt">INDICES =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;virusCtl&quot;</span>, <span class="st">&quot;Plate&quot;</span>], </a>
<a class="sourceLine" id="cb13-6" data-line-number="6">                               <span class="dt">FUN =</span> median))</a>
<a class="sourceLine" id="cb13-7" data-line-number="7"><span class="kw">names</span>(vcMed) &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span>nbPlates</a>
<a class="sourceLine" id="cb13-8" data-line-number="8"></a>
<a class="sourceLine" id="cb13-9" data-line-number="9"><span class="co">## Plate-wise cell control</span></a>
<a class="sourceLine" id="cb13-10" data-line-number="10">ccMed &lt;-<span class="st"> </span><span class="kw">as.vector</span>(<span class="kw">by</span>(<span class="dt">data =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;cellCtl&quot;</span>, <span class="st">&quot;viability&quot;</span>], </a>
<a class="sourceLine" id="cb13-11" data-line-number="11">                               <span class="dt">INDICES =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;cellCtl&quot;</span>, <span class="st">&quot;Plate&quot;</span>], </a>
<a class="sourceLine" id="cb13-12" data-line-number="12">                               <span class="dt">FUN =</span> median))</a>
<a class="sourceLine" id="cb13-13" data-line-number="13"><span class="kw">names</span>(ccMed) &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span>nbPlates</a>
<a class="sourceLine" id="cb13-14" data-line-number="14"></a>
<a class="sourceLine" id="cb13-15" data-line-number="15"><span class="co">## Relative viability</span></a>
<a class="sourceLine" id="cb13-16" data-line-number="16">inhibTable<span class="op">$</span>vcMed &lt;-<span class="st"> </span>vcMed[inhibTable<span class="op">$</span>Plate]</a>
<a class="sourceLine" id="cb13-17" data-line-number="17">inhibTable<span class="op">$</span>ccMed &lt;-<span class="st"> </span>ccMed[inhibTable<span class="op">$</span>Plate]</a>
<a class="sourceLine" id="cb13-18" data-line-number="18">inhibTable<span class="op">$</span>Vr &lt;-<span class="st"> </span><span class="dv">100</span> <span class="op">*</span><span class="st"> </span>(inhibTable<span class="op">$</span>viability <span class="op">-</span><span class="st"> </span>inhibTable<span class="op">$</span>vcMed) <span class="op">/</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-19" data-line-number="19"><span class="st">  </span>(inhibTable<span class="op">$</span>ccMed <span class="op">-</span><span class="st"> </span>inhibTable<span class="op">$</span>vcMed)</a></code></pre></div>
<div id="relative-viability-boxplots" class="section level3">
<h3>Relative viability boxplots</h3>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="co">#### Boxplots of relative viability per plate ####</span></a>
<a class="sourceLine" id="cb14-2" data-line-number="2"></a>
<a class="sourceLine" id="cb14-3" data-line-number="3"><span class="co">## Box plot per plate and well type</span></a>
<a class="sourceLine" id="cb14-4" data-line-number="4"><span class="kw">boxplot</span>(Vr <span class="op">~</span><span class="st"> </span>Plate <span class="op">+</span><span class="st"> </span>wellType, </a>
<a class="sourceLine" id="cb14-5" data-line-number="5">        <span class="dt">main =</span> <span class="st">&quot;Relative viability&quot;</span>,</a>
<a class="sourceLine" id="cb14-6" data-line-number="6">        <span class="dt">data =</span> inhibTable, </a>
<a class="sourceLine" id="cb14-7" data-line-number="7">        <span class="dt">las =</span> <span class="dv">1</span>, <span class="dt">col =</span> plateColor, </a>
<a class="sourceLine" id="cb14-8" data-line-number="8">        <span class="dt">xlab =</span> <span class="st">&quot;Vr&quot;</span>, </a>
<a class="sourceLine" id="cb14-9" data-line-number="9">        <span class="dt">cex.axis =</span> <span class="fl">0.5</span>, <span class="dt">cex =</span> <span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb14-10" data-line-number="10">        <span class="dt">horizontal =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb14-11" data-line-number="11"><span class="kw">abline</span>(<span class="dt">v =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="kw">max</span>(inhibTable<span class="op">$</span>Vr), <span class="dt">by =</span> <span class="dv">5</span>), <span class="dt">col =</span> <span class="st">&quot;#EEEEEE&quot;</span>, <span class="dt">lty =</span> <span class="st">&quot;dashed&quot;</span>)</a>
<a class="sourceLine" id="cb14-12" data-line-number="12"><span class="kw">abline</span>(<span class="dt">v =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="kw">max</span>(inhibTable<span class="op">$</span>Vr), <span class="dt">by =</span> <span class="dv">25</span>), <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>)</a>
<a class="sourceLine" id="cb14-13" data-line-number="13"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">legend =</span> <span class="kw">names</span>(plateColor), </a>
<a class="sourceLine" id="cb14-14" data-line-number="14">       <span class="dt">title =</span> <span class="st">&quot;Plate&quot;</span>, <span class="dt">fill =</span> plateColor, <span class="dt">cex =</span> <span class="fl">0.8</span>)</a>
<a class="sourceLine" id="cb14-15" data-line-number="15"></a>
<a class="sourceLine" id="cb14-16" data-line-number="16"><span class="co">## Add points to denote the arbidol controls</span></a>
<a class="sourceLine" id="cb14-17" data-line-number="17"><span class="kw">stripchart</span>(Vr <span class="op">~</span><span class="st"> </span>Plate, <span class="dt">vertical =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb14-18" data-line-number="18">           <span class="dt">data =</span> inhibTable[arbidolWells, ],</a>
<a class="sourceLine" id="cb14-19" data-line-number="19">           <span class="dt">method =</span> <span class="st">&quot;jitter&quot;</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>, <span class="dt">cex =</span> <span class="fl">0.7</span>, </a>
<a class="sourceLine" id="cb14-20" data-line-number="20">           <span class="dt">col =</span> markColor[<span class="st">&quot;Arbidol&quot;</span>], <span class="dt">pch =</span> markPCh[<span class="st">&quot;Arbidol&quot;</span>])</a></code></pre></div>
<div class="figure" style="text-align: center">
<img src="figures/touret_sars-cov-2_inhibitorsboxplots_per_plate_Vr-1.png" alt="Distribution of relative viability (Vr) values per plate. Top virus control (untreated infected cells); middle: treated cells; bottom: cell control (uninfected). Black plain circles: arbidol control duplicates.  " width="80%" />
<p class="caption">
Distribution of relative viability (Vr) values per plate. Top virus control (untreated infected cells); middle: treated cells; bottom: cell control (uninfected). Black plain circles: arbidol control duplicates.
</p>
</div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="kw">par</span>(par.ori)</a></code></pre></div>
<p>The box plots show that the relative viability already has a normalizing effect by positioning each treatment between the virus and cell control of its own plate.</p>
<ul>
<li>The virus controls are well regrouped in the range of smaller <span class="math inline">\(v_r\)</span> values (the third quartiles all fall below 15, except for plate).</li>
<li>The cell controls occupy the high range (their first quartile is higher than 80) and are quite compactly grouped around 100.</li>
</ul>
<p>However, we still observe a systematic plate effect in plates 11 to 19:</p>
<ul>
<li>their median is mich higher than for the plates 1 to 10;</li>
<li>they also show a much wider inter-quartile rectangle, denoting a very high variance between all the viability measurements on this plate;</li>
<li>this higher variance is even visible in the virus control (untreated infected cells), and it is thus unlikely that it results from the particular molecules sampled on this second half of the plates.</li>
</ul>
<p>We thus need a way to perform a between-plates standardization of the variance.</p>
</div>
<div id="dot-plots-relative-viability" class="section level3">
<h3>Dot plots: relative viability</h3>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1">yRange &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">floor</span>(<span class="kw">min</span>(inhibTable<span class="op">$</span>Vr)), <span class="kw">ceiling</span>(<span class="kw">max</span>(inhibTable<span class="op">$</span>Vr)))</a>
<a class="sourceLine" id="cb16-2" data-line-number="2"></a>
<a class="sourceLine" id="cb16-3" data-line-number="3"><span class="co">## Virus control plots</span></a>
<a class="sourceLine" id="cb16-4" data-line-number="4"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb16-5" data-line-number="5"><span class="kw">plot</span>(inhibTable[wellType <span class="op">==</span><span class="st"> &quot;virusCtl&quot;</span>, <span class="st">&quot;Vr&quot;</span>],</a>
<a class="sourceLine" id="cb16-6" data-line-number="6">     <span class="dt">main =</span> <span class="st">&quot;Virus control (infected, untreated)&quot;</span>,</a>
<a class="sourceLine" id="cb16-7" data-line-number="7">     <span class="dt">xlab =</span> <span class="st">&quot;Replicates, sorted per plate&quot;</span>,</a>
<a class="sourceLine" id="cb16-8" data-line-number="8">     <span class="dt">ylab =</span> <span class="st">&quot;relative viability&quot;</span>,</a>
<a class="sourceLine" id="cb16-9" data-line-number="9">     <span class="dt">col =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;virusCtl&quot;</span>, <span class="st">&quot;color&quot;</span>],</a>
<a class="sourceLine" id="cb16-10" data-line-number="10">     <span class="dt">pch =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;virusCtl&quot;</span>, <span class="st">&quot;pch&quot;</span>],</a>
<a class="sourceLine" id="cb16-11" data-line-number="11">     <span class="dt">ylim =</span> yRange,</a>
<a class="sourceLine" id="cb16-12" data-line-number="12">     <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, (nbPlates <span class="op">*</span><span class="st"> </span><span class="dv">6</span> <span class="op">*</span><span class="st"> </span><span class="fl">1.05</span>)),</a>
<a class="sourceLine" id="cb16-13" data-line-number="13">     <span class="dt">panel.first =</span> <span class="kw">c</span>(<span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>), </a>
<a class="sourceLine" id="cb16-14" data-line-number="14">                     <span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">100</span>),</a>
<a class="sourceLine" id="cb16-15" data-line-number="15">                     <span class="kw">abline</span>(<span class="dt">h =</span> <span class="kw">seq</span>(<span class="dv">10</span>,<span class="dv">90</span>, <span class="dv">20</span>), <span class="dt">lty =</span> <span class="st">&quot;dotted&quot;</span>),</a>
<a class="sourceLine" id="cb16-16" data-line-number="16">                     <span class="kw">abline</span>(<span class="dt">v =</span> (<span class="dv">1</span><span class="op">:</span><span class="dv">19</span>) <span class="op">*</span><span class="st"> </span><span class="dv">6</span>, <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>)</a>
<a class="sourceLine" id="cb16-17" data-line-number="17">                     ),</a>
<a class="sourceLine" id="cb16-18" data-line-number="18">     <span class="dt">las =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb16-19" data-line-number="19">     <span class="dt">cex =</span> <span class="fl">0.5</span></a>
<a class="sourceLine" id="cb16-20" data-line-number="20">     )</a>
<a class="sourceLine" id="cb16-21" data-line-number="21"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, </a>
<a class="sourceLine" id="cb16-22" data-line-number="22">       <span class="dt">legend =</span> <span class="kw">names</span>(plateColor), </a>
<a class="sourceLine" id="cb16-23" data-line-number="23">       <span class="dt">col =</span> plateColor, <span class="dt">pch =</span> <span class="dv">1</span>, </a>
<a class="sourceLine" id="cb16-24" data-line-number="24">       <span class="dt">cex =</span> <span class="fl">0.7</span>)</a>
<a class="sourceLine" id="cb16-25" data-line-number="25"></a>
<a class="sourceLine" id="cb16-26" data-line-number="26"><span class="co">## Treated cells</span></a>
<a class="sourceLine" id="cb16-27" data-line-number="27"><span class="kw">plot</span>(inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;Vr&quot;</span>],</a>
<a class="sourceLine" id="cb16-28" data-line-number="28">     <span class="dt">main =</span> <span class="st">&quot;Relative viability (Vr)&quot;</span>,</a>
<a class="sourceLine" id="cb16-29" data-line-number="29">     <span class="dt">xlab =</span> <span class="st">&quot;Molecules&quot;</span>,</a>
<a class="sourceLine" id="cb16-30" data-line-number="30">     <span class="dt">ylab =</span> <span class="st">&quot;relative viability&quot;</span>,</a>
<a class="sourceLine" id="cb16-31" data-line-number="31">     <span class="dt">col =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;color&quot;</span>],</a>
<a class="sourceLine" id="cb16-32" data-line-number="32">     <span class="dt">pch =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;pch&quot;</span>],</a>
<a class="sourceLine" id="cb16-33" data-line-number="33">     <span class="dt">ylim =</span> yRange,</a>
<a class="sourceLine" id="cb16-34" data-line-number="34">     <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, (nbPlates <span class="op">*</span><span class="st"> </span><span class="dv">80</span> <span class="op">*</span><span class="st"> </span><span class="fl">1.05</span>)),</a>
<a class="sourceLine" id="cb16-35" data-line-number="35">     <span class="dt">panel.first =</span> <span class="kw">c</span>(<span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>), </a>
<a class="sourceLine" id="cb16-36" data-line-number="36">                     <span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">100</span>),</a>
<a class="sourceLine" id="cb16-37" data-line-number="37">                     <span class="kw">abline</span>(<span class="dt">h =</span> <span class="kw">seq</span>(<span class="dv">10</span>,<span class="dv">90</span>, <span class="dv">20</span>), <span class="dt">lty =</span> <span class="st">&quot;dotted&quot;</span>),</a>
<a class="sourceLine" id="cb16-38" data-line-number="38">                     <span class="kw">abline</span>(<span class="dt">v =</span> (<span class="dv">1</span><span class="op">:</span><span class="dv">19</span>) <span class="op">*</span><span class="st"> </span><span class="dv">80</span>, <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>)</a>
<a class="sourceLine" id="cb16-39" data-line-number="39">                     ),</a>
<a class="sourceLine" id="cb16-40" data-line-number="40">     <span class="dt">las =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb16-41" data-line-number="41">     <span class="dt">cex =</span> <span class="fl">0.5</span></a>
<a class="sourceLine" id="cb16-42" data-line-number="42">     )</a>
<a class="sourceLine" id="cb16-43" data-line-number="43"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, </a>
<a class="sourceLine" id="cb16-44" data-line-number="44">       <span class="dt">legend =</span> <span class="kw">names</span>(plateColor), </a>
<a class="sourceLine" id="cb16-45" data-line-number="45">       <span class="dt">col =</span> plateColor, <span class="dt">pch =</span> <span class="dv">1</span>, </a>
<a class="sourceLine" id="cb16-46" data-line-number="46">       <span class="dt">cex =</span> <span class="fl">0.7</span>)</a>
<a class="sourceLine" id="cb16-47" data-line-number="47"></a>
<a class="sourceLine" id="cb16-48" data-line-number="48"><span class="co">## Cell control</span></a>
<a class="sourceLine" id="cb16-49" data-line-number="49"><span class="kw">plot</span>(inhibTable[wellType <span class="op">==</span><span class="st"> &quot;cellCtl&quot;</span>, <span class="st">&quot;Vr&quot;</span>],</a>
<a class="sourceLine" id="cb16-50" data-line-number="50">     <span class="dt">main =</span> <span class="st">&quot;Cell control (uninfected)&quot;</span>,</a>
<a class="sourceLine" id="cb16-51" data-line-number="51">     <span class="dt">xlab =</span> <span class="st">&quot;Replicates, sorted per plate&quot;</span>,</a>
<a class="sourceLine" id="cb16-52" data-line-number="52">     <span class="dt">ylab =</span> <span class="st">&quot;relative viability&quot;</span>,</a>
<a class="sourceLine" id="cb16-53" data-line-number="53">     <span class="dt">col =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;cellCtl&quot;</span>, <span class="st">&quot;color&quot;</span>],</a>
<a class="sourceLine" id="cb16-54" data-line-number="54">     <span class="dt">pch =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;cellCtl&quot;</span>, <span class="st">&quot;pch&quot;</span>],</a>
<a class="sourceLine" id="cb16-55" data-line-number="55">     <span class="dt">ylim =</span> yRange,</a>
<a class="sourceLine" id="cb16-56" data-line-number="56">     <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, (nbPlates <span class="op">*</span><span class="st"> </span><span class="dv">8</span> <span class="op">*</span><span class="st"> </span><span class="fl">1.05</span>)),</a>
<a class="sourceLine" id="cb16-57" data-line-number="57">     <span class="dt">panel.first =</span> <span class="kw">c</span>(<span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>), </a>
<a class="sourceLine" id="cb16-58" data-line-number="58">                     <span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">100</span>),</a>
<a class="sourceLine" id="cb16-59" data-line-number="59">                     <span class="kw">abline</span>(<span class="dt">h =</span> <span class="kw">seq</span>(<span class="dv">10</span>,<span class="dv">90</span>, <span class="dv">20</span>), <span class="dt">lty =</span> <span class="st">&quot;dotted&quot;</span>),</a>
<a class="sourceLine" id="cb16-60" data-line-number="60">                     <span class="kw">abline</span>(<span class="dt">v =</span> (<span class="dv">1</span><span class="op">:</span><span class="dv">19</span>) <span class="op">*</span><span class="st"> </span><span class="dv">8</span>, <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>)</a>
<a class="sourceLine" id="cb16-61" data-line-number="61">                     ),</a>
<a class="sourceLine" id="cb16-62" data-line-number="62">     <span class="dt">las =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb16-63" data-line-number="63">     <span class="dt">cex =</span> <span class="fl">0.5</span></a>
<a class="sourceLine" id="cb16-64" data-line-number="64">     )</a>
<a class="sourceLine" id="cb16-65" data-line-number="65"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, </a>
<a class="sourceLine" id="cb16-66" data-line-number="66">       <span class="dt">legend =</span> <span class="kw">names</span>(plateColor), </a>
<a class="sourceLine" id="cb16-67" data-line-number="67">       <span class="dt">col =</span> plateColor, <span class="dt">pch =</span> <span class="dv">1</span>, </a>
<a class="sourceLine" id="cb16-68" data-line-number="68">       <span class="dt">cex =</span> <span class="fl">0.7</span>)</a>
<a class="sourceLine" id="cb16-69" data-line-number="69"><span class="co"># names(supTable)</span></a>
<a class="sourceLine" id="cb16-70" data-line-number="70"></a>
<a class="sourceLine" id="cb16-71" data-line-number="71"><span class="co">## Rank plot</span></a>
<a class="sourceLine" id="cb16-72" data-line-number="72">VrRank &lt;-<span class="st"> </span><span class="kw">order</span>(inhibTable<span class="op">$</span>Vr, <span class="dt">decreasing =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb16-73" data-line-number="73"><span class="kw">plot</span>(inhibTable[VrRank, <span class="st">&quot;Vr&quot;</span>],</a>
<a class="sourceLine" id="cb16-74" data-line-number="74">     <span class="dt">main =</span> <span class="st">&quot;Ranked relative viability values&quot;</span>,</a>
<a class="sourceLine" id="cb16-75" data-line-number="75">     <span class="dt">xlab =</span> <span class="st">&quot;Molecules (ranked by relative viability)&quot;</span>,</a>
<a class="sourceLine" id="cb16-76" data-line-number="76">     <span class="dt">ylab =</span> <span class="st">&quot;relative viability&quot;</span>,</a>
<a class="sourceLine" id="cb16-77" data-line-number="77">     <span class="dt">col =</span> inhibTable[VrRank, <span class="st">&quot;color&quot;</span>],</a>
<a class="sourceLine" id="cb16-78" data-line-number="78">     <span class="dt">pch =</span> inhibTable[VrRank, <span class="st">&quot;pch&quot;</span>],</a>
<a class="sourceLine" id="cb16-79" data-line-number="79">     <span class="dt">cex =</span> <span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb16-80" data-line-number="80">     <span class="dt">panel.first =</span> <span class="kw">grid</span>(),</a>
<a class="sourceLine" id="cb16-81" data-line-number="81">     <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="kw">length</span>(VrRank) <span class="op">*</span><span class="st"> </span><span class="fl">1.05</span>)</a>
<a class="sourceLine" id="cb16-82" data-line-number="82">     )</a>
<a class="sourceLine" id="cb16-83" data-line-number="83"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, </a>
<a class="sourceLine" id="cb16-84" data-line-number="84">       <span class="dt">legend =</span> <span class="kw">names</span>(plateColor), </a>
<a class="sourceLine" id="cb16-85" data-line-number="85">       <span class="dt">col =</span> plateColor, <span class="dt">pch =</span> <span class="dv">1</span>, </a>
<a class="sourceLine" id="cb16-86" data-line-number="86">       <span class="dt">cex =</span> <span class="fl">0.4</span>)</a></code></pre></div>
<div class="figure" style="text-align: center">
<img src="figures/touret_sars-cov-2_inhibitorsiqNormV_plot-1.png" alt="Values of the plate-wise relative viability index for all the tested molecules. Molecules are colored according to the plate number. A: virus control (infected untreated); B: treated cells; C: cell control (untreated cells); D: ranked values (all types). Plain triangles: virus control (untreated infected cells). Black plain circles: arbidol control duplicates per plate. Orange square: Hydroxychloroquine sulfate. " width="80%" />
<p class="caption">
Values of the plate-wise relative viability index for all the tested molecules. Molecules are colored according to the plate number. A: virus control (infected untreated); B: treated cells; C: cell control (untreated cells); D: ranked values (all types). Plain triangles: virus control (untreated infected cells). Black plain circles: arbidol control duplicates per plate. Orange square: Hydroxychloroquine sulfate.
</p>
</div>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</a></code></pre></div>
</div>
</div>
<div id="iqr-based-standardization" class="section level2">
<h2>IQR-based standardization</h2>
<div id="plate-wise-iqr-standardized-viability" class="section level3">
<h3>Plate-wise IQR-standardized viability</h3>
<p>We perform a plate-wise normalization with a centering on the median and a scaling to compensate for the plate-wise variance effect denoted above. To this purpose, we compute z-scores from the original value.</p>
<ul>
<li>centering: substract an estimator of the plate-wise mean ;</li>
<li>scaling: divide by an estimator of the plate-wise standard deviation (<span class="math inline">\(\hat{\sigma_i}\)</span>)</li>
</ul>
<p><span class="math display">\[z_{c,i} = \frac{V_c - \hat{\mu_i}}{\hat{\sigma_i}}\]</span></p>
<p>where</p>
<ul>
<li><span class="math inline">\(V_c\)</span> is the viability for molecule <span class="math inline">\(c\)</span>;</li>
<li><span class="math inline">\(\hat{\mu_i}\)</span> is the estimate for the mean viability of all the treated cells in plate <span class="math inline">\(i\)</span>;</li>
<li><span class="math inline">\(\hat{\sigma_i}\)</span> is the estimate for the standard deviation of all the treated cells in plate <span class="math inline">\(i\)</span>;</li>
</ul>
<p>In classical statistics, the estimators of centrality and dispersion are derived from the sample mean and standard deviation, respectively:</p>
<ul>
<li>the population mean is used as maximum likelihood estimator of the population: <span class="math inline">\(\hat{\mu} = \bar{x}\)</span></li>
<li>the population standard deviation (<span class="math inline">\(\sigma\)</span>) is estimated with the sample standard deviation, corrected for the systematic bias: <span class="math inline">\(\hat{\sigma} = \sqrt{n/(n-1)} \cdot s\)</span>)</li>
</ul>
<p>However, we must be careful because each plate supposedly contain a mixture of inactive (no inhibitory effect) and active (inhibitory) molecules. The previous histograms and box plots show that these inhibitory molecules appear as statistiacal outliers (with very high viability values) and would thus strongly bias the estimation of the background variance (the variance due to fluctuations in absence of treatment).</p>
<p>One possibility would be to use the standard deviation of the virus control to this purpose, but this would leat to instable estimators, since they would be based on 6 points per plate. In addition, the boxplots show that the variance among treated cells is higher than the virus control, suggesting some generic effect of the treatments.</p>
<p>Another strategy is to consider that the variance (and standard deviation) can be estimated from the bulk of treated cell viability measures themselves, and to use <strong>robust estimators</strong> of the central tendency (i.e. the plate-wise median) and dispersion (i.e. the plate-wise interquartile range).</p>
<p>This approach relies on the assumption that, <em>in each plate</em>, the number of active molecule (statistical outliers). Since teach plate contains tests of 80 molecules, there are 19 molecules above the third quartile (<span class="math inline">\(Q3\)</span>). However, it has to be noted that the plates were manufactured with some grouping of molecules of the same structural family. It might thus happen that some plates contain more than 19 molecules having an inhibitory effect. Such a situation would result in a loss of sensitivity, since the presence of active molecules in the inter-quartile range would lead to over-estimate the dispersion.</p>
<p>An alternative is to estimate the dispersion based on the range between the first quartile (<span class="math inline">\(Q1\)</span>) and the median (<span class="math inline">\(\tilde{x}\)</span>) of each plate.</p>
<p>In summary, we compute robust estimators, in order to avoid the effect of outliers (in this case, the suspected outliers are the molecules having an actual inhibitory effect). To this purpose, we use:</p>
<ul>
<li>plate-wise median viability (<span class="math inline">\(\tilde{v}\)</span>) to estimate the mean</li>
<li>plate-wise standardized inter-quantile range (IQR) to estimate the standard deviation</li>
</ul>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="co">#### Copute plate-wise statistics ####</span></a>
<a class="sourceLine" id="cb18-2" data-line-number="2">statPerPlate &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb18-3" data-line-number="3">  <span class="dt">Plate =</span> plateNumbers,</a>
<a class="sourceLine" id="cb18-4" data-line-number="4">  <span class="dt">TrMean =</span> <span class="kw">as.vector</span>(<span class="kw">by</span>(</a>
<a class="sourceLine" id="cb18-5" data-line-number="5">    <span class="dt">data =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;viability&quot;</span>], </a>
<a class="sourceLine" id="cb18-6" data-line-number="6">    <span class="dt">INDICES =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;Plate&quot;</span>], </a>
<a class="sourceLine" id="cb18-7" data-line-number="7">    <span class="dt">FUN =</span> mean)),</a>
<a class="sourceLine" id="cb18-8" data-line-number="8">  <span class="dt">TrSD =</span> <span class="kw">as.vector</span>(<span class="kw">by</span>(</a>
<a class="sourceLine" id="cb18-9" data-line-number="9">    <span class="dt">data =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;viability&quot;</span>], </a>
<a class="sourceLine" id="cb18-10" data-line-number="10">    <span class="dt">INDICES =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;Plate&quot;</span>], </a>
<a class="sourceLine" id="cb18-11" data-line-number="11">    <span class="dt">FUN =</span> sd)),</a>
<a class="sourceLine" id="cb18-12" data-line-number="12">  <span class="dt">TrMedian =</span> <span class="kw">as.vector</span>(<span class="kw">by</span>(</a>
<a class="sourceLine" id="cb18-13" data-line-number="13">    <span class="dt">data =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;viability&quot;</span>], </a>
<a class="sourceLine" id="cb18-14" data-line-number="14">    <span class="dt">INDICES =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;Plate&quot;</span>], </a>
<a class="sourceLine" id="cb18-15" data-line-number="15">    <span class="dt">FUN =</span> median)),</a>
<a class="sourceLine" id="cb18-16" data-line-number="16">  <span class="dt">VCMedian =</span> <span class="kw">as.vector</span>(<span class="kw">by</span>(</a>
<a class="sourceLine" id="cb18-17" data-line-number="17">    <span class="dt">data =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;virusCtl&quot;</span>, <span class="st">&quot;viability&quot;</span>], </a>
<a class="sourceLine" id="cb18-18" data-line-number="18">    <span class="dt">INDICES =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;virusCtl&quot;</span>, <span class="st">&quot;Plate&quot;</span>], </a>
<a class="sourceLine" id="cb18-19" data-line-number="19">    <span class="dt">FUN =</span> median)),</a>
<a class="sourceLine" id="cb18-20" data-line-number="20">  <span class="dt">CCMedian =</span> <span class="kw">as.vector</span>(<span class="kw">by</span>(</a>
<a class="sourceLine" id="cb18-21" data-line-number="21">    <span class="dt">data =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;cellCtl&quot;</span>, <span class="st">&quot;viability&quot;</span>], </a>
<a class="sourceLine" id="cb18-22" data-line-number="22">    <span class="dt">INDICES =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;cellCtl&quot;</span>, <span class="st">&quot;Plate&quot;</span>], </a>
<a class="sourceLine" id="cb18-23" data-line-number="23">    <span class="dt">FUN =</span> median)),</a>
<a class="sourceLine" id="cb18-24" data-line-number="24">  <span class="dt">arbidolMean =</span> <span class="kw">as.vector</span>(<span class="kw">by</span>(</a>
<a class="sourceLine" id="cb18-25" data-line-number="25">    <span class="dt">data =</span> inhibTable[arbidolWells, <span class="st">&quot;viability&quot;</span>], </a>
<a class="sourceLine" id="cb18-26" data-line-number="26">    <span class="dt">INDICES =</span> inhibTable[arbidolWells, <span class="st">&quot;Plate&quot;</span>], </a>
<a class="sourceLine" id="cb18-27" data-line-number="27">    <span class="dt">FUN =</span> mean)),</a>
<a class="sourceLine" id="cb18-28" data-line-number="28">  <span class="dt">TrMin =</span> <span class="kw">as.vector</span>(<span class="kw">by</span>(    </a>
<a class="sourceLine" id="cb18-29" data-line-number="29">    <span class="dt">data =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;viability&quot;</span>], </a>
<a class="sourceLine" id="cb18-30" data-line-number="30">    <span class="dt">INDICES =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;Plate&quot;</span>], </a>
<a class="sourceLine" id="cb18-31" data-line-number="31">    <span class="dt">FUN =</span> min)),</a>
<a class="sourceLine" id="cb18-32" data-line-number="32">  <span class="dt">TrMax =</span> <span class="kw">as.vector</span>(<span class="kw">by</span>(</a>
<a class="sourceLine" id="cb18-33" data-line-number="33">    <span class="dt">data =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;viability&quot;</span>], </a>
<a class="sourceLine" id="cb18-34" data-line-number="34">    <span class="dt">INDICES =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;Plate&quot;</span>], </a>
<a class="sourceLine" id="cb18-35" data-line-number="35">    <span class="dt">FUN =</span> max)),</a>
<a class="sourceLine" id="cb18-36" data-line-number="36">  <span class="dt">TrQ1 =</span> <span class="kw">as.vector</span>(<span class="kw">by</span>(</a>
<a class="sourceLine" id="cb18-37" data-line-number="37">    <span class="dt">data =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;viability&quot;</span>], </a>
<a class="sourceLine" id="cb18-38" data-line-number="38">    <span class="dt">INDICES =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;Plate&quot;</span>], </a>
<a class="sourceLine" id="cb18-39" data-line-number="39">    <span class="dt">FUN =</span> quantile, <span class="dt">probs =</span> <span class="fl">0.25</span>)),</a>
<a class="sourceLine" id="cb18-40" data-line-number="40">  <span class="dt">TrQ3 =</span> <span class="kw">as.vector</span>(<span class="kw">by</span>(</a>
<a class="sourceLine" id="cb18-41" data-line-number="41">    <span class="dt">data =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;viability&quot;</span>], </a>
<a class="sourceLine" id="cb18-42" data-line-number="42">    <span class="dt">INDICES =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;Plate&quot;</span>], </a>
<a class="sourceLine" id="cb18-43" data-line-number="43">    <span class="dt">FUN =</span> quantile, <span class="dt">probs =</span> <span class="fl">0.75</span>)),</a>
<a class="sourceLine" id="cb18-44" data-line-number="44">  <span class="dt">TrIQR =</span> <span class="kw">as.vector</span>(<span class="kw">by</span>(    <span class="dt">data =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;viability&quot;</span>], </a>
<a class="sourceLine" id="cb18-45" data-line-number="45">    <span class="dt">INDICES =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;Plate&quot;</span>], </a>
<a class="sourceLine" id="cb18-46" data-line-number="46">    <span class="dt">FUN =</span> IQR))</a>
<a class="sourceLine" id="cb18-47" data-line-number="47">)</a>
<a class="sourceLine" id="cb18-48" data-line-number="48"><span class="kw">rownames</span>(statPerPlate) &lt;-<span class="st"> </span>statPerPlate<span class="op">$</span>Plate</a></code></pre></div>
<p>We define a plate-wise scaling factor from the interquantile range, standardized by the inter-quartile range of a Gaussian distribution.</p>
<p><span class="math display">\[S_i = \frac{Q3_N - Q1_N}{Q3_i - Q3_i} = \frac{1.349}{Q3_i - Q3_i}\]</span></p>
<p>Where <span class="math inline">\(Q1\)</span> and <span class="math inline">\(Q3\)</span> denote the first and third quartile, <span class="math inline">\(N\)</span> the Normal distribution, and <span class="math inline">\(i\)</span> is the plate number.</p>
<p>The viability measures of each plate are then multiplied by the corresponding scaling factor to obtain plate-wise standardized values (<span class="math inline">\(z\)</span>), which will have the same inter-quartile range as the normal distribution.</p>
<p><span class="math display">\[z_{c,i} = \frac{v_c - \hat{\mu_i}}{\hat{\sigma_i}} = (v_c - \tilde{v_i}) \frac{Q3_N - Q1_N}{Q3_i - Q3_i} = (v_c - \tilde{v_i}) \cdot S_i\]</span></p>
<p>The table below indicates the plate-wise statistics and scaling factor.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="co">## Compute the scaling factor as the difference between median and Q1</span></a>
<a class="sourceLine" id="cb19-2" data-line-number="2"><span class="co">## standardized relative to the same difference in a normal distribution.</span></a>
<a class="sourceLine" id="cb19-3" data-line-number="3">statPerPlate<span class="op">$</span>scaling &lt;-<span class="st"> </span>(<span class="kw">qnorm</span>(<span class="dt">p =</span> <span class="fl">0.5</span>) <span class="op">-</span><span class="st"> </span><span class="kw">qnorm</span>(<span class="dt">p =</span> <span class="fl">0.25</span>)) <span class="op">/</span><span class="st"> </span>(statPerPlate<span class="op">$</span>TrMedian <span class="op">-</span><span class="st"> </span>statPerPlate<span class="op">$</span>TrQ1)</a>
<a class="sourceLine" id="cb19-4" data-line-number="4"></a>
<a class="sourceLine" id="cb19-5" data-line-number="5"><span class="co">## Compute scaling factor based on the standardized inter-quartile range.</span></a>
<a class="sourceLine" id="cb19-6" data-line-number="6">statPerPlate<span class="op">$</span>scaling &lt;-<span class="st"> </span>(<span class="kw">qnorm</span>(<span class="dt">p =</span> <span class="fl">0.75</span>) <span class="op">-</span><span class="st"> </span><span class="kw">qnorm</span>(<span class="dt">p =</span> <span class="fl">0.25</span>)) <span class="op">/</span><span class="st"> </span>(statPerPlate<span class="op">$</span>TrQ3 <span class="op">-</span><span class="st"> </span>statPerPlate<span class="op">$</span>TrQ1) </a>
<a class="sourceLine" id="cb19-7" data-line-number="7"></a>
<a class="sourceLine" id="cb19-8" data-line-number="8"><span class="kw">kable</span>(statPerPlate, <span class="dt">caption =</span> <span class="st">&quot;Plate-wise statistics of treated cells. Column prefixes: Tr = treated cells; CC = cell control (uninfected cells); VC = virus control (infected, untreated cells). &quot;</span>)</a></code></pre></div>
<table>
<caption>Plate-wise statistics of treated cells. Column prefixes: Tr = treated cells; CC = cell control (uninfected cells); VC = virus control (infected, untreated cells).</caption>
<thead>
<tr class="header">
<th align="right">Plate</th>
<th align="right">TrMean</th>
<th align="right">TrSD</th>
<th align="right">TrMedian</th>
<th align="right">VCMedian</th>
<th align="right">CCMedian</th>
<th align="right">arbidolMean</th>
<th align="right">TrMin</th>
<th align="right">TrMax</th>
<th align="right">TrQ1</th>
<th align="right">TrQ3</th>
<th align="right">TrIQR</th>
<th align="right">scaling</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">13078.98</td>
<td align="right">6327.944</td>
<td align="right">10549.5</td>
<td align="right">10202.0</td>
<td align="right">37197.5</td>
<td align="right">31446.5</td>
<td align="right">7326</td>
<td align="right">35557</td>
<td align="right">9969.50</td>
<td align="right">12096.00</td>
<td align="right">2126.50</td>
<td align="right">0.0006344</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">18894.41</td>
<td align="right">7774.932</td>
<td align="right">17303.5</td>
<td align="right">14018.0</td>
<td align="right">51971.0</td>
<td align="right">41666.0</td>
<td align="right">10069</td>
<td align="right">43022</td>
<td align="right">13913.00</td>
<td align="right">19892.75</td>
<td align="right">5979.75</td>
<td align="right">0.0002256</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">13606.28</td>
<td align="right">4252.179</td>
<td align="right">12210.5</td>
<td align="right">10482.0</td>
<td align="right">40016.0</td>
<td align="right">28699.0</td>
<td align="right">8110</td>
<td align="right">30240</td>
<td align="right">11448.50</td>
<td align="right">14054.00</td>
<td align="right">2605.50</td>
<td align="right">0.0005177</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">18639.57</td>
<td align="right">8795.201</td>
<td align="right">15619.5</td>
<td align="right">12241.0</td>
<td align="right">44342.0</td>
<td align="right">32325.0</td>
<td align="right">8648</td>
<td align="right">41994</td>
<td align="right">12806.00</td>
<td align="right">23904.75</td>
<td align="right">11098.75</td>
<td align="right">0.0001215</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">15143.20</td>
<td align="right">6913.707</td>
<td align="right">13480.5</td>
<td align="right">9876.5</td>
<td align="right">42012.0</td>
<td align="right">30458.0</td>
<td align="right">7114</td>
<td align="right">39526</td>
<td align="right">10887.75</td>
<td align="right">16908.00</td>
<td align="right">6020.25</td>
<td align="right">0.0002241</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">13807.12</td>
<td align="right">6808.213</td>
<td align="right">11075.5</td>
<td align="right">9942.0</td>
<td align="right">38458.5</td>
<td align="right">33669.5</td>
<td align="right">7389</td>
<td align="right">35439</td>
<td align="right">9820.00</td>
<td align="right">15667.25</td>
<td align="right">5847.25</td>
<td align="right">0.0002307</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="right">15326.20</td>
<td align="right">7533.419</td>
<td align="right">12333.0</td>
<td align="right">10626.0</td>
<td align="right">39375.0</td>
<td align="right">30239.5</td>
<td align="right">8040</td>
<td align="right">43221</td>
<td align="right">11145.50</td>
<td align="right">15479.75</td>
<td align="right">4334.25</td>
<td align="right">0.0003112</td>
</tr>
<tr class="even">
<td align="right">8</td>
<td align="right">14881.32</td>
<td align="right">7091.909</td>
<td align="right">11934.5</td>
<td align="right">11185.5</td>
<td align="right">38161.0</td>
<td align="right">33668.5</td>
<td align="right">8033</td>
<td align="right">43402</td>
<td align="right">10849.50</td>
<td align="right">15586.50</td>
<td align="right">4737.00</td>
<td align="right">0.0002848</td>
</tr>
<tr class="odd">
<td align="right">9</td>
<td align="right">16608.39</td>
<td align="right">6631.827</td>
<td align="right">14154.0</td>
<td align="right">12852.5</td>
<td align="right">43904.5</td>
<td align="right">36986.5</td>
<td align="right">9418</td>
<td align="right">40831</td>
<td align="right">13261.75</td>
<td align="right">16285.50</td>
<td align="right">3023.75</td>
<td align="right">0.0004461</td>
</tr>
<tr class="even">
<td align="right">10</td>
<td align="right">16253.40</td>
<td align="right">6447.321</td>
<td align="right">14478.0</td>
<td align="right">11993.0</td>
<td align="right">42310.5</td>
<td align="right">36298.0</td>
<td align="right">8690</td>
<td align="right">39237</td>
<td align="right">12384.00</td>
<td align="right">16514.25</td>
<td align="right">4130.25</td>
<td align="right">0.0003266</td>
</tr>
<tr class="odd">
<td align="right">11</td>
<td align="right">21207.99</td>
<td align="right">8911.929</td>
<td align="right">19248.0</td>
<td align="right">12856.0</td>
<td align="right">40742.5</td>
<td align="right">38921.0</td>
<td align="right">5255</td>
<td align="right">46301</td>
<td align="right">15098.00</td>
<td align="right">26419.50</td>
<td align="right">11321.50</td>
<td align="right">0.0001192</td>
</tr>
<tr class="even">
<td align="right">12</td>
<td align="right">20477.00</td>
<td align="right">7715.348</td>
<td align="right">19350.5</td>
<td align="right">10781.5</td>
<td align="right">40187.5</td>
<td align="right">37323.0</td>
<td align="right">5248</td>
<td align="right">41624</td>
<td align="right">14512.75</td>
<td align="right">24710.50</td>
<td align="right">10197.75</td>
<td align="right">0.0001323</td>
</tr>
<tr class="odd">
<td align="right">13</td>
<td align="right">23317.91</td>
<td align="right">10141.963</td>
<td align="right">23308.5</td>
<td align="right">11987.0</td>
<td align="right">39596.5</td>
<td align="right">36009.5</td>
<td align="right">5097</td>
<td align="right">44821</td>
<td align="right">16580.00</td>
<td align="right">30565.00</td>
<td align="right">13985.00</td>
<td align="right">0.0000965</td>
</tr>
<tr class="even">
<td align="right">14</td>
<td align="right">23068.06</td>
<td align="right">8605.551</td>
<td align="right">23353.5</td>
<td align="right">12083.0</td>
<td align="right">36942.0</td>
<td align="right">30373.5</td>
<td align="right">4263</td>
<td align="right">42400</td>
<td align="right">18064.25</td>
<td align="right">28255.75</td>
<td align="right">10191.50</td>
<td align="right">0.0001324</td>
</tr>
<tr class="odd">
<td align="right">15</td>
<td align="right">23456.87</td>
<td align="right">9728.914</td>
<td align="right">23208.5</td>
<td align="right">11686.0</td>
<td align="right">38995.5</td>
<td align="right">32652.0</td>
<td align="right">4685</td>
<td align="right">45445</td>
<td align="right">16517.25</td>
<td align="right">32070.50</td>
<td align="right">15553.25</td>
<td align="right">0.0000867</td>
</tr>
<tr class="even">
<td align="right">16</td>
<td align="right">19153.77</td>
<td align="right">8060.416</td>
<td align="right">19596.0</td>
<td align="right">10090.0</td>
<td align="right">34521.5</td>
<td align="right">26980.5</td>
<td align="right">4483</td>
<td align="right">45555</td>
<td align="right">12661.00</td>
<td align="right">24257.75</td>
<td align="right">11596.75</td>
<td align="right">0.0001163</td>
</tr>
<tr class="odd">
<td align="right">17</td>
<td align="right">17726.85</td>
<td align="right">6808.917</td>
<td align="right">16780.5</td>
<td align="right">12314.5</td>
<td align="right">36445.0</td>
<td align="right">29928.0</td>
<td align="right">4983</td>
<td align="right">35715</td>
<td align="right">12940.00</td>
<td align="right">22049.00</td>
<td align="right">9109.00</td>
<td align="right">0.0001481</td>
</tr>
<tr class="even">
<td align="right">18</td>
<td align="right">20831.10</td>
<td align="right">8404.778</td>
<td align="right">18803.0</td>
<td align="right">12623.0</td>
<td align="right">40740.5</td>
<td align="right">38190.0</td>
<td align="right">5173</td>
<td align="right">44573</td>
<td align="right">15462.00</td>
<td align="right">24899.00</td>
<td align="right">9437.00</td>
<td align="right">0.0001429</td>
</tr>
<tr class="odd">
<td align="right">19</td>
<td align="right">18404.23</td>
<td align="right">8714.324</td>
<td align="right">15103.5</td>
<td align="right">10505.0</td>
<td align="right">37360.5</td>
<td align="right">32060.5</td>
<td align="right">4578</td>
<td align="right">43712</td>
<td align="right">12725.75</td>
<td align="right">23102.50</td>
<td align="right">10376.75</td>
<td align="right">0.0001300</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="co">#### Compute plate-wise IQR-standardized viability ####</span></a>
<a class="sourceLine" id="cb20-2" data-line-number="2"></a>
<a class="sourceLine" id="cb20-3" data-line-number="3"><span class="co">## Centering: substract the median</span></a>
<a class="sourceLine" id="cb20-4" data-line-number="4"><span class="co">## Scaling: divide by IQR</span></a>
<a class="sourceLine" id="cb20-5" data-line-number="5"><span class="co">## Standardize: multiply by IQR of the normal distribution</span></a>
<a class="sourceLine" id="cb20-6" data-line-number="6">plate &lt;-<span class="st"> </span><span class="kw">as.vector</span>(inhibTable<span class="op">$</span>Plate)</a>
<a class="sourceLine" id="cb20-7" data-line-number="7">inhibTable<span class="op">$</span>iqNormV &lt;-<span class="st"> </span>(inhibTable<span class="op">$</span>viability <span class="op">-</span><span class="st"> </span>statPerPlate[plate, <span class="st">&quot;TrMedian&quot;</span>]) <span class="op">*</span><span class="st"> </span>statPerPlate[plate, <span class="st">&quot;scaling&quot;</span>]</a>
<a class="sourceLine" id="cb20-8" data-line-number="8"><span class="co"># IQR(inhibTable$iqNormV)</span></a>
<a class="sourceLine" id="cb20-9" data-line-number="9"><span class="co"># IQR(rnorm(n = 1000000))</span></a>
<a class="sourceLine" id="cb20-10" data-line-number="10"></a>
<a class="sourceLine" id="cb20-11" data-line-number="11"><span class="co"># normIQR &lt;- 2 * (qnorm(p = 0.5) - qnorm(p = 0.25))</span></a>
<a class="sourceLine" id="cb20-12" data-line-number="12"><span class="co"># normII &lt;- normII * normIQR</span></a>
<a class="sourceLine" id="cb20-13" data-line-number="13"><span class="co"># sd(normII)</span></a>
<a class="sourceLine" id="cb20-14" data-line-number="14"><span class="co"># IQR(normII)</span></a></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="co">### Descriptive statistics on the IQR-standardized viability ####</span></a>
<a class="sourceLine" id="cb21-2" data-line-number="2">iqNormVstat &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb21-3" data-line-number="3">  <span class="dt">mean =</span> <span class="kw">mean</span>(inhibTable<span class="op">$</span>iqNormV),</a>
<a class="sourceLine" id="cb21-4" data-line-number="4">  <span class="dt">sd =</span> <span class="kw">sd</span>(inhibTable<span class="op">$</span>iqNormV),</a>
<a class="sourceLine" id="cb21-5" data-line-number="5">  <span class="dt">IQR =</span> <span class="kw">IQR</span>(inhibTable<span class="op">$</span>iqNormV),</a>
<a class="sourceLine" id="cb21-6" data-line-number="6">  <span class="dt">var =</span> <span class="kw">var</span>(inhibTable<span class="op">$</span>iqNormV),</a>
<a class="sourceLine" id="cb21-7" data-line-number="7">  <span class="dt">min =</span> <span class="kw">min</span>(inhibTable<span class="op">$</span>iqNormV),</a>
<a class="sourceLine" id="cb21-8" data-line-number="8">  <span class="dt">Q1 =</span> <span class="kw">as.vector</span>(<span class="kw">quantile</span>(inhibTable<span class="op">$</span>iqNormV, <span class="dt">probs =</span> <span class="fl">0.25</span>)),</a>
<a class="sourceLine" id="cb21-9" data-line-number="9">  <span class="dt">median =</span> <span class="kw">median</span>(inhibTable<span class="op">$</span>iqNormV),</a>
<a class="sourceLine" id="cb21-10" data-line-number="10">  <span class="dt">Q3 =</span> <span class="kw">as.vector</span>(<span class="kw">quantile</span>(inhibTable<span class="op">$</span>iqNormV, <span class="dt">probs =</span> <span class="fl">0.75</span>)),</a>
<a class="sourceLine" id="cb21-11" data-line-number="11">  <span class="dt">max =</span> <span class="kw">max</span>(inhibTable<span class="op">$</span>iqNormV)</a>
<a class="sourceLine" id="cb21-12" data-line-number="12">)</a>
<a class="sourceLine" id="cb21-13" data-line-number="13"></a>
<a class="sourceLine" id="cb21-14" data-line-number="14"><span class="kw">kable</span>(<span class="kw">t</span>(iqNormVstat), </a>
<a class="sourceLine" id="cb21-15" data-line-number="15">      <span class="dt">col.names =</span> <span class="st">&quot;Stat&quot;</span>, </a>
<a class="sourceLine" id="cb21-16" data-line-number="16">      <span class="dt">caption =</span> <span class="st">&quot;Statistics of the plate-wise IQR-standardized viability&quot;</span>)</a></code></pre></div>
<table>
<caption>Statistics of the plate-wise IQR-standardized viability</caption>
<thead>
<tr class="header">
<th></th>
<th align="right">Stat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>mean</td>
<td align="right">0.8456739</td>
</tr>
<tr class="even">
<td>sd</td>
<td align="right">2.6832047</td>
</tr>
<tr class="odd">
<td>IQR</td>
<td align="right">1.6171691</td>
</tr>
<tr class="even">
<td>var</td>
<td align="right">7.1995876</td>
</tr>
<tr class="odd">
<td>min</td>
<td align="right">-2.5268796</td>
</tr>
<tr class="even">
<td>Q1</td>
<td align="right">-0.4963435</td>
</tr>
<tr class="odd">
<td>median</td>
<td align="right">0.0209851</td>
</tr>
<tr class="even">
<td>Q3</td>
<td align="right">1.1208256</td>
</tr>
<tr class="odd">
<td>max</td>
<td align="right">21.9772962</td>
</tr>
</tbody>
</table>
</div>
<div id="histograms-of-inter-quartile-standardized-viability" class="section level3">
<h3>Histograms of inter-quartile standardized viability</h3>
<p>The histogram of plate-wise IQR-standardized viability shows a clear improvement : the median is much closer to the mode than with the raw or log-transformed II values.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="co">#### Histograms of IQR-standardized viability ####</span></a>
<a class="sourceLine" id="cb22-2" data-line-number="2">histBreaks =<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from =</span> <span class="kw">floor</span>(<span class="kw">min</span>(inhibTable<span class="op">$</span>iqNormV)), </a>
<a class="sourceLine" id="cb22-3" data-line-number="3">                 <span class="dt">to =</span> <span class="kw">ceiling</span>(<span class="kw">max</span>(inhibTable<span class="op">$</span>iqNormV)), <span class="dt">by =</span> <span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb22-4" data-line-number="4"></a>
<a class="sourceLine" id="cb22-5" data-line-number="5"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb22-6" data-line-number="6"><span class="kw">hist</span>(inhibTable[wellType <span class="op">==</span><span class="st"> &quot;virusCtl&quot;</span>, <span class="st">&quot;iqNormV&quot;</span>], </a>
<a class="sourceLine" id="cb22-7" data-line-number="7">     <span class="dt">main =</span> <span class="st">&quot;Virus control – IQR standardized viability&quot;</span>,</a>
<a class="sourceLine" id="cb22-8" data-line-number="8">     <span class="dt">breaks =</span> histBreaks, <span class="dt">xlab =</span> <span class="st">&quot;IQR-standardized viability&quot;</span>, </a>
<a class="sourceLine" id="cb22-9" data-line-number="9">     <span class="dt">col =</span> <span class="st">&quot;orange&quot;</span>, <span class="dt">border =</span> <span class="st">&quot;orange&quot;</span>)</a>
<a class="sourceLine" id="cb22-10" data-line-number="10"><span class="kw">hist</span>(inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;iqNormV&quot;</span>], </a>
<a class="sourceLine" id="cb22-11" data-line-number="11">     <span class="dt">main =</span> <span class="st">&quot;Treated cells – IQR standardized viability&quot;</span>,</a>
<a class="sourceLine" id="cb22-12" data-line-number="12">     <span class="dt">breaks =</span> histBreaks, <span class="dt">xlab =</span> <span class="st">&quot;IQR-standardized viability&quot;</span>, </a>
<a class="sourceLine" id="cb22-13" data-line-number="13">     <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">border =</span> <span class="st">&quot;grey&quot;</span>)</a>
<a class="sourceLine" id="cb22-14" data-line-number="14"><span class="kw">abline</span>(<span class="dt">v =</span> <span class="kw">mean</span>(inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;iqNormV&quot;</span>]), <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</a>
<a class="sourceLine" id="cb22-15" data-line-number="15"><span class="kw">abline</span>(<span class="dt">v =</span> <span class="kw">median</span>(inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;iqNormV&quot;</span>]), <span class="dt">col =</span> <span class="st">&quot;darkgreen&quot;</span>)</a>
<a class="sourceLine" id="cb22-16" data-line-number="16"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;mean&quot;</span>, <span class="st">&quot;median&quot;</span>),</a>
<a class="sourceLine" id="cb22-17" data-line-number="17">       <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;darkgreen&quot;</span>),</a>
<a class="sourceLine" id="cb22-18" data-line-number="18">       <span class="dt">lwd =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb22-19" data-line-number="19"><span class="kw">hist</span>(inhibTable[wellType <span class="op">==</span><span class="st"> &quot;cellCtl&quot;</span>, <span class="st">&quot;iqNormV&quot;</span>], </a>
<a class="sourceLine" id="cb22-20" data-line-number="20">     <span class="dt">main =</span> <span class="st">&quot;Cell control (untreated) – IQR standardized viability&quot;</span>,</a>
<a class="sourceLine" id="cb22-21" data-line-number="21">     <span class="dt">breaks =</span> histBreaks, <span class="dt">xlab =</span> <span class="st">&quot;IQR-standardized viability&quot;</span>, </a>
<a class="sourceLine" id="cb22-22" data-line-number="22">     <span class="dt">col =</span> <span class="st">&quot;palegreen&quot;</span>, <span class="dt">border =</span> <span class="st">&quot;palegreen&quot;</span>)</a></code></pre></div>
<div class="figure" style="text-align: center">
<img src="figures/touret_sars-cov-2_inhibitorsiqNormV_distrib-1.png" alt="Distribution of the plate-wise IQR-standardized viability. Top: virus control (infected, untreated); middle: treated; bottom: cell control (untreated)" width="60%" />
<p class="caption">
Distribution of the plate-wise IQR-standardized viability. Top: virus control (infected, untreated); middle: treated; bottom: cell control (untreated)
</p>
</div>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="kw">par</span>(par.ori)</a></code></pre></div>
</div>
<div id="boxplots-inter-quartile-standardized-viability" class="section level3">
<h3>Boxplots: inter-quartile standardized viability</h3>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="co">#### Boxplots of relative viability per plate ####</span></a>
<a class="sourceLine" id="cb24-2" data-line-number="2"></a>
<a class="sourceLine" id="cb24-3" data-line-number="3"><span class="co">## Box plot per plate and well type</span></a>
<a class="sourceLine" id="cb24-4" data-line-number="4"><span class="kw">boxplot</span>(iqNormV <span class="op">~</span><span class="st"> </span>Plate <span class="op">+</span><span class="st"> </span>wellType, </a>
<a class="sourceLine" id="cb24-5" data-line-number="5">        <span class="dt">main =</span> <span class="st">&quot;Inter-quartile standardized viability&quot;</span>,</a>
<a class="sourceLine" id="cb24-6" data-line-number="6">        <span class="dt">data =</span> inhibTable, </a>
<a class="sourceLine" id="cb24-7" data-line-number="7">        <span class="dt">las =</span> <span class="dv">1</span>, <span class="dt">col =</span> plateColor, </a>
<a class="sourceLine" id="cb24-8" data-line-number="8">        <span class="dt">xlab =</span> <span class="st">&quot;iqNormV&quot;</span>, </a>
<a class="sourceLine" id="cb24-9" data-line-number="9">        <span class="dt">cex.axis =</span> <span class="fl">0.5</span>, <span class="dt">cex =</span> <span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb24-10" data-line-number="10">        <span class="dt">horizontal =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb24-11" data-line-number="11"><span class="kw">abline</span>(<span class="dt">v =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="kw">max</span>(inhibTable<span class="op">$</span>iqNormV), <span class="dt">by =</span> <span class="dv">1</span>), <span class="dt">col =</span> <span class="st">&quot;#EEEEEE&quot;</span>, <span class="dt">lty =</span> <span class="st">&quot;dashed&quot;</span>)</a>
<a class="sourceLine" id="cb24-12" data-line-number="12"><span class="kw">abline</span>(<span class="dt">v =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="kw">max</span>(inhibTable<span class="op">$</span>iqNormV), <span class="dt">by =</span> <span class="dv">5</span>), <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>)</a>
<a class="sourceLine" id="cb24-13" data-line-number="13"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">legend =</span> <span class="kw">names</span>(plateColor), </a>
<a class="sourceLine" id="cb24-14" data-line-number="14">       <span class="dt">title =</span> <span class="st">&quot;Plate&quot;</span>, <span class="dt">fill =</span> plateColor, <span class="dt">cex =</span> <span class="fl">0.8</span>)</a>
<a class="sourceLine" id="cb24-15" data-line-number="15"></a>
<a class="sourceLine" id="cb24-16" data-line-number="16"><span class="co">## Add points to denote the arbidol controls</span></a>
<a class="sourceLine" id="cb24-17" data-line-number="17"><span class="kw">stripchart</span>(iqNormV <span class="op">~</span><span class="st"> </span>Plate, <span class="dt">vertical =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb24-18" data-line-number="18">           <span class="dt">data =</span> inhibTable[arbidolWells, ],</a>
<a class="sourceLine" id="cb24-19" data-line-number="19">           <span class="dt">method =</span> <span class="st">&quot;jitter&quot;</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>, <span class="dt">cex =</span> <span class="fl">0.7</span>, </a>
<a class="sourceLine" id="cb24-20" data-line-number="20">           <span class="dt">col =</span> markColor[<span class="st">&quot;Arbidol&quot;</span>], <span class="dt">pch =</span> markPCh[<span class="st">&quot;Arbidol&quot;</span>])</a></code></pre></div>
<div class="figure" style="text-align: center">
<img src="figures/touret_sars-cov-2_inhibitorsboxplots_per_plate_iqNormV-1.png" alt="Distribution of inter-quartile standardized viability (iqNormV) values per plate. Top virus control (untreated infected cells); middle: treated cells; bottom: cell control (uninfected). Black plain circles: arbidol control duplicates.  " width="80%" />
<p class="caption">
Distribution of inter-quartile standardized viability (iqNormV) values per plate. Top virus control (untreated infected cells); middle: treated cells; bottom: cell control (uninfected). Black plain circles: arbidol control duplicates.
</p>
</div>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1"><span class="kw">par</span>(par.ori)</a></code></pre></div>
<p>The above boxplots show that the inter-quartile standardization efficiently corrects for the over-dispersion of the plates 11 to 19. However we may expect a lot of sensitivity for these plates. There are however still some weaknesses.</p>
<ul>
<li><p>The vurus control show good properties: in absence of treatment, infected cells have sligtly negative values, except for 2 outliers in plate 17.</p></li>
<li><p>The cell control box plots show wide variation in their medians and dispersion:</p>
<ul>
<li><p>Uninfected cells (cell control) have much lower values in some plates (plates 4 and 11-19) than in other ones. This is not expected, since these cells should by definition have the same viability values.</p></li>
<li><p>Even for the plates where the cell controls have a high viability after IQR-based standardization, there are strong between-plates variations.</p></li>
</ul></li>
</ul>
<p>This standardization seems thus efficient to correct the apparent over-dispersion of plates 11 to 19, and thereby reduce the rate of likely false positives, but the wide between-plate variability of the untreated cells suggest that the resulting z-scores should not be interpreted as indicators of viability.</p>
</div>
<div id="dot-plots-inter-quartile-standardized-viability" class="section level3">
<h3>Dot plots: inter-quartile standardized viability</h3>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1">yRange &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">floor</span>(<span class="kw">min</span>(inhibTable<span class="op">$</span>iqNormV)), <span class="kw">ceiling</span>(<span class="kw">max</span>(inhibTable<span class="op">$</span>iqNormV)))</a>
<a class="sourceLine" id="cb26-2" data-line-number="2"></a>
<a class="sourceLine" id="cb26-3" data-line-number="3"><span class="co">## Virus control</span></a>
<a class="sourceLine" id="cb26-4" data-line-number="4"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb26-5" data-line-number="5"><span class="kw">plot</span>(inhibTable[wellType <span class="op">==</span><span class="st"> &quot;virusCtl&quot;</span>, <span class="st">&quot;iqNormV&quot;</span>],</a>
<a class="sourceLine" id="cb26-6" data-line-number="6">     <span class="dt">panel.first =</span> <span class="kw">grid</span>(),</a>
<a class="sourceLine" id="cb26-7" data-line-number="7">     <span class="dt">main =</span> <span class="st">&quot;Virus control (infected, untreated)&quot;</span>,</a>
<a class="sourceLine" id="cb26-8" data-line-number="8">     <span class="dt">xlab =</span> <span class="st">&quot;Replicates, sorted per plate&quot;</span>,</a>
<a class="sourceLine" id="cb26-9" data-line-number="9">     <span class="dt">ylab =</span> <span class="st">&quot;iqNormV&quot;</span>,</a>
<a class="sourceLine" id="cb26-10" data-line-number="10">     <span class="dt">ylim =</span> yRange,</a>
<a class="sourceLine" id="cb26-11" data-line-number="11">     <span class="dt">col =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;virusCtl&quot;</span>, <span class="st">&quot;color&quot;</span>],</a>
<a class="sourceLine" id="cb26-12" data-line-number="12">     <span class="dt">pch =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;virusCtl&quot;</span>, <span class="st">&quot;pch&quot;</span>],</a>
<a class="sourceLine" id="cb26-13" data-line-number="13">     <span class="dt">cex =</span> <span class="fl">0.5</span>, <span class="dt">las =</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb26-14" data-line-number="14">     )</a>
<a class="sourceLine" id="cb26-15" data-line-number="15"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb26-16" data-line-number="16"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, </a>
<a class="sourceLine" id="cb26-17" data-line-number="17">       <span class="dt">legend =</span> <span class="kw">names</span>(plateColor), </a>
<a class="sourceLine" id="cb26-18" data-line-number="18">       <span class="dt">col =</span> plateColor, <span class="dt">pch =</span> <span class="dv">1</span>, </a>
<a class="sourceLine" id="cb26-19" data-line-number="19">       <span class="dt">cex =</span> <span class="fl">0.7</span>)</a>
<a class="sourceLine" id="cb26-20" data-line-number="20"></a>
<a class="sourceLine" id="cb26-21" data-line-number="21"><span class="co">## Treated cells</span></a>
<a class="sourceLine" id="cb26-22" data-line-number="22"><span class="kw">plot</span>(inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;iqNormV&quot;</span>],</a>
<a class="sourceLine" id="cb26-23" data-line-number="23">     <span class="dt">panel.first =</span> <span class="kw">grid</span>(),</a>
<a class="sourceLine" id="cb26-24" data-line-number="24">     <span class="dt">main =</span> <span class="st">&quot;IQR-standardized viability (iqNormV)&quot;</span>,</a>
<a class="sourceLine" id="cb26-25" data-line-number="25">     <span class="dt">xlab =</span> <span class="st">&quot;Molecules&quot;</span>,</a>
<a class="sourceLine" id="cb26-26" data-line-number="26">     <span class="dt">ylab =</span> <span class="st">&quot;iqNormV&quot;</span>,</a>
<a class="sourceLine" id="cb26-27" data-line-number="27">     <span class="dt">ylim =</span> yRange,</a>
<a class="sourceLine" id="cb26-28" data-line-number="28">     <span class="dt">col =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;color&quot;</span>],</a>
<a class="sourceLine" id="cb26-29" data-line-number="29">     <span class="dt">pch =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;pch&quot;</span>],</a>
<a class="sourceLine" id="cb26-30" data-line-number="30">     <span class="dt">cex =</span> <span class="fl">0.5</span>, <span class="dt">las =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb26-31" data-line-number="31">     <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="kw">length</span>(inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;iqNormV&quot;</span>])<span class="op">*</span><span class="fl">1.05</span>)</a>
<a class="sourceLine" id="cb26-32" data-line-number="32">     )</a>
<a class="sourceLine" id="cb26-33" data-line-number="33"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb26-34" data-line-number="34"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, </a>
<a class="sourceLine" id="cb26-35" data-line-number="35">       <span class="dt">legend =</span> <span class="kw">names</span>(plateColor), </a>
<a class="sourceLine" id="cb26-36" data-line-number="36">       <span class="dt">col =</span> plateColor, <span class="dt">pch =</span> <span class="dv">1</span>, </a>
<a class="sourceLine" id="cb26-37" data-line-number="37">       <span class="dt">cex =</span> <span class="fl">0.7</span>)</a>
<a class="sourceLine" id="cb26-38" data-line-number="38"></a>
<a class="sourceLine" id="cb26-39" data-line-number="39"><span class="co">## Cell control</span></a>
<a class="sourceLine" id="cb26-40" data-line-number="40"><span class="kw">plot</span>(inhibTable[wellType <span class="op">==</span><span class="st"> &quot;cellCtl&quot;</span>, <span class="st">&quot;iqNormV&quot;</span>],</a>
<a class="sourceLine" id="cb26-41" data-line-number="41">     <span class="dt">panel.first =</span> <span class="kw">grid</span>(),</a>
<a class="sourceLine" id="cb26-42" data-line-number="42">     <span class="dt">main =</span> <span class="st">&quot;Cell control (uninfected)&quot;</span>,</a>
<a class="sourceLine" id="cb26-43" data-line-number="43">     <span class="dt">xlab =</span> <span class="st">&quot;Replicates, sorted per plate&quot;</span>,</a>
<a class="sourceLine" id="cb26-44" data-line-number="44">     <span class="dt">ylab =</span> <span class="st">&quot;iqNormV&quot;</span>,</a>
<a class="sourceLine" id="cb26-45" data-line-number="45">     <span class="dt">ylim =</span> yRange,</a>
<a class="sourceLine" id="cb26-46" data-line-number="46">     <span class="dt">col =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;cellCtl&quot;</span>, <span class="st">&quot;color&quot;</span>],</a>
<a class="sourceLine" id="cb26-47" data-line-number="47">     <span class="dt">pch =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;cellCtl&quot;</span>, <span class="st">&quot;pch&quot;</span>],</a>
<a class="sourceLine" id="cb26-48" data-line-number="48">     <span class="dt">cex =</span> <span class="fl">0.5</span>, <span class="dt">las =</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb26-49" data-line-number="49">     )</a>
<a class="sourceLine" id="cb26-50" data-line-number="50"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb26-51" data-line-number="51"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, </a>
<a class="sourceLine" id="cb26-52" data-line-number="52">       <span class="dt">legend =</span> <span class="kw">names</span>(plateColor), </a>
<a class="sourceLine" id="cb26-53" data-line-number="53">       <span class="dt">col =</span> plateColor, <span class="dt">pch =</span> <span class="dv">1</span>, </a>
<a class="sourceLine" id="cb26-54" data-line-number="54">       <span class="dt">cex =</span> <span class="fl">0.7</span>)</a>
<a class="sourceLine" id="cb26-55" data-line-number="55"><span class="co"># names(supTable)</span></a>
<a class="sourceLine" id="cb26-56" data-line-number="56"></a>
<a class="sourceLine" id="cb26-57" data-line-number="57"><span class="co">## Rank plot</span></a>
<a class="sourceLine" id="cb26-58" data-line-number="58">iqNormVrank &lt;-<span class="st"> </span><span class="kw">order</span>(inhibTable<span class="op">$</span>iqNormV, <span class="dt">decreasing =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb26-59" data-line-number="59"><span class="kw">plot</span>(inhibTable[iqNormVrank, <span class="st">&quot;iqNormV&quot;</span>],</a>
<a class="sourceLine" id="cb26-60" data-line-number="60">     <span class="dt">main =</span> <span class="st">&quot;Ranked IQR-standardized viability values&quot;</span>,</a>
<a class="sourceLine" id="cb26-61" data-line-number="61">     <span class="dt">xlab =</span> <span class="st">&quot;Molecules (ranked by iqNormV index)&quot;</span>,</a>
<a class="sourceLine" id="cb26-62" data-line-number="62">     <span class="dt">ylab =</span> <span class="st">&quot;iqNormV&quot;</span>,</a>
<a class="sourceLine" id="cb26-63" data-line-number="63">     <span class="dt">col =</span> inhibTable[iqNormVrank, <span class="st">&quot;color&quot;</span>],</a>
<a class="sourceLine" id="cb26-64" data-line-number="64">     <span class="dt">pch =</span> inhibTable[iqNormVrank, <span class="st">&quot;pch&quot;</span>],</a>
<a class="sourceLine" id="cb26-65" data-line-number="65">     <span class="dt">cex =</span> <span class="fl">0.5</span>, <span class="dt">las =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb26-66" data-line-number="66">     <span class="dt">panel.first =</span> <span class="kw">grid</span>(),</a>
<a class="sourceLine" id="cb26-67" data-line-number="67">     <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="kw">length</span>(iqNormVrank) <span class="op">*</span><span class="st"> </span><span class="fl">1.05</span>)</a>
<a class="sourceLine" id="cb26-68" data-line-number="68">     )</a>
<a class="sourceLine" id="cb26-69" data-line-number="69"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb26-70" data-line-number="70"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, </a>
<a class="sourceLine" id="cb26-71" data-line-number="71">       <span class="dt">legend =</span> <span class="kw">names</span>(plateColor), </a>
<a class="sourceLine" id="cb26-72" data-line-number="72">       <span class="dt">col =</span> plateColor, <span class="dt">pch =</span> <span class="dv">1</span>, </a>
<a class="sourceLine" id="cb26-73" data-line-number="73">       <span class="dt">cex =</span> <span class="fl">0.4</span>)</a></code></pre></div>
<div class="figure" style="text-align: center">
<img src="figures/touret_sars-cov-2_inhibitorsiqNormV_ranked-1.png" alt="Values of the plate-wise IQR-standardized viability index for all the tested molecules. Molecules are colored according to the plate number. A: virus control (infected untreated); B: treated cells; C: cell control (untreated cells); D: ranked values (all types). Plain triangles: virus control (untreated infected cells). Black plain circles: arbidol control duplicates per plate. Orange square: Hydroxychloroquine sulfate. " width="80%" />
<p class="caption">
Values of the plate-wise IQR-standardized viability index for all the tested molecules. Molecules are colored according to the plate number. A: virus control (infected untreated); B: treated cells; C: cell control (untreated cells); D: ranked values (all types). Plain triangles: virus control (untreated infected cells). Black plain circles: arbidol control duplicates per plate. Orange square: Hydroxychloroquine sulfate.
</p>
</div>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</a></code></pre></div>
<p>The plot of IQR-standardized viability values (top panel) clearly shows that the plate-wise normalization suppressed the background bias. However it denotes a new problem: the cell controls show striking differences depending on the plates. Noticeably,they show very high values in plates 1 and 3, and very low values in plates 11 to 19, as well as in plate 4.</p>
</div>
<div id="p-value-computation" class="section level3">
<h3>P-value computation</h3>
<p>We compute the p-value as the upper tail of the normal distribution (rigth-side test) in order to detect significantly high values of the plate-wise IQR-standardized index.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1"><span class="co">#### Compute P-value for the inhibition index ####</span></a>
<a class="sourceLine" id="cb28-2" data-line-number="2">inhibTable<span class="op">$</span>p.value &lt;-<span class="st"> </span><span class="kw">pnorm</span>(inhibTable<span class="op">$</span>iqNormV, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb28-3" data-line-number="3">inhibTable<span class="op">$</span>log10Pval &lt;-<span class="st"> </span><span class="kw">log10</span>(inhibTable<span class="op">$</span>p.value)</a>
<a class="sourceLine" id="cb28-4" data-line-number="4">inhibTable<span class="op">$</span>e.value &lt;-<span class="st"> </span>inhibTable<span class="op">$</span>p.value <span class="op">*</span><span class="st"> </span><span class="kw">sum</span>(wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>)</a>
<a class="sourceLine" id="cb28-5" data-line-number="5">inhibTable<span class="op">$</span>padj &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb28-6" data-line-number="6">inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;padj&quot;</span>] &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb28-7" data-line-number="7"><span class="st">  </span><span class="kw">p.adjust</span>(inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;p.value&quot;</span>], <span class="dt">method =</span> <span class="st">&quot;fdr&quot;</span>)</a>
<a class="sourceLine" id="cb28-8" data-line-number="8">inhibTable<span class="op">$</span>log10Padj &lt;-<span class="st"> </span><span class="kw">log10</span>(inhibTable<span class="op">$</span>padj)</a></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1"><span class="kw">hist</span>(inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;p.value&quot;</span>], </a>
<a class="sourceLine" id="cb29-2" data-line-number="2">     <span class="dt">breaks =</span> <span class="dv">20</span>, </a>
<a class="sourceLine" id="cb29-3" data-line-number="3">     <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>,</a>
<a class="sourceLine" id="cb29-4" data-line-number="4">     <span class="dt">main =</span> <span class="st">&quot;P-value histogram after plate-wise normalization&quot;</span>,</a>
<a class="sourceLine" id="cb29-5" data-line-number="5">     <span class="dt">xlab =</span> <span class="st">&quot;Nominal P-value (unadjusted)&quot;</span>,</a>
<a class="sourceLine" id="cb29-6" data-line-number="6">     <span class="dt">ylab =</span> <span class="st">&quot;Frequency&quot;</span>)</a></code></pre></div>
<div class="figure" style="text-align: center">
<img src="figures/touret_sars-cov-2_inhibitorsiqNormVpval_histogram-1.png" alt="Histogram of the nominal (unadjusted) p-values derived from the plate-wise IQR-standardized viability index. " width="60%" />
<p class="caption">
Histogram of the nominal (unadjusted) p-values derived from the plate-wise IQR-standardized viability index.
</p>
</div>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1"><span class="co">## Estimate the proportion of tests under H0 and H1 </span></a>
<a class="sourceLine" id="cb30-2" data-line-number="2"><span class="co">## following the method proposed by Storey-Tibshirani (2003)</span></a>
<a class="sourceLine" id="cb30-3" data-line-number="3"><span class="co"># lambda &lt;- 0.40</span></a>
<a class="sourceLine" id="cb30-4" data-line-number="4"><span class="co"># table(inhibTable[wellType == &quot;treated&quot;, &quot;p.value&quot;] &gt; lambda)</span></a>
<a class="sourceLine" id="cb30-5" data-line-number="5"><span class="co"># m0 &lt;- sum(inhibTable[wellType == &quot;treated&quot;, &quot;p.value&quot;] &gt; lambda) / (1 - lambda)</span></a>
<a class="sourceLine" id="cb30-6" data-line-number="6"><span class="co"># m1 &lt;- sum(wellType == &quot;treated&quot;) - m0</span></a>
<a class="sourceLine" id="cb30-7" data-line-number="7"><span class="co"># print(m0)</span></a>
<a class="sourceLine" id="cb30-8" data-line-number="8"><span class="co"># print(m1)</span></a>
<a class="sourceLine" id="cb30-9" data-line-number="9"><span class="co"># </span></a></code></pre></div>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" data-line-number="1"><span class="co">#### Manhattan plot ####</span></a>
<a class="sourceLine" id="cb31-2" data-line-number="2"><span class="kw">plot</span>(<span class="dt">x =</span> <span class="op">-</span>inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;log10Padj&quot;</span>], </a>
<a class="sourceLine" id="cb31-3" data-line-number="3">     <span class="dt">col =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;color&quot;</span>],</a>
<a class="sourceLine" id="cb31-4" data-line-number="4">     <span class="dt">pch =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;pch&quot;</span>],</a>
<a class="sourceLine" id="cb31-5" data-line-number="5">     <span class="dt">main =</span> <span class="st">&quot;Significance plot&quot;</span>,</a>
<a class="sourceLine" id="cb31-6" data-line-number="6">     <span class="dt">xlab =</span> <span class="st">&quot;Relative viability&quot;</span>,</a>
<a class="sourceLine" id="cb31-7" data-line-number="7">     <span class="dt">ylab =</span> <span class="st">&quot;Significance = -log10(Padj)&quot;</span>,</a>
<a class="sourceLine" id="cb31-8" data-line-number="8">     <span class="dt">panel.first =</span> <span class="kw">c</span>(</a>
<a class="sourceLine" id="cb31-9" data-line-number="9">       <span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>), </a>
<a class="sourceLine" id="cb31-10" data-line-number="10">       <span class="kw">abline</span>(<span class="dt">h =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="op">-</span><span class="kw">min</span>(inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;log10Padj&quot;</span>]), <span class="dv">20</span>), <span class="dt">lty =</span> <span class="st">&quot;dotted&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>),</a>
<a class="sourceLine" id="cb31-11" data-line-number="11">       <span class="kw">abline</span>(<span class="dt">v =</span> (<span class="dv">1</span><span class="op">:</span><span class="dv">19</span>) <span class="op">*</span><span class="st"> </span><span class="dv">80</span>, <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>)</a>
<a class="sourceLine" id="cb31-12" data-line-number="12">     ),</a>
<a class="sourceLine" id="cb31-13" data-line-number="13">     <span class="dt">las =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb31-14" data-line-number="14">     <span class="dt">cex =</span> <span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb31-15" data-line-number="15"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, </a>
<a class="sourceLine" id="cb31-16" data-line-number="16">       <span class="dt">legend =</span> <span class="kw">names</span>(plateColor), </a>
<a class="sourceLine" id="cb31-17" data-line-number="17">       <span class="dt">col =</span> plateColor, <span class="dt">pch =</span> <span class="dv">1</span>, </a>
<a class="sourceLine" id="cb31-18" data-line-number="18">       <span class="dt">cex =</span> <span class="fl">0.7</span>)</a></code></pre></div>
<div class="figure" style="text-align: center">
<img src="figures/touret_sars-cov-2_inhibitorsiqNormV_manhattan_plot-1.png" alt="Volcano plot. " width="80%" />
<p class="caption">
Volcano plot.
</p>
</div>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1"><span class="co">#### Volcano plot ####</span></a>
<a class="sourceLine" id="cb32-2" data-line-number="2"><span class="kw">plot</span>(<span class="dt">x =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;Vr&quot;</span>],</a>
<a class="sourceLine" id="cb32-3" data-line-number="3">     <span class="dt">y =</span> <span class="op">-</span>inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;log10Padj&quot;</span>], </a>
<a class="sourceLine" id="cb32-4" data-line-number="4">     <span class="dt">col =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;color&quot;</span>],</a>
<a class="sourceLine" id="cb32-5" data-line-number="5">     <span class="dt">pch =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;pch&quot;</span>],</a>
<a class="sourceLine" id="cb32-6" data-line-number="6">     <span class="dt">main =</span> <span class="st">&quot;Volcano plot&quot;</span>,</a>
<a class="sourceLine" id="cb32-7" data-line-number="7">     <span class="dt">xlab =</span> <span class="st">&quot;Relative viability&quot;</span>,</a>
<a class="sourceLine" id="cb32-8" data-line-number="8">     <span class="dt">ylab =</span> <span class="st">&quot;Significance = -log10(Padj)&quot;</span>)</a>
<a class="sourceLine" id="cb32-9" data-line-number="9"><span class="kw">grid</span>()</a>
<a class="sourceLine" id="cb32-10" data-line-number="10"></a>
<a class="sourceLine" id="cb32-11" data-line-number="11"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, </a>
<a class="sourceLine" id="cb32-12" data-line-number="12">       <span class="dt">legend =</span> <span class="kw">names</span>(plateColor), </a>
<a class="sourceLine" id="cb32-13" data-line-number="13">       <span class="dt">col =</span> plateColor, <span class="dt">pch =</span> <span class="dv">1</span>, </a>
<a class="sourceLine" id="cb32-14" data-line-number="14">       <span class="dt">cex =</span> <span class="fl">0.7</span>)</a></code></pre></div>
<div class="figure" style="text-align: center">
<img src="figures/touret_sars-cov-2_inhibitorsiqNormV_volcano_plot-1.png" alt="Volcano plot. " width="60%" />
<p class="caption">
Volcano plot.
</p>
</div>
</div>
</div>
<div id="three-points-normalization-with-arbidol" class="section level2">
<h2>Three-points normalization with arbidol</h2>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" data-line-number="1"><span class="co">#### Viability indices for the arbidol contron ####</span></a>
<a class="sourceLine" id="cb33-2" data-line-number="2"><span class="co"># sum(arbidolWells)</span></a>
<a class="sourceLine" id="cb33-3" data-line-number="3"><span class="kw">kable</span>(inhibTable[arbidolWells, <span class="kw">c</span>(<span class="st">&quot;Vr&quot;</span>, <span class="st">&quot;iqNormV&quot;</span>, <span class="st">&quot;log10Padj&quot;</span>)], <span class="dt">caption =</span> <span class="st">&quot;Viability indices for the arbidol controls (2 replicates per plate) &quot;</span>)</a></code></pre></div>
<table>
<caption>Viability indices for the arbidol controls (2 replicates per plate)</caption>
<thead>
<tr class="header">
<th></th>
<th align="right">Vr</th>
<th align="right">iqNormV</th>
<th align="right">log10Padj</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>01A12</td>
<td align="right">73.85675</td>
<td align="right">12.4275490</td>
<td align="right">-32.3178798</td>
</tr>
<tr class="even">
<td>01B12</td>
<td align="right">83.53614</td>
<td align="right">14.0851476</td>
<td align="right">-41.7386174</td>
</tr>
<tr class="odd">
<td>02A12</td>
<td align="right">76.42084</td>
<td align="right">5.8018695</td>
<td align="right">-6.8937539</td>
</tr>
<tr class="even">
<td>02B12</td>
<td align="right">69.27516</td>
<td align="right">5.1900660</td>
<td align="right">-5.4705606</td>
</tr>
<tr class="odd">
<td>03A12</td>
<td align="right">56.46374</td>
<td align="right">7.7389641</td>
<td align="right">-12.4691925</td>
</tr>
<tr class="even">
<td>03B12</td>
<td align="right">66.89917</td>
<td align="right">9.3346482</td>
<td align="right">-18.2166799</td>
</tr>
<tr class="odd">
<td>04A12</td>
<td align="right">51.48438</td>
<td align="right">1.5981130</td>
<td align="right">-0.4177311</td>
</tr>
<tr class="even">
<td>04B12</td>
<td align="right">73.64568</td>
<td align="right">2.4627726</td>
<td align="right">-1.0961060</td>
</tr>
<tr class="odd">
<td>05A12</td>
<td align="right">62.30337</td>
<td align="right">3.6787294</td>
<td align="right">-2.6575853</td>
</tr>
<tr class="even">
<td>05B12</td>
<td align="right">65.78861</td>
<td align="right">3.9296920</td>
<td align="right">-3.0420868</td>
</tr>
<tr class="odd">
<td>06A12</td>
<td align="right">80.01683</td>
<td align="right">5.0026843</td>
<td align="right">-5.0885199</td>
</tr>
<tr class="even">
<td>06B12</td>
<td align="right">86.39560</td>
<td align="right">5.4223335</td>
<td align="right">-5.9921058</td>
</tr>
<tr class="odd">
<td>07A12</td>
<td align="right">72.54165</td>
<td align="right">5.9595684</td>
<td align="right">-7.2737070</td>
</tr>
<tr class="even">
<td>07B12</td>
<td align="right">63.90483</td>
<td align="right">5.1867667</td>
<td align="right">-5.4705606</td>
</tr>
<tr class="odd">
<td>08A12</td>
<td align="right">80.86412</td>
<td align="right">5.9986444</td>
<td align="right">-7.3537397</td>
</tr>
<tr class="even">
<td>08B12</td>
<td align="right">85.82788</td>
<td align="right">6.3799583</td>
<td align="right">-8.3653050</td>
</tr>
<tr class="odd">
<td>09A12</td>
<td align="right">71.29170</td>
<td align="right">9.2955227</td>
<td align="right">-18.0887986</td>
</tr>
<tr class="even">
<td>09B12</td>
<td align="right">84.15078</td>
<td align="right">11.0769118</td>
<td align="right">-25.7430361</td>
</tr>
<tr class="odd">
<td>10A12</td>
<td align="right">82.45403</td>
<td align="right">7.3529630</td>
<td align="right">-11.2189130</td>
</tr>
<tr class="even">
<td>10B12</td>
<td align="right">77.88241</td>
<td align="right">6.9002820</td>
<td align="right">-9.8404583</td>
</tr>
<tr class="odd">
<td>11A12</td>
<td align="right">99.33480</td>
<td align="right">2.5390102</td>
<td align="right">-1.1699219</td>
</tr>
<tr class="even">
<td>11B12</td>
<td align="right">87.60153</td>
<td align="right">2.1491448</td>
<td align="right">-0.8285687</td>
</tr>
<tr class="odd">
<td>12A12</td>
<td align="right">93.84649</td>
<td align="right">2.5169971</td>
<td align="right">-1.1591100</td>
</tr>
<tr class="even">
<td>12B12</td>
<td align="right">86.67109</td>
<td align="right">2.2378820</td>
<td align="right">-0.9018416</td>
</tr>
<tr class="odd">
<td>13A12</td>
<td align="right">92.60218</td>
<td align="right">1.3741071</td>
<td align="right">-0.2871946</td>
</tr>
<tr class="even">
<td>13B12</td>
<td align="right">81.41401</td>
<td align="right">1.0761451</td>
<td align="right">-0.1553551</td>
</tr>
<tr class="odd">
<td>14A12</td>
<td align="right">68.51040</td>
<td align="right">0.7624782</td>
<td align="right">-0.0762164</td>
</tr>
<tr class="even">
<td>14B12</td>
<td align="right">78.64355</td>
<td align="right">1.0959011</td>
<td align="right">-0.1634674</td>
</tr>
<tr class="odd">
<td>15A12</td>
<td align="right">78.50016</td>
<td align="right">0.8600007</td>
<td align="right">-0.0957624</td>
</tr>
<tr class="even">
<td>15B12</td>
<td align="right">75.04348</td>
<td align="right">0.7781248</td>
<td align="right">-0.0791430</td>
</tr>
<tr class="odd">
<td>16A12</td>
<td align="right">75.66461</td>
<td align="right">1.0445889</td>
<td align="right">-0.1460609</td>
</tr>
<tr class="even">
<td>16B12</td>
<td align="right">62.60361</td>
<td align="right">0.6733992</td>
<td align="right">-0.0552944</td>
</tr>
<tr class="odd">
<td>17A12</td>
<td align="right">75.26367</td>
<td align="right">2.0282082</td>
<td align="right">-0.7396688</td>
</tr>
<tr class="even">
<td>17B12</td>
<td align="right">70.72170</td>
<td align="right">1.8658983</td>
<td align="right">-0.6123467</td>
</tr>
<tr class="odd">
<td>18A12</td>
<td align="right">87.37619</td>
<td align="right">2.6284873</td>
<td align="right">-1.2650548</td>
</tr>
<tr class="even">
<td>18B12</td>
<td align="right">94.48208</td>
<td align="right">2.9140930</td>
<td align="right">-1.5917678</td>
</tr>
<tr class="odd">
<td>19A12</td>
<td align="right">81.17518</td>
<td align="right">2.2361983</td>
<td align="right">-0.9018416</td>
</tr>
<tr class="even">
<td>19B12</td>
<td align="right">79.35432</td>
<td align="right">2.1726282</td>
<td align="right">-0.8489690</td>
</tr>
</tbody>
</table>
</div>
<div id="selection-of-candidate-molecules" class="section level2">
<h2>Selection of candidate molecules</h2>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1"><span class="co">#### Select significant normalized II values ####</span></a>
<a class="sourceLine" id="cb34-2" data-line-number="2">alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></a>
<a class="sourceLine" id="cb34-3" data-line-number="3"></a>
<a class="sourceLine" id="cb34-4" data-line-number="4"><span class="kw">kable</span>(<span class="kw">table</span>(inhibTable<span class="op">$</span>padj <span class="op">&lt;</span><span class="st"> </span>alpha))</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Var1</th>
<th align="right">Freq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">FALSE</td>
<td align="right">1439</td>
</tr>
<tr class="even">
<td align="left">TRUE</td>
<td align="right">119</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" data-line-number="1"><span class="co"># table(inhibTable$padj &lt; alpha)</span></a>
<a class="sourceLine" id="cb35-2" data-line-number="2">selected &lt;-<span class="st"> </span><span class="kw">subset</span>(inhibTable, inhibTable<span class="op">$</span>padj <span class="op">&lt;</span><span class="st"> </span>alpha)</a>
<a class="sourceLine" id="cb35-3" data-line-number="3"></a>
<a class="sourceLine" id="cb35-4" data-line-number="4"><span class="co">## Sort by decreasing adjusted p-value</span></a>
<a class="sourceLine" id="cb35-5" data-line-number="5">selected &lt;-<span class="st"> </span>selected[<span class="kw">order</span>(selected<span class="op">$</span>padj, <span class="dt">decreasing =</span> <span class="ot">FALSE</span>), ]</a>
<a class="sourceLine" id="cb35-6" data-line-number="6"><span class="co"># kable(names(selected), row.names=TRUE)</span></a>
<a class="sourceLine" id="cb35-7" data-line-number="7"></a>
<a class="sourceLine" id="cb35-8" data-line-number="8"><span class="co">## Print selected molecules</span></a>
<a class="sourceLine" id="cb35-9" data-line-number="9"><span class="kw">kable</span>(selected[ , <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dv">5</span><span class="op">:</span><span class="dv">7</span>, <span class="dv">10</span>, <span class="dv">12</span>, <span class="dv">15</span>)], </a>
<a class="sourceLine" id="cb35-10" data-line-number="10">      <span class="dt">row.names =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb35-11" data-line-number="11">      <span class="dt">digits =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb35-12" data-line-number="12">      <span class="dt">caption =</span> <span class="st">&quot;Candidate moecules sorted by significance after plate-wise normalization. &quot;</span>)</a></code></pre></div>
<table>
<caption>Candidate moecules sorted by significance after plate-wise normalization.</caption>
<thead>
<tr class="header">
<th align="left">ID</th>
<th align="right">Plate</th>
<th align="left">Row</th>
<th align="right">viability</th>
<th align="right">cellControl</th>
<th align="right">virusControl</th>
<th align="left">Broad.Therapeutic.class</th>
<th align="right">Inhibition.Index</th>
<th align="right">log2V</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">01F08</td>
<td align="right">1</td>
<td align="left">F</td>
<td align="right">35557</td>
<td align="right">37964.25</td>
<td align="right">10135.667</td>
<td align="left">Neuromuscular</td>
<td align="right">1.1929</td>
<td align="right">15.1178</td>
</tr>
<tr class="even">
<td align="left">01B12</td>
<td align="right">1</td>
<td align="left">B</td>
<td align="right">32753</td>
<td align="right">37964.25</td>
<td align="right">10135.667</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">14.9993</td>
</tr>
<tr class="odd">
<td align="left">01A12</td>
<td align="right">1</td>
<td align="left">A</td>
<td align="right">30140</td>
<td align="right">37964.25</td>
<td align="right">10135.667</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">14.8794</td>
</tr>
<tr class="even">
<td align="left">01H07</td>
<td align="right">1</td>
<td align="left">H</td>
<td align="right">29517</td>
<td align="right">37964.25</td>
<td align="right">10135.667</td>
<td align="left">Neuromuscular</td>
<td align="right">0.9095</td>
<td align="right">14.8493</td>
</tr>
<tr class="odd">
<td align="left">09F04</td>
<td align="right">9</td>
<td align="left">F</td>
<td align="right">40831</td>
<td align="right">43177.12</td>
<td align="right">13104.833</td>
<td align="left">Central Nervous System</td>
<td align="right">1.1610</td>
<td align="right">15.3174</td>
</tr>
<tr class="even">
<td align="left">01A06</td>
<td align="right">1</td>
<td align="left">A</td>
<td align="right">28661</td>
<td align="right">37964.25</td>
<td align="right">10135.667</td>
<td align="left">Neuromuscular</td>
<td align="right">0.8693</td>
<td align="right">14.8068</td>
</tr>
<tr class="odd">
<td align="left">09B12</td>
<td align="right">9</td>
<td align="left">B</td>
<td align="right">38983</td>
<td align="right">43177.12</td>
<td align="right">13104.833</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">15.2506</td>
</tr>
<tr class="even">
<td align="left">09D04</td>
<td align="right">9</td>
<td align="left">D</td>
<td align="right">38231</td>
<td align="right">43177.12</td>
<td align="right">13104.833</td>
<td align="left">Central Nervous System</td>
<td align="right">1.0521</td>
<td align="right">15.2225</td>
</tr>
<tr class="odd">
<td align="left">01D05</td>
<td align="right">1</td>
<td align="left">D</td>
<td align="right">26302</td>
<td align="right">37964.25</td>
<td align="right">10135.667</td>
<td align="left">Metabolism</td>
<td align="right">0.7586</td>
<td align="right">14.6829</td>
</tr>
<tr class="even">
<td align="left">01D08</td>
<td align="right">1</td>
<td align="left">D</td>
<td align="right">25951</td>
<td align="right">37964.25</td>
<td align="right">10135.667</td>
<td align="left">Infectiology</td>
<td align="right">0.7421</td>
<td align="right">14.6635</td>
</tr>
<tr class="odd">
<td align="left">07G07</td>
<td align="right">7</td>
<td align="left">G</td>
<td align="right">43221</td>
<td align="right">39295.12</td>
<td align="right">10537.833</td>
<td align="left">Endocrinology</td>
<td align="right">1.6589</td>
<td align="right">15.3994</td>
</tr>
<tr class="even">
<td align="left">01H05</td>
<td align="right">1</td>
<td align="left">H</td>
<td align="right">25447</td>
<td align="right">37964.25</td>
<td align="right">10135.667</td>
<td align="left">Central Nervous System</td>
<td align="right">0.7185</td>
<td align="right">14.6352</td>
</tr>
<tr class="odd">
<td align="left">03B12</td>
<td align="right">3</td>
<td align="left">B</td>
<td align="right">30240</td>
<td align="right">39305.25</td>
<td align="right">10619.000</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">14.8842</td>
</tr>
<tr class="even">
<td align="left">09A12</td>
<td align="right">9</td>
<td align="left">A</td>
<td align="right">34990</td>
<td align="right">43177.12</td>
<td align="right">13104.833</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">15.0947</td>
</tr>
<tr class="odd">
<td align="left">08E11</td>
<td align="right">8</td>
<td align="left">E</td>
<td align="right">43402</td>
<td align="right">38082.62</td>
<td align="right">11173.500</td>
<td align="left">Metabolism</td>
<td align="right">1.4327</td>
<td align="right">15.4055</td>
</tr>
<tr class="even">
<td align="left">09G07</td>
<td align="right">9</td>
<td align="left">G</td>
<td align="right">33578</td>
<td align="right">43177.12</td>
<td align="right">13104.833</td>
<td align="left">Allergology ’Central Nervous System</td>
<td align="right">0.8573</td>
<td align="right">15.0352</td>
</tr>
<tr class="odd">
<td align="left">03G08</td>
<td align="right">3</td>
<td align="left">G</td>
<td align="right">28831</td>
<td align="right">39305.25</td>
<td align="right">10619.000</td>
<td align="left">Allergology ’Dermatology ’Infectiology</td>
<td align="right">1.0073</td>
<td align="right">14.8153</td>
</tr>
<tr class="even">
<td align="left">01H03</td>
<td align="right">1</td>
<td align="left">H</td>
<td align="right">24085</td>
<td align="right">37964.25</td>
<td align="right">10135.667</td>
<td align="left">Central Nervous System</td>
<td align="right">0.6546</td>
<td align="right">14.5558</td>
</tr>
<tr class="odd">
<td align="left">03H10</td>
<td align="right">3</td>
<td align="left">H</td>
<td align="right">28214</td>
<td align="right">39305.25</td>
<td align="right">10619.000</td>
<td align="left">Allergology ’Central Nervous System</td>
<td align="right">0.9732</td>
<td align="right">14.7841</td>
</tr>
<tr class="even">
<td align="left">09G08</td>
<td align="right">9</td>
<td align="left">G</td>
<td align="right">32682</td>
<td align="right">43177.12</td>
<td align="right">13104.833</td>
<td align="left">Allergology ’Central Nervous System</td>
<td align="right">0.8198</td>
<td align="right">14.9962</td>
</tr>
<tr class="odd">
<td align="left">10G08</td>
<td align="right">10</td>
<td align="left">G</td>
<td align="right">39237</td>
<td align="right">42600.38</td>
<td align="right">12007.833</td>
<td align="left">Infectiology</td>
<td align="right">1.1210</td>
<td align="right">15.2599</td>
</tr>
<tr class="even">
<td align="left">01G11</td>
<td align="right">1</td>
<td align="left">G</td>
<td align="right">22800</td>
<td align="right">37964.25</td>
<td align="right">10135.667</td>
<td align="left">Infectiology</td>
<td align="right">0.5943</td>
<td align="right">14.4767</td>
</tr>
<tr class="odd">
<td align="left">03A12</td>
<td align="right">3</td>
<td align="left">A</td>
<td align="right">27158</td>
<td align="right">39305.25</td>
<td align="right">10619.000</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">14.7291</td>
</tr>
<tr class="even">
<td align="left">07G09</td>
<td align="right">7</td>
<td align="left">G</td>
<td align="right">37155</td>
<td align="right">39295.12</td>
<td align="right">10537.833</td>
<td align="left">Metabolism</td>
<td align="right">1.3510</td>
<td align="right">15.1813</td>
</tr>
<tr class="odd">
<td align="left">10A12</td>
<td align="right">10</td>
<td align="left">A</td>
<td align="right">36991</td>
<td align="right">42600.38</td>
<td align="right">12007.833</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">15.1749</td>
</tr>
<tr class="even">
<td align="left">07B04</td>
<td align="right">7</td>
<td align="left">B</td>
<td align="right">35140</td>
<td align="right">39295.12</td>
<td align="right">10537.833</td>
<td align="left">Gastroenterology</td>
<td align="right">1.2487</td>
<td align="right">15.1008</td>
</tr>
<tr class="odd">
<td align="left">01H04</td>
<td align="right">1</td>
<td align="left">H</td>
<td align="right">21606</td>
<td align="right">37964.25</td>
<td align="right">10135.667</td>
<td align="left">Central Nervous System</td>
<td align="right">0.5382</td>
<td align="right">14.3991</td>
</tr>
<tr class="even">
<td align="left">10B12</td>
<td align="right">10</td>
<td align="left">B</td>
<td align="right">35605</td>
<td align="right">42600.38</td>
<td align="right">12007.833</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">15.1198</td>
</tr>
<tr class="odd">
<td align="left">08D06</td>
<td align="right">8</td>
<td align="left">D</td>
<td align="right">35840</td>
<td align="right">38082.62</td>
<td align="right">11173.500</td>
<td align="left">Endocrinology</td>
<td align="right">1.0965</td>
<td align="right">15.1293</td>
</tr>
<tr class="even">
<td align="left">01C05</td>
<td align="right">1</td>
<td align="left">C</td>
<td align="right">20965</td>
<td align="right">37964.25</td>
<td align="right">10135.667</td>
<td align="left">Endocrinology</td>
<td align="right">0.5082</td>
<td align="right">14.3557</td>
</tr>
<tr class="odd">
<td align="left">10D08</td>
<td align="right">10</td>
<td align="left">D</td>
<td align="right">34265</td>
<td align="right">42600.38</td>
<td align="right">12007.833</td>
<td align="left">Endocrinology</td>
<td align="right">0.9163</td>
<td align="right">15.0644</td>
</tr>
<tr class="even">
<td align="left">08B12</td>
<td align="right">8</td>
<td align="left">B</td>
<td align="right">34338</td>
<td align="right">38082.62</td>
<td align="right">11173.500</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">15.0675</td>
</tr>
<tr class="odd">
<td align="left">03B05</td>
<td align="right">3</td>
<td align="left">B</td>
<td align="right">24413</td>
<td align="right">39305.25</td>
<td align="right">10619.000</td>
<td align="left">Neuromuscular</td>
<td align="right">0.7629</td>
<td align="right">14.5754</td>
</tr>
<tr class="even">
<td align="left">08H03</td>
<td align="right">8</td>
<td align="left">H</td>
<td align="right">33883</td>
<td align="right">38082.62</td>
<td align="right">11173.500</td>
<td align="left">Ophthalmology</td>
<td align="right">1.0095</td>
<td align="right">15.0483</td>
</tr>
<tr class="odd">
<td align="left">08A12</td>
<td align="right">8</td>
<td align="left">A</td>
<td align="right">32999</td>
<td align="right">38082.62</td>
<td align="right">11173.500</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">15.0101</td>
</tr>
<tr class="even">
<td align="left">09G09</td>
<td align="right">9</td>
<td align="left">G</td>
<td align="right">27535</td>
<td align="right">43177.12</td>
<td align="right">13104.833</td>
<td align="left">Infectiology</td>
<td align="right">0.6042</td>
<td align="right">14.7490</td>
</tr>
<tr class="odd">
<td align="left">07A12</td>
<td align="right">7</td>
<td align="left">A</td>
<td align="right">31481</td>
<td align="right">39295.12</td>
<td align="right">10537.833</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">14.9422</td>
</tr>
<tr class="even">
<td align="left">01E08</td>
<td align="right">1</td>
<td align="left">E</td>
<td align="right">19837</td>
<td align="right">37964.25</td>
<td align="right">10135.667</td>
<td align="left">Hematology</td>
<td align="right">0.4552</td>
<td align="right">14.2759</td>
</tr>
<tr class="odd">
<td align="left">05A10</td>
<td align="right">5</td>
<td align="left">A</td>
<td align="right">39526</td>
<td align="right">39914.62</td>
<td align="right">9950.833</td>
<td align="left">Central Nervous System</td>
<td align="right">1.4422</td>
<td align="right">15.2705</td>
</tr>
<tr class="even">
<td align="left">02A12</td>
<td align="right">2</td>
<td align="left">A</td>
<td align="right">43022</td>
<td align="right">49597.88</td>
<td align="right">14070.500</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">15.3928</td>
</tr>
<tr class="odd">
<td align="left">10H10</td>
<td align="right">10</td>
<td align="left">H</td>
<td align="right">32205</td>
<td align="right">42600.38</td>
<td align="right">12007.833</td>
<td align="left">Central Nervous System</td>
<td align="right">0.8315</td>
<td align="right">14.9750</td>
</tr>
<tr class="even">
<td align="left">07H07</td>
<td align="right">7</td>
<td align="left">H</td>
<td align="right">30870</td>
<td align="right">39295.12</td>
<td align="right">10537.833</td>
<td align="left">Central Nervous System</td>
<td align="right">1.0320</td>
<td align="right">14.9139</td>
</tr>
<tr class="odd">
<td align="left">06D11</td>
<td align="right">6</td>
<td align="left">D</td>
<td align="right">35439</td>
<td align="right">38823.25</td>
<td align="right">10013.833</td>
<td align="left">Endocrinology</td>
<td align="right">1.0748</td>
<td align="right">15.1131</td>
</tr>
<tr class="even">
<td align="left">01G06</td>
<td align="right">1</td>
<td align="left">G</td>
<td align="right">19381</td>
<td align="right">37964.25</td>
<td align="right">10135.667</td>
<td align="left">Allergology ’Central Nervous System</td>
<td align="right">0.4338</td>
<td align="right">14.2424</td>
</tr>
<tr class="odd">
<td align="left">06B12</td>
<td align="right">6</td>
<td align="left">B</td>
<td align="right">34579</td>
<td align="right">38823.25</td>
<td align="right">10013.833</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">15.0776</td>
</tr>
<tr class="even">
<td align="left">09D02</td>
<td align="right">9</td>
<td align="left">D</td>
<td align="right">26112</td>
<td align="right">43177.12</td>
<td align="right">13104.833</td>
<td align="left">Endocrinology</td>
<td align="right">0.5447</td>
<td align="right">14.6724</td>
</tr>
<tr class="odd">
<td align="left">06H02</td>
<td align="right">6</td>
<td align="left">H</td>
<td align="right">33631</td>
<td align="right">38823.25</td>
<td align="right">10013.833</td>
<td align="left">Oncology</td>
<td align="right">0.9984</td>
<td align="right">15.0375</td>
</tr>
<tr class="even">
<td align="left">02B12</td>
<td align="right">2</td>
<td align="left">B</td>
<td align="right">40310</td>
<td align="right">49597.88</td>
<td align="right">14070.500</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">15.2989</td>
</tr>
<tr class="odd">
<td align="left">02C08</td>
<td align="right">2</td>
<td align="left">C</td>
<td align="right">40283</td>
<td align="right">49597.88</td>
<td align="right">14070.500</td>
<td align="left">Endocrinology</td>
<td align="right">0.9499</td>
<td align="right">15.2979</td>
</tr>
<tr class="even">
<td align="left">07B12</td>
<td align="right">7</td>
<td align="left">B</td>
<td align="right">28998</td>
<td align="right">39295.12</td>
<td align="right">10537.833</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">14.8237</td>
</tr>
<tr class="odd">
<td align="left">07B03</td>
<td align="right">7</td>
<td align="left">B</td>
<td align="right">28977</td>
<td align="right">39295.12</td>
<td align="right">10537.833</td>
<td align="left">Infectiology</td>
<td align="right">0.9359</td>
<td align="right">14.8226</td>
</tr>
<tr class="even">
<td align="left">07F02</td>
<td align="right">7</td>
<td align="left">F</td>
<td align="right">28578</td>
<td align="right">39295.12</td>
<td align="right">10537.833</td>
<td align="left">Central Nervous System</td>
<td align="right">0.9157</td>
<td align="right">14.8026</td>
</tr>
<tr class="odd">
<td align="left">08H02</td>
<td align="right">8</td>
<td align="left">H</td>
<td align="right">29549</td>
<td align="right">38082.62</td>
<td align="right">11173.500</td>
<td align="left">Metabolism</td>
<td align="right">0.8169</td>
<td align="right">14.8508</td>
</tr>
<tr class="even">
<td align="left">06A12</td>
<td align="right">6</td>
<td align="left">A</td>
<td align="right">32760</td>
<td align="right">38823.25</td>
<td align="right">10013.833</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">14.9996</td>
</tr>
<tr class="odd">
<td align="left">07H10</td>
<td align="right">7</td>
<td align="left">H</td>
<td align="right">28271</td>
<td align="right">39295.12</td>
<td align="right">10537.833</td>
<td align="left">Dermatology</td>
<td align="right">0.9001</td>
<td align="right">14.7870</td>
</tr>
<tr class="even">
<td align="left">07C10</td>
<td align="right">7</td>
<td align="left">C</td>
<td align="right">28189</td>
<td align="right">39295.12</td>
<td align="right">10537.833</td>
<td align="left">Central Nervous System</td>
<td align="right">0.8959</td>
<td align="right">14.7828</td>
</tr>
<tr class="odd">
<td align="left">02B04</td>
<td align="right">2</td>
<td align="left">B</td>
<td align="right">38458</td>
<td align="right">49597.88</td>
<td align="right">14070.500</td>
<td align="left">Central Nervous System</td>
<td align="right">0.8837</td>
<td align="right">15.2310</td>
</tr>
<tr class="even">
<td align="left">07C03</td>
<td align="right">7</td>
<td align="left">C</td>
<td align="right">27275</td>
<td align="right">39295.12</td>
<td align="right">10537.833</td>
<td align="left">Central Nervous System</td>
<td align="right">0.8495</td>
<td align="right">14.7353</td>
</tr>
<tr class="odd">
<td align="left">10A08</td>
<td align="right">10</td>
<td align="left">A</td>
<td align="right">28693</td>
<td align="right">42600.38</td>
<td align="right">12007.833</td>
<td align="left">Infectiology</td>
<td align="right">0.6869</td>
<td align="right">14.8084</td>
</tr>
<tr class="even">
<td align="left">03F02</td>
<td align="right">3</td>
<td align="left">F</td>
<td align="right">20971</td>
<td align="right">39305.25</td>
<td align="right">10619.000</td>
<td align="left">Central Nervous System ’Hematology ’Metabolism</td>
<td align="right">0.5726</td>
<td align="right">14.3561</td>
</tr>
<tr class="odd">
<td align="left">09G04</td>
<td align="right">9</td>
<td align="left">G</td>
<td align="right">24235</td>
<td align="right">43177.12</td>
<td align="right">13104.833</td>
<td align="left">Central Nervous System ’Metabolism</td>
<td align="right">0.4661</td>
<td align="right">14.5648</td>
</tr>
<tr class="even">
<td align="left">10E06</td>
<td align="right">10</td>
<td align="left">E</td>
<td align="right">27835</td>
<td align="right">42600.38</td>
<td align="right">12007.833</td>
<td align="left">Metabolism</td>
<td align="right">0.6516</td>
<td align="right">14.7646</td>
</tr>
<tr class="odd">
<td align="left">06F06</td>
<td align="right">6</td>
<td align="left">F</td>
<td align="right">29752</td>
<td align="right">38823.25</td>
<td align="right">10013.833</td>
<td align="left">Allergology</td>
<td align="right">0.8344</td>
<td align="right">14.8607</td>
</tr>
<tr class="even">
<td align="left">02B03</td>
<td align="right">2</td>
<td align="left">B</td>
<td align="right">36351</td>
<td align="right">49597.88</td>
<td align="right">14070.500</td>
<td align="left">Central Nervous System</td>
<td align="right">0.8074</td>
<td align="right">15.1497</td>
</tr>
<tr class="odd">
<td align="left">09F10</td>
<td align="right">9</td>
<td align="left">F</td>
<td align="right">23712</td>
<td align="right">43177.12</td>
<td align="right">13104.833</td>
<td align="left">Endocrinology</td>
<td align="right">0.4442</td>
<td align="right">14.5333</td>
</tr>
<tr class="even">
<td align="left">05E07</td>
<td align="right">5</td>
<td align="left">E</td>
<td align="right">32203</td>
<td align="right">39914.62</td>
<td align="right">9950.833</td>
<td align="left">Respiratory</td>
<td align="right">1.0851</td>
<td align="right">14.9749</td>
</tr>
<tr class="odd">
<td align="left">07H06</td>
<td align="right">7</td>
<td align="left">H</td>
<td align="right">25806</td>
<td align="right">39295.12</td>
<td align="right">10537.833</td>
<td align="left">Infectiology ’Metabolism</td>
<td align="right">0.7750</td>
<td align="right">14.6554</td>
</tr>
<tr class="even">
<td align="left">08G02</td>
<td align="right">8</td>
<td align="left">G</td>
<td align="right">26652</td>
<td align="right">38082.62</td>
<td align="right">11173.500</td>
<td align="left">Allergology</td>
<td align="right">0.6881</td>
<td align="right">14.7020</td>
</tr>
<tr class="odd">
<td align="left">09A09</td>
<td align="right">9</td>
<td align="left">A</td>
<td align="right">23449</td>
<td align="right">43177.12</td>
<td align="right">13104.833</td>
<td align="left">Cardiovascular</td>
<td align="right">0.4331</td>
<td align="right">14.5172</td>
</tr>
<tr class="even">
<td align="left">08E07</td>
<td align="right">8</td>
<td align="left">E</td>
<td align="right">26367</td>
<td align="right">38082.62</td>
<td align="right">11173.500</td>
<td align="left">Infectiology</td>
<td align="right">0.6754</td>
<td align="right">14.6864</td>
</tr>
<tr class="odd">
<td align="left">08B06</td>
<td align="right">8</td>
<td align="left">B</td>
<td align="right">26146</td>
<td align="right">38082.62</td>
<td align="right">11173.500</td>
<td align="left">Metabolism</td>
<td align="right">0.6656</td>
<td align="right">14.6743</td>
</tr>
<tr class="even">
<td align="left">09G02</td>
<td align="right">9</td>
<td align="left">G</td>
<td align="right">23192</td>
<td align="right">43177.12</td>
<td align="right">13104.833</td>
<td align="left">Central Nervous System</td>
<td align="right">0.4224</td>
<td align="right">14.5013</td>
</tr>
<tr class="odd">
<td align="left">05B12</td>
<td align="right">5</td>
<td align="left">B</td>
<td align="right">31018</td>
<td align="right">39914.62</td>
<td align="right">9950.833</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">14.9208</td>
</tr>
<tr class="even">
<td align="left">07D09</td>
<td align="right">7</td>
<td align="left">D</td>
<td align="right">24842</td>
<td align="right">39295.12</td>
<td align="right">10537.833</td>
<td align="left">Endocrinology</td>
<td align="right">0.7260</td>
<td align="right">14.6005</td>
</tr>
<tr class="odd">
<td align="left">02B07</td>
<td align="right">2</td>
<td align="left">B</td>
<td align="right">34533</td>
<td align="right">49597.88</td>
<td align="right">14070.500</td>
<td align="left">Central Nervous System</td>
<td align="right">0.7415</td>
<td align="right">15.0757</td>
</tr>
<tr class="even">
<td align="left">10C04</td>
<td align="right">10</td>
<td align="left">C</td>
<td align="right">26226</td>
<td align="right">42600.38</td>
<td align="right">12007.833</td>
<td align="left">Metabolism</td>
<td align="right">0.5853</td>
<td align="right">14.6787</td>
</tr>
<tr class="odd">
<td align="left">05F11</td>
<td align="right">5</td>
<td align="left">F</td>
<td align="right">30496</td>
<td align="right">39914.62</td>
<td align="right">9950.833</td>
<td align="left">Central Nervous System</td>
<td align="right">1.0019</td>
<td align="right">14.8963</td>
</tr>
<tr class="even">
<td align="left">02F05</td>
<td align="right">2</td>
<td align="left">F</td>
<td align="right">34108</td>
<td align="right">49597.88</td>
<td align="right">14070.500</td>
<td align="left">Cardiovascular ’Hematology ’Metabolism</td>
<td align="right">0.7261</td>
<td align="right">15.0578</td>
</tr>
<tr class="odd">
<td align="left">19B02</td>
<td align="right">19</td>
<td align="left">B</td>
<td align="right">43712</td>
<td align="right">37547.62</td>
<td align="right">10838.667</td>
<td align="left">Cardiovascular</td>
<td align="right">1.5490</td>
<td align="right">15.4157</td>
</tr>
<tr class="even">
<td align="left">02G02</td>
<td align="right">2</td>
<td align="left">G</td>
<td align="right">33661</td>
<td align="right">49597.88</td>
<td align="right">14070.500</td>
<td align="left">Cardiovascular</td>
<td align="right">0.7099</td>
<td align="right">15.0388</td>
</tr>
<tr class="odd">
<td align="left">03E06</td>
<td align="right">3</td>
<td align="left">E</td>
<td align="right">19319</td>
<td align="right">39305.25</td>
<td align="right">10619.000</td>
<td align="left">Central Nervous System ’Metabolism</td>
<td align="right">0.4812</td>
<td align="right">14.2377</td>
</tr>
<tr class="even">
<td align="left">05A12</td>
<td align="right">5</td>
<td align="left">A</td>
<td align="right">29898</td>
<td align="right">39914.62</td>
<td align="right">9950.833</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">14.8678</td>
</tr>
<tr class="odd">
<td align="left">18B09</td>
<td align="right">18</td>
<td align="left">B</td>
<td align="right">44573</td>
<td align="right">39976.62</td>
<td align="right">13087.000</td>
<td align="left">Neuromuscular</td>
<td align="right">1.2543</td>
<td align="right">15.4439</td>
</tr>
<tr class="even">
<td align="left">06G08</td>
<td align="right">6</td>
<td align="left">G</td>
<td align="right">26690</td>
<td align="right">38823.25</td>
<td align="right">10013.833</td>
<td align="left">Infectiology</td>
<td align="right">0.7050</td>
<td align="right">14.7040</td>
</tr>
<tr class="odd">
<td align="left">07B10</td>
<td align="right">7</td>
<td align="left">B</td>
<td align="right">23824</td>
<td align="right">39295.12</td>
<td align="right">10537.833</td>
<td align="left">Cardiovascular</td>
<td align="right">0.6744</td>
<td align="right">14.5401</td>
</tr>
<tr class="even">
<td align="left">10G06</td>
<td align="right">10</td>
<td align="left">G</td>
<td align="right">25357</td>
<td align="right">42600.38</td>
<td align="right">12007.833</td>
<td align="left">Hematology</td>
<td align="right">0.5496</td>
<td align="right">14.6301</td>
</tr>
<tr class="odd">
<td align="left">06H07</td>
<td align="right">6</td>
<td align="left">H</td>
<td align="right">26141</td>
<td align="right">38823.25</td>
<td align="right">10013.833</td>
<td align="left">Infectiology</td>
<td align="right">0.6817</td>
<td align="right">14.6740</td>
</tr>
<tr class="even">
<td align="left">05G08</td>
<td align="right">5</td>
<td align="left">G</td>
<td align="right">28867</td>
<td align="right">39914.62</td>
<td align="right">9950.833</td>
<td align="left">Central Nervous System ’Neuromuscular</td>
<td align="right">0.9224</td>
<td align="right">14.8171</td>
</tr>
<tr class="odd">
<td align="left">07A09</td>
<td align="right">7</td>
<td align="left">A</td>
<td align="right">23381</td>
<td align="right">39295.12</td>
<td align="right">10537.833</td>
<td align="left">Central Nervous System</td>
<td align="right">0.6519</td>
<td align="right">14.5130</td>
</tr>
<tr class="even">
<td align="left">10B11</td>
<td align="right">10</td>
<td align="left">B</td>
<td align="right">24609</td>
<td align="right">42600.38</td>
<td align="right">12007.833</td>
<td align="left">Infectiology</td>
<td align="right">0.5188</td>
<td align="right">14.5869</td>
</tr>
<tr class="odd">
<td align="left">11E11</td>
<td align="right">11</td>
<td align="left">E</td>
<td align="right">46301</td>
<td align="right">39977.00</td>
<td align="right">12715.167</td>
<td align="left">Endocrinology</td>
<td align="right">1.2816</td>
<td align="right">15.4988</td>
</tr>
<tr class="even">
<td align="left">18C04</td>
<td align="right">18</td>
<td align="left">C</td>
<td align="right">41359</td>
<td align="right">39976.62</td>
<td align="right">13087.000</td>
<td align="left">Endocrinology</td>
<td align="right">1.1262</td>
<td align="right">15.3359</td>
</tr>
<tr class="odd">
<td align="left">06E06</td>
<td align="right">6</td>
<td align="left">E</td>
<td align="right">24996</td>
<td align="right">38823.25</td>
<td align="right">10013.833</td>
<td align="left">Neuromuscular</td>
<td align="right">0.6333</td>
<td align="right">14.6094</td>
</tr>
<tr class="even">
<td align="left">04B07</td>
<td align="right">4</td>
<td align="left">B</td>
<td align="right">41994</td>
<td align="right">44212.12</td>
<td align="right">12335.000</td>
<td align="left">Dermatology</td>
<td align="right">1.4837</td>
<td align="right">15.3579</td>
</tr>
<tr class="odd">
<td align="left">11F03</td>
<td align="right">11</td>
<td align="left">F</td>
<td align="right">45815</td>
<td align="right">39977.00</td>
<td align="right">12715.167</td>
<td align="left">Cardiovascular</td>
<td align="right">1.2631</td>
<td align="right">15.4835</td>
</tr>
<tr class="even">
<td align="left">10G10</td>
<td align="right">10</td>
<td align="left">G</td>
<td align="right">24128</td>
<td align="right">42600.38</td>
<td align="right">12007.833</td>
<td align="left">Neuromuscular</td>
<td align="right">0.4990</td>
<td align="right">14.5584</td>
</tr>
<tr class="odd">
<td align="left">08A08</td>
<td align="right">8</td>
<td align="left">A</td>
<td align="right">22905</td>
<td align="right">38082.62</td>
<td align="right">11173.500</td>
<td align="left">Infectiology ’Metabolism</td>
<td align="right">0.5215</td>
<td align="right">14.4834</td>
</tr>
<tr class="even">
<td align="left">05F02</td>
<td align="right">5</td>
<td align="left">F</td>
<td align="right">27115</td>
<td align="right">39914.62</td>
<td align="right">9950.833</td>
<td align="left">Allergology</td>
<td align="right">0.8370</td>
<td align="right">14.7268</td>
</tr>
<tr class="odd">
<td align="left">08C11</td>
<td align="right">8</td>
<td align="left">C</td>
<td align="right">22641</td>
<td align="right">38082.62</td>
<td align="right">11173.500</td>
<td align="left">Dermatology</td>
<td align="right">0.5098</td>
<td align="right">14.4667</td>
</tr>
<tr class="even">
<td align="left">05D10</td>
<td align="right">5</td>
<td align="left">D</td>
<td align="right">27037</td>
<td align="right">39914.62</td>
<td align="right">9950.833</td>
<td align="left">Central Nervous System</td>
<td align="right">0.8332</td>
<td align="right">14.7226</td>
</tr>
<tr class="odd">
<td align="left">04D11</td>
<td align="right">4</td>
<td align="left">D</td>
<td align="right">40541</td>
<td align="right">44212.12</td>
<td align="right">12335.000</td>
<td align="left">Cardiovascular ’Infectiology</td>
<td align="right">1.4110</td>
<td align="right">15.3071</td>
</tr>
<tr class="even">
<td align="left">06C08</td>
<td align="right">6</td>
<td align="left">C</td>
<td align="right">24183</td>
<td align="right">38823.25</td>
<td align="right">10013.833</td>
<td align="left">Central Nervous System</td>
<td align="right">0.5990</td>
<td align="right">14.5617</td>
</tr>
<tr class="odd">
<td align="left">16C10</td>
<td align="right">16</td>
<td align="left">C</td>
<td align="right">45555</td>
<td align="right">34816.88</td>
<td align="right">10077.500</td>
<td align="left">Ophthalmology ’Gastroenterology ’Central Nervous System</td>
<td align="right">2.0989</td>
<td align="right">15.4753</td>
</tr>
<tr class="even">
<td align="left">19E10</td>
<td align="right">19</td>
<td align="left">E</td>
<td align="right">37933</td>
<td align="right">37547.62</td>
<td align="right">10838.667</td>
<td align="left">Cardiovascular</td>
<td align="right">1.2767</td>
<td align="right">15.2112</td>
</tr>
<tr class="odd">
<td align="left">19H04</td>
<td align="right">19</td>
<td align="left">H</td>
<td align="right">37918</td>
<td align="right">37547.62</td>
<td align="right">10838.667</td>
<td align="left">Infectiology</td>
<td align="right">1.2760</td>
<td align="right">15.2106</td>
</tr>
<tr class="even">
<td align="left">12E07</td>
<td align="right">12</td>
<td align="left">E</td>
<td align="right">41624</td>
<td align="right">40366.50</td>
<td align="right">10758.167</td>
<td align="left">Central Nervous System</td>
<td align="right">1.1619</td>
<td align="right">15.3451</td>
</tr>
<tr class="odd">
<td align="left">03H09</td>
<td align="right">3</td>
<td align="left">H</td>
<td align="right">17844</td>
<td align="right">39305.25</td>
<td align="right">10619.000</td>
<td align="left">Infectiology</td>
<td align="right">0.3996</td>
<td align="right">14.1232</td>
</tr>
<tr class="even">
<td align="left">18B12</td>
<td align="right">18</td>
<td align="left">B</td>
<td align="right">39189</td>
<td align="right">39976.62</td>
<td align="right">13087.000</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">15.2582</td>
</tr>
<tr class="odd">
<td align="left">18H11</td>
<td align="right">18</td>
<td align="left">H</td>
<td align="right">39180</td>
<td align="right">39976.62</td>
<td align="right">13087.000</td>
<td align="left">Infectiology</td>
<td align="right">1.0394</td>
<td align="right">15.2578</td>
</tr>
<tr class="even">
<td align="left">05F08</td>
<td align="right">5</td>
<td align="left">F</td>
<td align="right">26431</td>
<td align="right">39914.62</td>
<td align="right">9950.833</td>
<td align="left">Cardiovascular ’Neuromuscular</td>
<td align="right">0.8036</td>
<td align="right">14.6899</td>
</tr>
<tr class="odd">
<td align="left">11E02</td>
<td align="right">11</td>
<td align="left">E</td>
<td align="right">43021</td>
<td align="right">39977.00</td>
<td align="right">12715.167</td>
<td align="left">Central Nervous System</td>
<td align="right">1.1565</td>
<td align="right">15.3928</td>
</tr>
<tr class="even">
<td align="left">19A03</td>
<td align="right">19</td>
<td align="left">A</td>
<td align="right">36884</td>
<td align="right">37547.62</td>
<td align="right">10838.667</td>
<td align="left">Central Nervous System</td>
<td align="right">1.2273</td>
<td align="right">15.1707</td>
</tr>
<tr class="odd">
<td align="left">08B02</td>
<td align="right">8</td>
<td align="left">B</td>
<td align="right">21857</td>
<td align="right">38082.62</td>
<td align="right">11173.500</td>
<td align="left">Neuromuscular</td>
<td align="right">0.4749</td>
<td align="right">14.4158</td>
</tr>
<tr class="even">
<td align="left">02G11</td>
<td align="right">2</td>
<td align="left">G</td>
<td align="right">29796</td>
<td align="right">49597.88</td>
<td align="right">14070.500</td>
<td align="left">Central Nervous System</td>
<td align="right">0.5699</td>
<td align="right">14.8628</td>
</tr>
<tr class="odd">
<td align="left">02F04</td>
<td align="right">2</td>
<td align="left">F</td>
<td align="right">29770</td>
<td align="right">49597.88</td>
<td align="right">14070.500</td>
<td align="left">Allergology ’Central Nervous System</td>
<td align="right">0.5689</td>
<td align="right">14.8616</td>
</tr>
<tr class="even">
<td align="left">17D04</td>
<td align="right">17</td>
<td align="left">D</td>
<td align="right">35715</td>
<td align="right">37294.88</td>
<td align="right">20304.000</td>
<td align="left">Ophthalmology</td>
<td align="right">1.2966</td>
<td align="right">15.1242</td>
</tr>
<tr class="odd">
<td align="left">06G05</td>
<td align="right">6</td>
<td align="left">G</td>
<td align="right">23041</td>
<td align="right">38823.25</td>
<td align="right">10013.833</td>
<td align="left">Central Nervous System</td>
<td align="right">0.5507</td>
<td align="right">14.4919</td>
</tr>
<tr class="even">
<td align="left">03E08</td>
<td align="right">3</td>
<td align="left">E</td>
<td align="right">17478</td>
<td align="right">39305.25</td>
<td align="right">10619.000</td>
<td align="left">Endocrinology</td>
<td align="right">0.3794</td>
<td align="right">14.0933</td>
</tr>
<tr class="odd">
<td align="left">19F05</td>
<td align="right">19</td>
<td align="left">F</td>
<td align="right">35692</td>
<td align="right">37547.62</td>
<td align="right">10838.667</td>
<td align="left">Gastroenterology</td>
<td align="right">1.1711</td>
<td align="right">15.1233</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="comparison-between-viability-scores" class="section level1">
<h1>Comparison between viability scores</h1>
<div id="dot-plots" class="section level2">
<h2>Dot plots</h2>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" data-line-number="1"><span class="co">#### Dot plots to compare viability scores ####</span></a>
<a class="sourceLine" id="cb36-2" data-line-number="2"></a>
<a class="sourceLine" id="cb36-3" data-line-number="3"></a>
<a class="sourceLine" id="cb36-4" data-line-number="4"><span class="co"># names(inhibTable)</span></a>
<a class="sourceLine" id="cb36-5" data-line-number="5"><span class="co"># par(mfrow = c(2,2))</span></a>
<a class="sourceLine" id="cb36-6" data-line-number="6"></a>
<a class="sourceLine" id="cb36-7" data-line-number="7">markColor &lt;-<span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb36-8" data-line-number="8">  <span class="dt">cellCtl =</span> <span class="st">&quot;grey&quot;</span>,</a>
<a class="sourceLine" id="cb36-9" data-line-number="9">  <span class="dt">virusCtl =</span> <span class="st">&quot;red&quot;</span>,</a>
<a class="sourceLine" id="cb36-10" data-line-number="10">  <span class="dt">treated =</span> <span class="st">&quot;blue&quot;</span>,</a>
<a class="sourceLine" id="cb36-11" data-line-number="11">  <span class="dt">Arbidol =</span> <span class="st">&quot;black&quot;</span>,</a>
<a class="sourceLine" id="cb36-12" data-line-number="12">  <span class="dt">Hydroxychloroquite =</span> <span class="st">&quot;orange&quot;</span></a>
<a class="sourceLine" id="cb36-13" data-line-number="13">)</a>
<a class="sourceLine" id="cb36-14" data-line-number="14">markPCh &lt;-<span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb36-15" data-line-number="15">  <span class="dt">cellCtl =</span> <span class="dv">5</span>,</a>
<a class="sourceLine" id="cb36-16" data-line-number="16">  <span class="dt">virusCtl =</span> <span class="dv">17</span>,</a>
<a class="sourceLine" id="cb36-17" data-line-number="17">  <span class="dt">treated =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb36-18" data-line-number="18">  <span class="dt">Arbidol =</span> <span class="dv">19</span>,</a>
<a class="sourceLine" id="cb36-19" data-line-number="19">  <span class="dt">Hydroxychloroquite =</span> <span class="dv">13</span></a>
<a class="sourceLine" id="cb36-20" data-line-number="20">)</a>
<a class="sourceLine" id="cb36-21" data-line-number="21"></a>
<a class="sourceLine" id="cb36-22" data-line-number="22"><span class="co">#### Dot plot: raw versus relative viability ####</span></a>
<a class="sourceLine" id="cb36-23" data-line-number="23"><span class="kw">plot</span>(inhibTable[, <span class="kw">c</span>(<span class="st">&quot;viability&quot;</span>, <span class="st">&quot;Vr&quot;</span>)],</a>
<a class="sourceLine" id="cb36-24" data-line-number="24">     <span class="dt">main =</span> <span class="st">&quot;Relative vs raw viability&quot;</span>,</a>
<a class="sourceLine" id="cb36-25" data-line-number="25">     <span class="dt">xlab =</span> <span class="st">&quot;Raw viability&quot;</span>, </a>
<a class="sourceLine" id="cb36-26" data-line-number="26">     <span class="dt">ylab =</span> <span class="st">&quot;Relative viability (Vr)&quot;</span>, </a>
<a class="sourceLine" id="cb36-27" data-line-number="27">     <span class="dt">col =</span> inhibTable[, <span class="st">&quot;color&quot;</span>],</a>
<a class="sourceLine" id="cb36-28" data-line-number="28">     <span class="dt">pch =</span> inhibTable[, <span class="st">&quot;pch&quot;</span>],</a>
<a class="sourceLine" id="cb36-29" data-line-number="29">     <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="kw">max</span>(inhibTable<span class="op">$</span>viability)<span class="op">*</span><span class="fl">1.1</span>),</a>
<a class="sourceLine" id="cb36-30" data-line-number="30">     <span class="dt">cex =</span> <span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb36-31" data-line-number="31">     <span class="dt">las =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb36-32" data-line-number="32"></a>
<a class="sourceLine" id="cb36-33" data-line-number="33"><span class="co">## Mark cell controls</span></a>
<a class="sourceLine" id="cb36-34" data-line-number="34"><span class="kw">points</span>(inhibTable[wellType <span class="op">==</span><span class="st"> &quot;cellCtl&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;viability&quot;</span>, <span class="st">&quot;Vr&quot;</span>)], </a>
<a class="sourceLine" id="cb36-35" data-line-number="35">       <span class="dt">col =</span> markColor[<span class="st">&quot;cellCtl&quot;</span>], <span class="dt">pch =</span> markPCh[<span class="st">&quot;cellCtl&quot;</span>], <span class="dt">cex =</span> <span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb36-36" data-line-number="36"><span class="co">## Mark virus controls</span></a>
<a class="sourceLine" id="cb36-37" data-line-number="37"><span class="kw">points</span>(inhibTable[wellType <span class="op">==</span><span class="st"> &quot;virusCtl&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;viability&quot;</span>, <span class="st">&quot;Vr&quot;</span>)], </a>
<a class="sourceLine" id="cb36-38" data-line-number="38">       <span class="dt">col =</span> markColor[<span class="st">&quot;virusCtl&quot;</span>], <span class="dt">pch =</span> markPCh[<span class="st">&quot;virusCtl&quot;</span>], <span class="dt">cex =</span> <span class="fl">0.7</span>)</a>
<a class="sourceLine" id="cb36-39" data-line-number="39"><span class="co">## Mark arbidol controls</span></a>
<a class="sourceLine" id="cb36-40" data-line-number="40"><span class="kw">points</span>(inhibTable[arbidolWells, <span class="kw">c</span>(<span class="st">&quot;viability&quot;</span>, <span class="st">&quot;Vr&quot;</span>)], </a>
<a class="sourceLine" id="cb36-41" data-line-number="41">       <span class="dt">col =</span> markColor[<span class="st">&quot;Arbidol&quot;</span>], <span class="dt">pch =</span> markPCh[<span class="st">&quot;Arbidol&quot;</span>], <span class="dt">cex =</span> <span class="fl">0.7</span>)</a>
<a class="sourceLine" id="cb36-42" data-line-number="42"><span class="co">## Mark Hydroxychloroquine</span></a>
<a class="sourceLine" id="cb36-43" data-line-number="43"><span class="kw">points</span>(inhibTable[HOClSindex, <span class="kw">c</span>(<span class="st">&quot;viability&quot;</span>, <span class="st">&quot;Vr&quot;</span>)], </a>
<a class="sourceLine" id="cb36-44" data-line-number="44">       <span class="dt">col =</span> markColor[<span class="st">&quot;Hydroxychloroquine&quot;</span>], <span class="dt">pch =</span> markPCh[<span class="st">&quot;Hydroxychloroquine&quot;</span>], <span class="dt">cex =</span> <span class="fl">0.7</span>)</a>
<a class="sourceLine" id="cb36-45" data-line-number="45"></a>
<a class="sourceLine" id="cb36-46" data-line-number="46"><span class="co">## Grid + specific values for the selected metrics</span></a>
<a class="sourceLine" id="cb36-47" data-line-number="47"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">100</span>, <span class="dt">by =</span> <span class="dv">10</span>), <span class="dt">col =</span> <span class="st">&quot;#DDDDDD&quot;</span>)</a>
<a class="sourceLine" id="cb36-48" data-line-number="48"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb36-49" data-line-number="49"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">100</span>, <span class="dt">col =</span> <span class="st">&quot;#00BB00&quot;</span>)</a>
<a class="sourceLine" id="cb36-50" data-line-number="50"><span class="kw">abline</span>(<span class="dt">v =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="kw">max</span>(inhibTable<span class="op">$</span>viability), <span class="dt">by =</span> <span class="dv">10000</span>), <span class="dt">col =</span> <span class="st">&quot;#DDDDDD&quot;</span>)</a>
<a class="sourceLine" id="cb36-51" data-line-number="51"><span class="kw">abline</span>(<span class="dt">v =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb36-52" data-line-number="52"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">legend =</span> <span class="kw">names</span>(plateColor), </a>
<a class="sourceLine" id="cb36-53" data-line-number="53">       <span class="dt">title =</span> <span class="st">&quot;Plate&quot;</span>, <span class="dt">fill =</span> plateColor, <span class="dt">cex =</span> <span class="fl">0.8</span>)</a></code></pre></div>
<div class="figure" style="text-align: center">
<img src="figures/touret_sars-cov-2_inhibitorscompa_viability_scores_dotplots-1.png" alt="Comparison between viability scores. Diamonds: cell control (uninfected cells). Plain triangles: virus control (untreated infected cells). Black plain circles: arbidol control duplicates per plate. Orange square: Hydroxychloroquine sulfate. " width="100%" />
<p class="caption">
Comparison between viability scores. Diamonds: cell control (uninfected cells). Plain triangles: virus control (untreated infected cells). Black plain circles: arbidol control duplicates per plate. Orange square: Hydroxychloroquine sulfate.
</p>
</div>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1"><span class="co">#### Dot plot: IQR-standardized versus relative viability ####</span></a>
<a class="sourceLine" id="cb37-2" data-line-number="2"><span class="kw">plot</span>(inhibTable[, <span class="kw">c</span>(<span class="st">&quot;Vr&quot;</span>, <span class="st">&quot;iqNormV&quot;</span>)],</a>
<a class="sourceLine" id="cb37-3" data-line-number="3">     <span class="dt">main =</span> <span class="st">&quot;Relative vs IQR-standardized viability&quot;</span>,</a>
<a class="sourceLine" id="cb37-4" data-line-number="4">     <span class="dt">xlab =</span> <span class="st">&quot;Relative viability&quot;</span>,</a>
<a class="sourceLine" id="cb37-5" data-line-number="5">     <span class="dt">ylab =</span> <span class="st">&quot;IQR-standardized viability&quot;</span>,</a>
<a class="sourceLine" id="cb37-6" data-line-number="6">     <span class="dt">col =</span> inhibTable[, <span class="st">&quot;color&quot;</span>],</a>
<a class="sourceLine" id="cb37-7" data-line-number="7">     <span class="dt">pch =</span> inhibTable[, <span class="st">&quot;pch&quot;</span>],</a>
<a class="sourceLine" id="cb37-8" data-line-number="8">     <span class="dt">cex =</span> <span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb37-9" data-line-number="9">     <span class="dt">panel.first =</span> <span class="kw">grid</span>(),</a>
<a class="sourceLine" id="cb37-10" data-line-number="10">     <span class="dt">las =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb37-11" data-line-number="11"></a>
<a class="sourceLine" id="cb37-12" data-line-number="12"><span class="co">## Mark cell controls</span></a>
<a class="sourceLine" id="cb37-13" data-line-number="13"><span class="kw">points</span>(inhibTable[wellType <span class="op">==</span><span class="st"> &quot;cellCtl&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;Vr&quot;</span>, <span class="st">&quot;iqNormV&quot;</span>)], </a>
<a class="sourceLine" id="cb37-14" data-line-number="14">       <span class="dt">col =</span> markColor[<span class="st">&quot;cellCtl&quot;</span>], <span class="dt">pch =</span> markPCh[<span class="st">&quot;cellCtl&quot;</span>], <span class="dt">cex =</span> <span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb37-15" data-line-number="15"><span class="co">## Mark virus controls</span></a>
<a class="sourceLine" id="cb37-16" data-line-number="16"><span class="kw">points</span>(inhibTable[wellType <span class="op">==</span><span class="st"> &quot;virusCtl&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;viability&quot;</span>, <span class="st">&quot;Vr&quot;</span>)], </a>
<a class="sourceLine" id="cb37-17" data-line-number="17">       <span class="dt">col =</span> markColor[<span class="st">&quot;virusCtl&quot;</span>], <span class="dt">pch =</span> markPCh[<span class="st">&quot;virusCtl&quot;</span>], <span class="dt">cex =</span> <span class="fl">0.7</span>)</a>
<a class="sourceLine" id="cb37-18" data-line-number="18"><span class="co">## Mark arbidol controls</span></a>
<a class="sourceLine" id="cb37-19" data-line-number="19"><span class="kw">points</span>(inhibTable[arbidolWells, <span class="kw">c</span>(<span class="st">&quot;viability&quot;</span>, <span class="st">&quot;Vr&quot;</span>)], </a>
<a class="sourceLine" id="cb37-20" data-line-number="20">       <span class="dt">col =</span> markColor[<span class="st">&quot;Arbidol&quot;</span>], <span class="dt">pch =</span> markPCh[<span class="st">&quot;Arbidol&quot;</span>], <span class="dt">cex =</span> <span class="fl">0.7</span>)</a>
<a class="sourceLine" id="cb37-21" data-line-number="21"><span class="co">## Mark Hydroxychloroquine</span></a>
<a class="sourceLine" id="cb37-22" data-line-number="22"><span class="kw">points</span>(inhibTable[HOClSindex, <span class="kw">c</span>(<span class="st">&quot;viability&quot;</span>, <span class="st">&quot;Vr&quot;</span>)], </a>
<a class="sourceLine" id="cb37-23" data-line-number="23">       <span class="dt">col =</span> markColor[<span class="st">&quot;Hydroxychloroquine&quot;</span>], <span class="dt">pch =</span> markPCh[<span class="st">&quot;Hydroxychloroquine&quot;</span>], <span class="dt">cex =</span> <span class="fl">0.7</span>)</a>
<a class="sourceLine" id="cb37-24" data-line-number="24"></a>
<a class="sourceLine" id="cb37-25" data-line-number="25"><span class="co">## Mark milestones for the selected metrics</span></a>
<a class="sourceLine" id="cb37-26" data-line-number="26"><span class="kw">abline</span>(<span class="dt">v =</span> <span class="dv">0</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb37-27" data-line-number="27"><span class="kw">abline</span>(<span class="dt">v =</span> <span class="dv">100</span>, <span class="dt">col =</span> <span class="st">&quot;#00BB00&quot;</span>)</a>
<a class="sourceLine" id="cb37-28" data-line-number="28"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb37-29" data-line-number="29"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">col =</span> <span class="st">&quot;#BBBBBB&quot;</span>)</a>
<a class="sourceLine" id="cb37-30" data-line-number="30"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">legend =</span> <span class="kw">names</span>(plateColor), </a>
<a class="sourceLine" id="cb37-31" data-line-number="31">       <span class="dt">title =</span> <span class="st">&quot;Plate&quot;</span>, <span class="dt">fill =</span> plateColor, <span class="dt">cex =</span> <span class="fl">0.8</span>)</a></code></pre></div>
<div class="figure" style="text-align: center">
<img src="figures/touret_sars-cov-2_inhibitorscompa_viability_scores_dotplots-2.png" alt="Comparison between viability scores. Diamonds: cell control (uninfected cells). Plain triangles: virus control (untreated infected cells). Black plain circles: arbidol control duplicates per plate. Orange square: Hydroxychloroquine sulfate. " width="100%" />
<p class="caption">
Comparison between viability scores. Diamonds: cell control (uninfected cells). Plain triangles: virus control (untreated infected cells). Black plain circles: arbidol control duplicates per plate. Orange square: Hydroxychloroquine sulfate.
</p>
</div>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" data-line-number="1"><span class="co">## Dot plot: FDR versus relative viability</span></a>
<a class="sourceLine" id="cb38-2" data-line-number="2"><span class="kw">plot</span>(<span class="dt">x =</span> inhibTable[, <span class="st">&quot;Vr&quot;</span>],</a>
<a class="sourceLine" id="cb38-3" data-line-number="3">     <span class="dt">y =</span> <span class="op">-</span>inhibTable[, <span class="st">&quot;log10Padj&quot;</span>],</a>
<a class="sourceLine" id="cb38-4" data-line-number="4">     <span class="dt">main =</span> <span class="st">&quot;Relative viability vs FDR from iqrNormV&quot;</span>,</a>
<a class="sourceLine" id="cb38-5" data-line-number="5">     <span class="dt">xlab =</span> <span class="st">&quot;Relative viability&quot;</span>,</a>
<a class="sourceLine" id="cb38-6" data-line-number="6">     <span class="dt">ylab =</span> <span class="st">&quot;-log10(FDR)&quot;</span>,</a>
<a class="sourceLine" id="cb38-7" data-line-number="7">     <span class="dt">col =</span> inhibTable[, <span class="st">&quot;color&quot;</span>],</a>
<a class="sourceLine" id="cb38-8" data-line-number="8">     <span class="dt">pch =</span> inhibTable[, <span class="st">&quot;pch&quot;</span>],</a>
<a class="sourceLine" id="cb38-9" data-line-number="9">     <span class="dt">cex =</span> <span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb38-10" data-line-number="10">     <span class="dt">panel.first =</span> <span class="kw">grid</span>(),</a>
<a class="sourceLine" id="cb38-11" data-line-number="11">     <span class="dt">las =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb38-12" data-line-number="12"><span class="co">## Mark arbidol controls</span></a>
<a class="sourceLine" id="cb38-13" data-line-number="13"><span class="kw">points</span>(<span class="dt">x =</span> inhibTable[arbidolWells, <span class="st">&quot;Vr&quot;</span>],</a>
<a class="sourceLine" id="cb38-14" data-line-number="14">       <span class="dt">y =</span> <span class="op">-</span>inhibTable[arbidolWells, <span class="st">&quot;log10Padj&quot;</span>], </a>
<a class="sourceLine" id="cb38-15" data-line-number="15">       <span class="dt">col =</span> markColor[<span class="st">&quot;Arbidol&quot;</span>], <span class="dt">pch =</span> markPCh[<span class="st">&quot;Arbidol&quot;</span>], <span class="dt">cex =</span> <span class="fl">0.7</span>)</a>
<a class="sourceLine" id="cb38-16" data-line-number="16"><span class="co">## Grid + specific values for the selected metrics</span></a>
<a class="sourceLine" id="cb38-17" data-line-number="17"><span class="kw">abline</span>(<span class="dt">v =</span> <span class="dv">0</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb38-18" data-line-number="18"><span class="kw">abline</span>(<span class="dt">v =</span> <span class="dv">100</span>, <span class="dt">col =</span> <span class="st">&quot;#00BB00&quot;</span>)</a>
<a class="sourceLine" id="cb38-19" data-line-number="19"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb38-20" data-line-number="20"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">col =</span> <span class="st">&quot;#BBBBBB&quot;</span>)</a>
<a class="sourceLine" id="cb38-21" data-line-number="21"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">legend =</span> <span class="kw">names</span>(plateColor), </a>
<a class="sourceLine" id="cb38-22" data-line-number="22">       <span class="dt">title =</span> <span class="st">&quot;Plate&quot;</span>, <span class="dt">fill =</span> plateColor, <span class="dt">cex =</span> <span class="fl">0.8</span>)</a></code></pre></div>
<div class="figure" style="text-align: center">
<img src="figures/touret_sars-cov-2_inhibitorscompa_viability_scores_dotplots-3.png" alt="Comparison between viability scores. Diamonds: cell control (uninfected cells). Plain triangles: virus control (untreated infected cells). Black plain circles: arbidol control duplicates per plate. Orange square: Hydroxychloroquine sulfate. " width="100%" />
<p class="caption">
Comparison between viability scores. Diamonds: cell control (uninfected cells). Plain triangles: virus control (untreated infected cells). Black plain circles: arbidol control duplicates per plate. Orange square: Hydroxychloroquine sulfate.
</p>
</div>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1"><span class="co">#### Dot plot: inhibition index versus relative viability ####</span></a>
<a class="sourceLine" id="cb39-2" data-line-number="2"><span class="kw">plot</span>(<span class="dt">x =</span> inhibTable[, <span class="st">&quot;Vr&quot;</span>],</a>
<a class="sourceLine" id="cb39-3" data-line-number="3">     <span class="dt">y =</span> <span class="op">-</span>inhibTable[, <span class="st">&quot;Inhibition.Index&quot;</span>],</a>
<a class="sourceLine" id="cb39-4" data-line-number="4">     <span class="dt">main =</span> <span class="st">&quot;Relative viability vs FDR from iqrNormV&quot;</span>,</a>
<a class="sourceLine" id="cb39-5" data-line-number="5">     <span class="dt">xlab =</span> <span class="st">&quot;Relative viability&quot;</span>,</a>
<a class="sourceLine" id="cb39-6" data-line-number="6">     <span class="dt">ylab =</span> <span class="st">&quot;-log10(FDR)&quot;</span>,</a>
<a class="sourceLine" id="cb39-7" data-line-number="7">     <span class="dt">col =</span> inhibTable[, <span class="st">&quot;color&quot;</span>],</a>
<a class="sourceLine" id="cb39-8" data-line-number="8">     <span class="dt">pch =</span> inhibTable[, <span class="st">&quot;pch&quot;</span>],</a>
<a class="sourceLine" id="cb39-9" data-line-number="9">     <span class="dt">cex =</span> <span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb39-10" data-line-number="10">     <span class="dt">panel.first =</span> <span class="kw">grid</span>(),</a>
<a class="sourceLine" id="cb39-11" data-line-number="11">     <span class="dt">las =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb39-12" data-line-number="12"><span class="co">## Mark arbidol controls</span></a>
<a class="sourceLine" id="cb39-13" data-line-number="13"><span class="kw">points</span>(<span class="dt">x =</span> inhibTable[arbidolWells, <span class="st">&quot;Vr&quot;</span>],</a>
<a class="sourceLine" id="cb39-14" data-line-number="14">       <span class="dt">y =</span> <span class="op">-</span>inhibTable[arbidolWells, <span class="st">&quot;Inhibition.Index&quot;</span>], </a>
<a class="sourceLine" id="cb39-15" data-line-number="15">       <span class="dt">col =</span> markColor[<span class="st">&quot;Arbidol&quot;</span>], <span class="dt">pch =</span> markPCh[<span class="st">&quot;Arbidol&quot;</span>], <span class="dt">cex =</span> <span class="fl">0.7</span>)</a>
<a class="sourceLine" id="cb39-16" data-line-number="16"><span class="co">## Grid + specific values for the selected metrics</span></a>
<a class="sourceLine" id="cb39-17" data-line-number="17"><span class="kw">abline</span>(<span class="dt">v =</span> <span class="dv">0</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb39-18" data-line-number="18"><span class="kw">abline</span>(<span class="dt">v =</span> <span class="dv">100</span>, <span class="dt">col =</span> <span class="st">&quot;#00BB00&quot;</span>)</a>
<a class="sourceLine" id="cb39-19" data-line-number="19"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb39-20" data-line-number="20"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">col =</span> <span class="st">&quot;#BBBBBB&quot;</span>)</a>
<a class="sourceLine" id="cb39-21" data-line-number="21"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">legend =</span> <span class="kw">names</span>(plateColor), </a>
<a class="sourceLine" id="cb39-22" data-line-number="22">       <span class="dt">title =</span> <span class="st">&quot;Plate&quot;</span>, <span class="dt">fill =</span> plateColor, <span class="dt">cex =</span> <span class="fl">0.8</span>)</a></code></pre></div>
<div class="figure" style="text-align: center">
<img src="figures/touret_sars-cov-2_inhibitorscompa_viability_scores_dotplots-4.png" alt="Comparison between viability scores. Diamonds: cell control (uninfected cells). Plain triangles: virus control (untreated infected cells). Black plain circles: arbidol control duplicates per plate. Orange square: Hydroxychloroquine sulfate. " width="100%" />
<p class="caption">
Comparison between viability scores. Diamonds: cell control (uninfected cells). Plain triangles: virus control (untreated infected cells). Black plain circles: arbidol control duplicates per plate. Orange square: Hydroxychloroquine sulfate.
</p>
</div>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" data-line-number="1"><span class="kw">par</span>(par.ori)</a></code></pre></div>
</div>
<div id="selected-candidate-molecules" class="section level2">
<h2>Selected candidate molecules</h2>
</div>
<div id="result-tables" class="section level2">
<h2>Result tables</h2>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" data-line-number="1">outFiles &lt;-<span class="st"> </span><span class="kw">list</span>(</a>
<a class="sourceLine" id="cb41-2" data-line-number="2">  <span class="st">&quot;All results (tsv)&quot;</span> =<span class="st">  </span><span class="kw">file.path</span>(dir[<span class="st">&quot;results&quot;</span>], <span class="st">&quot;result_table_all-molecules.tsv&quot;</span>),</a>
<a class="sourceLine" id="cb41-3" data-line-number="3">  <span class="st">&quot;All results (xlsx)&quot;</span> =<span class="st">  </span><span class="kw">file.path</span>(dir[<span class="st">&quot;results&quot;</span>], <span class="st">&quot;result_table_all-molecules.xlsx&quot;</span>)</a>
<a class="sourceLine" id="cb41-4" data-line-number="4">)</a>
<a class="sourceLine" id="cb41-5" data-line-number="5"></a>
<a class="sourceLine" id="cb41-6" data-line-number="6"><span class="kw">write.table</span>(<span class="dt">x =</span> inhibTable, <span class="dt">file =</span> outFiles<span class="op">$</span><span class="st">`</span><span class="dt">All results (tsv)</span><span class="st">`</span>,  </a>
<a class="sourceLine" id="cb41-7" data-line-number="7">            <span class="dt">sep =</span> <span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>, <span class="dt">quote =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb41-8" data-line-number="8">            <span class="dt">row.names =</span> <span class="ot">FALSE</span>, <span class="dt">col.names =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb41-9" data-line-number="9"></a>
<a class="sourceLine" id="cb41-10" data-line-number="10"><span class="kw">write.xlsx2</span>(<span class="dt">x =</span> inhibTable, <span class="dt">file =</span> outFiles<span class="op">$</span><span class="st">`</span><span class="dt">All results (xlsx)</span><span class="st">`</span>, </a>
<a class="sourceLine" id="cb41-11" data-line-number="11">            <span class="dt">row.names =</span> <span class="ot">FALSE</span>, <span class="dt">col.names =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb41-12" data-line-number="12"></a>
<a class="sourceLine" id="cb41-13" data-line-number="13"><span class="kw">system</span>(<span class="kw">paste</span>(<span class="st">&quot;open&quot;</span>, dir[<span class="st">&quot;results&quot;</span>]))</a></code></pre></div>
<hr />
</div>
</div>
<div id="analysis-of-tourets-original-inhibition-index-ii" class="section level1">
<h1>Analysis of Touret’s original Inhibition Index (II)</h1>
<div id="inhibition-index" class="section level2">
<h2>Inhibition index</h2>
<p>The inhibition index is derived from the raw viability measurement in the following way.</p>
<div id="descriptive-stats" class="section level3">
<h3>Descriptive stats</h3>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" data-line-number="1">ii &lt;-<span class="st"> </span>supTable<span class="op">$</span>Inhibition.Index</a>
<a class="sourceLine" id="cb42-2" data-line-number="2">iiStat &lt;-<span class="st"> </span><span class="kw">list</span>(</a>
<a class="sourceLine" id="cb42-3" data-line-number="3">  <span class="dt">mean =</span> <span class="kw">mean</span>(ii),</a>
<a class="sourceLine" id="cb42-4" data-line-number="4">  <span class="dt">sd =</span> <span class="kw">sd</span>(ii),</a>
<a class="sourceLine" id="cb42-5" data-line-number="5">  <span class="dt">var =</span> <span class="kw">var</span>(ii),</a>
<a class="sourceLine" id="cb42-6" data-line-number="6">  <span class="dt">min =</span> <span class="kw">min</span>(ii),</a>
<a class="sourceLine" id="cb42-7" data-line-number="7">  <span class="dt">Q1 =</span> <span class="kw">as.vector</span>(<span class="kw">quantile</span>(ii, <span class="dt">probs =</span> <span class="fl">0.25</span>)),</a>
<a class="sourceLine" id="cb42-8" data-line-number="8">  <span class="dt">median =</span> <span class="kw">median</span>(ii),</a>
<a class="sourceLine" id="cb42-9" data-line-number="9">  <span class="dt">Q3 =</span> <span class="kw">as.vector</span>(<span class="kw">quantile</span>(ii, <span class="dt">probs =</span> <span class="fl">0.75</span>)),</a>
<a class="sourceLine" id="cb42-10" data-line-number="10">  <span class="dt">max =</span> <span class="kw">max</span>(ii)</a>
<a class="sourceLine" id="cb42-11" data-line-number="11">)</a>
<a class="sourceLine" id="cb42-12" data-line-number="12"></a>
<a class="sourceLine" id="cb42-13" data-line-number="13"><span class="kw">kable</span>(<span class="kw">t</span>(<span class="kw">as.data.frame.list</span>(iiStat)), <span class="dt">col.names =</span> <span class="st">&quot;Stat&quot;</span>)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">Stat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>mean</td>
<td align="right">0.2865268</td>
</tr>
<tr class="even">
<td>sd</td>
<td align="right">0.3758726</td>
</tr>
<tr class="odd">
<td>var</td>
<td align="right">0.1412802</td>
</tr>
<tr class="even">
<td>min</td>
<td align="right">-0.4444311</td>
</tr>
<tr class="odd">
<td>Q1</td>
<td align="right">0.0279599</td>
</tr>
<tr class="even">
<td>median</td>
<td align="right">0.1665643</td>
</tr>
<tr class="odd">
<td>Q3</td>
<td align="right">0.4917926</td>
</tr>
<tr class="even">
<td>max</td>
<td align="right">2.0988878</td>
</tr>
</tbody>
</table>
</div>
<div id="distribution" class="section level3">
<h3>Distribution</h3>
<p>The distribution of inhibition index values is trongly asymmetrical. The mode is much lower than the mean and the median (robust estimator of central tendency). A normal fit will tuhs give a poor estimate of the p-values.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" data-line-number="1"><span class="kw">hist</span>(supTable<span class="op">$</span>Inhibition.Index, <span class="dt">breaks =</span> <span class="dv">100</span>, <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">border =</span> <span class="st">&quot;grey&quot;</span>)</a>
<a class="sourceLine" id="cb43-2" data-line-number="2"><span class="kw">abline</span>(<span class="dt">v =</span> iiStat<span class="op">$</span>mean, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</a>
<a class="sourceLine" id="cb43-3" data-line-number="3"><span class="kw">abline</span>(<span class="dt">v =</span> iiStat<span class="op">$</span>median, <span class="dt">col =</span> <span class="st">&quot;darkgreen&quot;</span>)</a>
<a class="sourceLine" id="cb43-4" data-line-number="4"></a>
<a class="sourceLine" id="cb43-5" data-line-number="5"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;mean&quot;</span>, <span class="st">&quot;median&quot;</span>),</a>
<a class="sourceLine" id="cb43-6" data-line-number="6">       <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;darkgreen&quot;</span>),</a>
<a class="sourceLine" id="cb43-7" data-line-number="7">       <span class="dt">lwd =</span> <span class="dv">2</span>)</a></code></pre></div>
<div class="figure" style="text-align: center">
<img src="figures/touret_sars-cov-2_inhibitorsinhib_index_distribution-1.png" alt="Distribution of the inhibition index" width="60%" />
<p class="caption">
Distribution of the inhibition index
</p>
</div>
</div>
</div>
<div id="normalization" class="section level2">
<h2>Normalization</h2>
<div id="log-transform" class="section level3">
<h3>Log transform</h3>
<p>A classical method for normalization is to take the log of the values. We first had to shift the data in order for all of them to take positive values.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" data-line-number="1"><span class="co"># fit.gamma &lt;- fitdist(data = ii - iiStat$min + 1, distr = &quot;gamma&quot;, method = &quot;mge&quot;)</span></a>
<a class="sourceLine" id="cb44-2" data-line-number="2"><span class="co"># summary(fit.gamma)</span></a>
<a class="sourceLine" id="cb44-3" data-line-number="3"><span class="co"># </span></a>
<a class="sourceLine" id="cb44-4" data-line-number="4"><span class="co"># plot(fit.gamma)</span></a>
<a class="sourceLine" id="cb44-5" data-line-number="5"></a>
<a class="sourceLine" id="cb44-6" data-line-number="6"><span class="co">#### Compute a normalized distribution from inhibition indices ####</span></a>
<a class="sourceLine" id="cb44-7" data-line-number="7">iiPositive &lt;-<span class="st"> </span>ii <span class="op">-</span><span class="st"> </span>iiStat<span class="op">$</span>min <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="co">## shift the distrib to achieve non-negative numbers</span></a>
<a class="sourceLine" id="cb44-8" data-line-number="8">logII &lt;-<span class="st"> </span><span class="kw">log</span>(iiPositive)</a>
<a class="sourceLine" id="cb44-9" data-line-number="9"></a>
<a class="sourceLine" id="cb44-10" data-line-number="10">logIIStat &lt;-<span class="st"> </span><span class="kw">list</span>(</a>
<a class="sourceLine" id="cb44-11" data-line-number="11">  <span class="dt">mean =</span> <span class="kw">mean</span>(logII),</a>
<a class="sourceLine" id="cb44-12" data-line-number="12">  <span class="dt">sd =</span> <span class="kw">sd</span>(logII),</a>
<a class="sourceLine" id="cb44-13" data-line-number="13">  <span class="dt">var =</span> <span class="kw">var</span>(logII),</a>
<a class="sourceLine" id="cb44-14" data-line-number="14">  <span class="dt">min =</span> <span class="kw">min</span>(logII),</a>
<a class="sourceLine" id="cb44-15" data-line-number="15">  <span class="dt">Q1 =</span> <span class="kw">as.vector</span>(<span class="kw">quantile</span>(logII, <span class="dt">probs =</span> <span class="fl">0.25</span>)),</a>
<a class="sourceLine" id="cb44-16" data-line-number="16">  <span class="dt">median =</span> <span class="kw">median</span>(logII),</a>
<a class="sourceLine" id="cb44-17" data-line-number="17">  <span class="dt">Q3 =</span> <span class="kw">as.vector</span>(<span class="kw">quantile</span>(logII, <span class="dt">probs =</span> <span class="fl">0.75</span>)),</a>
<a class="sourceLine" id="cb44-18" data-line-number="18">  <span class="dt">max =</span> <span class="kw">max</span>(logII)</a>
<a class="sourceLine" id="cb44-19" data-line-number="19">)</a>
<a class="sourceLine" id="cb44-20" data-line-number="20"></a>
<a class="sourceLine" id="cb44-21" data-line-number="21"><span class="kw">kable</span>(<span class="kw">t</span>(<span class="kw">as.data.frame.list</span>(logIIStat)), <span class="dt">col.names =</span> <span class="st">&quot;Stat&quot;</span>, <span class="dt">caption =</span> <span class="st">&quot;Parameters of the log-normalized inhibition index distribution&quot;</span>)</a></code></pre></div>
<table>
<caption>Parameters of the log-normalized inhibition index distribution</caption>
<thead>
<tr class="header">
<th></th>
<th align="right">Stat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>mean</td>
<td align="right">0.5272798</td>
</tr>
<tr class="even">
<td>sd</td>
<td align="right">0.2027703</td>
</tr>
<tr class="odd">
<td>var</td>
<td align="right">0.0411158</td>
</tr>
<tr class="even">
<td>min</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td>Q1</td>
<td align="right">0.3868877</td>
</tr>
<tr class="even">
<td>median</td>
<td align="right">0.4768523</td>
</tr>
<tr class="odd">
<td>Q3</td>
<td align="right">0.6607395</td>
</tr>
<tr class="even">
<td>max</td>
<td align="right">1.2650638</td>
</tr>
</tbody>
</table>
<p>However, even after log transformation the distribution remains highly asymmetrical, with a mode much smaller than the median and mean.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" data-line-number="1"><span class="co">#### Histogram of log-normalized values ####</span></a>
<a class="sourceLine" id="cb45-2" data-line-number="2"><span class="kw">hist</span>(logII, <span class="dt">breaks =</span> <span class="dv">100</span>, <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">border =</span> <span class="st">&quot;grey&quot;</span>)</a>
<a class="sourceLine" id="cb45-3" data-line-number="3"><span class="kw">abline</span>(<span class="dt">v =</span> <span class="kw">mean</span>(logII), <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</a>
<a class="sourceLine" id="cb45-4" data-line-number="4"><span class="kw">abline</span>(<span class="dt">v =</span> <span class="kw">median</span>(logII), <span class="dt">col =</span> <span class="st">&quot;darkgreen&quot;</span>)</a>
<a class="sourceLine" id="cb45-5" data-line-number="5"></a>
<a class="sourceLine" id="cb45-6" data-line-number="6"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;mean&quot;</span>, <span class="st">&quot;median&quot;</span>),</a>
<a class="sourceLine" id="cb45-7" data-line-number="7">       <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;darkgreen&quot;</span>),</a>
<a class="sourceLine" id="cb45-8" data-line-number="8">       <span class="dt">lwd =</span> <span class="dv">2</span>)</a></code></pre></div>
<div class="figure" style="text-align: center">
<img src="figures/touret_sars-cov-2_inhibitorslogII_distrib-1.png" alt="Distribution of the inhibition index" width="60%" />
<p class="caption">
Distribution of the inhibition index
</p>
</div>
</div>
</div>
<div id="evidence-of-a-plate-bias" class="section level2">
<h2>Evidence of a plate bias</h2>
<div id="ranked-values" class="section level3">
<h3>Ranked values</h3>
<p>We plot the inhibition index values ordered by plate and position number (top) or ranked by decreasing value (bottom). In both cases, the color denotes the plate number.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" data-line-number="1"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb46-2" data-line-number="2"><span class="kw">plot</span>(ii,</a>
<a class="sourceLine" id="cb46-3" data-line-number="3">     <span class="dt">panel.first =</span> <span class="kw">grid</span>(),</a>
<a class="sourceLine" id="cb46-4" data-line-number="4">     <span class="dt">main =</span> <span class="st">&quot;Inhibition index values&quot;</span>,</a>
<a class="sourceLine" id="cb46-5" data-line-number="5">     <span class="dt">xlab =</span> <span class="st">&quot;Molecules (ranked by inhibition index)&quot;</span>,</a>
<a class="sourceLine" id="cb46-6" data-line-number="6">     <span class="dt">ylab =</span> <span class="st">&quot;Inhibition index&quot;</span>,</a>
<a class="sourceLine" id="cb46-7" data-line-number="7">     <span class="dt">col =</span> supTable<span class="op">$</span>color,</a>
<a class="sourceLine" id="cb46-8" data-line-number="8">     <span class="dt">cex =</span> <span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb46-9" data-line-number="9">     <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="kw">length</span>(ii)<span class="op">*</span><span class="fl">1.05</span>)</a>
<a class="sourceLine" id="cb46-10" data-line-number="10">     )</a>
<a class="sourceLine" id="cb46-11" data-line-number="11"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, </a>
<a class="sourceLine" id="cb46-12" data-line-number="12">       <span class="dt">legend =</span> <span class="kw">names</span>(plateColor), </a>
<a class="sourceLine" id="cb46-13" data-line-number="13">       <span class="dt">col =</span> plateColor, <span class="dt">pch =</span> <span class="dv">1</span>, </a>
<a class="sourceLine" id="cb46-14" data-line-number="14">       <span class="dt">cex =</span> <span class="fl">0.7</span>)</a>
<a class="sourceLine" id="cb46-15" data-line-number="15"></a>
<a class="sourceLine" id="cb46-16" data-line-number="16">sortedTable &lt;-<span class="st"> </span>supTable[<span class="kw">order</span>(supTable<span class="op">$</span>Inhibition.Index, <span class="dt">decreasing =</span> <span class="ot">TRUE</span>), ]</a>
<a class="sourceLine" id="cb46-17" data-line-number="17"><span class="kw">plot</span>(sortedTable<span class="op">$</span>Inhibition.Index,</a>
<a class="sourceLine" id="cb46-18" data-line-number="18">     <span class="dt">panel.first =</span> <span class="kw">grid</span>(),</a>
<a class="sourceLine" id="cb46-19" data-line-number="19">     <span class="dt">main =</span> <span class="st">&quot;Ranked inhibition index values&quot;</span>,</a>
<a class="sourceLine" id="cb46-20" data-line-number="20">     <span class="dt">xlab =</span> <span class="st">&quot;Molecules (ranked by inhibition index)&quot;</span>,</a>
<a class="sourceLine" id="cb46-21" data-line-number="21">     <span class="dt">ylab =</span> <span class="st">&quot;Inhibition index&quot;</span>,</a>
<a class="sourceLine" id="cb46-22" data-line-number="22">     <span class="dt">col =</span> sortedTable<span class="op">$</span>color,</a>
<a class="sourceLine" id="cb46-23" data-line-number="23">     <span class="dt">cex =</span> <span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb46-24" data-line-number="24">     <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="kw">length</span>(ii)<span class="op">*</span><span class="fl">1.05</span>)</a>
<a class="sourceLine" id="cb46-25" data-line-number="25">     )</a>
<a class="sourceLine" id="cb46-26" data-line-number="26"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, </a>
<a class="sourceLine" id="cb46-27" data-line-number="27">       <span class="dt">legend =</span> <span class="kw">names</span>(plateColor), </a>
<a class="sourceLine" id="cb46-28" data-line-number="28">       <span class="dt">col =</span> plateColor, <span class="dt">pch =</span> <span class="dv">1</span>, </a>
<a class="sourceLine" id="cb46-29" data-line-number="29">       <span class="dt">cex =</span> <span class="fl">0.7</span>)</a></code></pre></div>
<div class="figure" style="text-align: center">
<img src="figures/touret_sars-cov-2_inhibitorsinhib_index_ranked-1.png" alt="Values of the inhibition index for all the tested molecules. Molecules are colored according to the plate number. " width="60%" />
<p class="caption">
Values of the inhibition index for all the tested molecules. Molecules are colored according to the plate number.
</p>
</div>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" data-line-number="1"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</a></code></pre></div>
<p>The molecule-wised colored plots of inhibition index suggest a plate-wise effect.</p>
</div>
</div>
<div id="plate-wise-normalization" class="section level2">
<h2>Plate-wise normalization</h2>
<p>We perform a plate-wise normalization using robust estimators, in order to avoid the effect of outliers (in this case, the suspected outliers are the molecules having an actual inhibitory effect).</p>
<p>To this purpose, we use: - plate-wise median to estimate the mean - plate-wise standardized inter-quantile range (IQR) to estimate the standard deviation</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" data-line-number="1"><span class="co">#### Copute plate-wise statistics ####</span></a>
<a class="sourceLine" id="cb48-2" data-line-number="2">plateStat &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb48-3" data-line-number="3">  <span class="dt">plate =</span> plateNumbers,</a>
<a class="sourceLine" id="cb48-4" data-line-number="4">  <span class="dt">mean =</span> <span class="kw">as.vector</span>(<span class="kw">by</span>(<span class="dt">data =</span> supTable<span class="op">$</span>Inhibition.Index, <span class="dt">INDICES =</span> supTable<span class="op">$</span>plateNumber, <span class="dt">FUN =</span> mean)),</a>
<a class="sourceLine" id="cb48-5" data-line-number="5">  <span class="dt">sd =</span> <span class="kw">as.vector</span>(<span class="kw">by</span>(<span class="dt">data =</span> supTable<span class="op">$</span>Inhibition.Index, <span class="dt">INDICES =</span> supTable<span class="op">$</span>plateNumber, <span class="dt">FUN =</span> sd)),</a>
<a class="sourceLine" id="cb48-6" data-line-number="6">  <span class="dt">median =</span> <span class="kw">as.vector</span>(<span class="kw">by</span>(<span class="dt">data =</span> supTable<span class="op">$</span>Inhibition.Index, <span class="dt">INDICES =</span> supTable<span class="op">$</span>plateNumber, <span class="dt">FUN =</span> median)),</a>
<a class="sourceLine" id="cb48-7" data-line-number="7">  <span class="dt">min =</span> <span class="kw">as.vector</span>(<span class="kw">by</span>(<span class="dt">data =</span> supTable<span class="op">$</span>Inhibition.Index, <span class="dt">INDICES =</span> supTable<span class="op">$</span>plateNumber, <span class="dt">FUN =</span> min)),</a>
<a class="sourceLine" id="cb48-8" data-line-number="8">  <span class="dt">max =</span> <span class="kw">as.vector</span>(<span class="kw">by</span>(<span class="dt">data =</span> supTable<span class="op">$</span>Inhibition.Index, <span class="dt">INDICES =</span> supTable<span class="op">$</span>plateNumber, <span class="dt">FUN =</span> max)),</a>
<a class="sourceLine" id="cb48-9" data-line-number="9">  <span class="dt">IQR =</span> <span class="kw">as.vector</span>(<span class="kw">by</span>(<span class="dt">data =</span> supTable<span class="op">$</span>Inhibition.Index, <span class="dt">INDICES =</span> supTable<span class="op">$</span>plateNumber, <span class="dt">FUN =</span> IQR))</a>
<a class="sourceLine" id="cb48-10" data-line-number="10">)</a>
<a class="sourceLine" id="cb48-11" data-line-number="11"><span class="kw">rownames</span>(plateStat) &lt;-<span class="st"> </span>plateStat<span class="op">$</span>plate</a>
<a class="sourceLine" id="cb48-12" data-line-number="12"></a>
<a class="sourceLine" id="cb48-13" data-line-number="13"><span class="kw">kable</span>(plateStat, <span class="dt">caption =</span> <span class="st">&quot;Plate-wise statistics&quot;</span>)</a></code></pre></div>
<table>
<caption>Plate-wise statistics</caption>
<thead>
<tr class="header">
<th align="right">plate</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">median</th>
<th align="right">min</th>
<th align="right">max</th>
<th align="right">IQR</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">0.1165661</td>
<td align="right">0.2665169</td>
<td align="right">0.0184570</td>
<td align="right">-0.1318422</td>
<td align="right">1.1928831</td>
<td align="right">0.0914910</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">0.1541782</td>
<td align="right">0.2523084</td>
<td align="right">0.1133156</td>
<td align="right">-0.1450055</td>
<td align="right">0.9498831</td>
<td align="right">0.2156783</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">0.1443563</td>
<td align="right">0.1960778</td>
<td align="right">0.0863385</td>
<td align="right">-0.1387721</td>
<td align="right">1.0073009</td>
<td align="right">0.1349143</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">0.2982710</td>
<td align="right">0.4307195</td>
<td align="right">0.1601301</td>
<td align="right">-0.1844422</td>
<td align="right">1.4836918</td>
<td align="right">0.4739120</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">0.2345274</td>
<td align="right">0.3194481</td>
<td align="right">0.1628049</td>
<td align="right">-0.1383338</td>
<td align="right">1.4421869</td>
<td align="right">0.2814504</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">0.1393632</td>
<td align="right">0.2580634</td>
<td align="right">0.0412022</td>
<td align="right">-0.1109600</td>
<td align="right">1.0748024</td>
<td align="right">0.2271337</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="right">0.2241196</td>
<td align="right">0.3673457</td>
<td align="right">0.0873107</td>
<td align="right">-0.1267828</td>
<td align="right">1.6589036</td>
<td align="right">0.2073556</td>
</tr>
<tr class="even">
<td align="right">8</td>
<td align="right">0.1439492</td>
<td align="right">0.2894590</td>
<td align="right">0.0331407</td>
<td align="right">-0.1396088</td>
<td align="right">1.4326962</td>
<td align="right">0.1976995</td>
</tr>
<tr class="odd">
<td align="right">9</td>
<td align="right">0.1253725</td>
<td align="right">0.2449408</td>
<td align="right">0.0420476</td>
<td align="right">-0.1543792</td>
<td align="right">1.1609812</td>
<td align="right">0.1107754</td>
</tr>
<tr class="even">
<td align="right">10</td>
<td align="right">0.1541551</td>
<td align="right">0.2335481</td>
<td align="right">0.0948601</td>
<td align="right">-0.1365916</td>
<td align="right">1.1209955</td>
<td align="right">0.1617424</td>
</tr>
<tr class="odd">
<td align="right">11</td>
<td align="right">0.3071834</td>
<td align="right">0.3265338</td>
<td align="right">0.2478965</td>
<td align="right">-0.2846758</td>
<td align="right">1.2816167</td>
<td align="right">0.4140013</td>
</tr>
<tr class="even">
<td align="right">12</td>
<td align="right">0.3499997</td>
<td align="right">0.2757037</td>
<td align="right">0.3159377</td>
<td align="right">-0.2074233</td>
<td align="right">1.1619058</td>
<td align="right">0.3761552</td>
</tr>
<tr class="odd">
<td align="right">13</td>
<td align="right">0.4314013</td>
<td align="right">0.4397504</td>
<td align="right">0.4146992</td>
<td align="right">-0.3511397</td>
<td align="right">1.3851376</td>
<td align="right">0.5813343</td>
</tr>
<tr class="even">
<td align="right">14</td>
<td align="right">0.5857602</td>
<td align="right">0.4775020</td>
<td align="right">0.6038263</td>
<td align="right">-0.4444311</td>
<td align="right">1.6653052</td>
<td align="right">0.5380693</td>
</tr>
<tr class="odd">
<td align="right">15</td>
<td align="right">0.5187760</td>
<td align="right">0.4972562</td>
<td align="right">0.4842358</td>
<td align="right">-0.4279441</td>
<td align="right">1.6531873</td>
<td align="right">0.8015369</td>
</tr>
<tr class="even">
<td align="right">16</td>
<td align="right">0.5253860</td>
<td align="right">0.4768292</td>
<td align="right">0.5615571</td>
<td align="right">-0.3309767</td>
<td align="right">2.0988878</td>
<td align="right">0.6858842</td>
</tr>
<tr class="odd">
<td align="right">17</td>
<td align="right">0.3590275</td>
<td align="right">0.3386716</td>
<td align="right">0.3050932</td>
<td align="right">-0.2784932</td>
<td align="right">1.2965981</td>
<td align="right">0.4539432</td>
</tr>
<tr class="even">
<td align="right">18</td>
<td align="right">0.2912052</td>
<td align="right">0.3201378</td>
<td align="right">0.2263674</td>
<td align="right">-0.3152611</td>
<td align="right">1.2542724</td>
<td align="right">0.3426682</td>
</tr>
<tr class="odd">
<td align="right">19</td>
<td align="right">0.3404116</td>
<td align="right">0.4026624</td>
<td align="right">0.1982078</td>
<td align="right">-0.2950106</td>
<td align="right">1.5490336</td>
<td align="right">0.4724498</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" data-line-number="1"><span class="co">## Centering: substract the median</span></a>
<a class="sourceLine" id="cb49-2" data-line-number="2"><span class="co">## Scaling: divide by IQR</span></a>
<a class="sourceLine" id="cb49-3" data-line-number="3"><span class="co">## Standardize: multiply by IQR of the normal distribution</span></a>
<a class="sourceLine" id="cb49-4" data-line-number="4">normII &lt;-<span class="st"> </span>(supTable<span class="op">$</span>Inhibition.Index <span class="op">-</span><span class="st"> </span>plateStat[supTable<span class="op">$</span>plateNumber, <span class="st">&quot;median&quot;</span>]) <span class="op">/</span><span class="st"> </span>plateStat[supTable<span class="op">$</span>plateNumber, <span class="st">&quot;IQR&quot;</span>]</a>
<a class="sourceLine" id="cb49-5" data-line-number="5"><span class="co"># IQR(normII)</span></a>
<a class="sourceLine" id="cb49-6" data-line-number="6"><span class="co"># IQR(rnorm(n = 1000000))</span></a>
<a class="sourceLine" id="cb49-7" data-line-number="7"></a>
<a class="sourceLine" id="cb49-8" data-line-number="8">normIQR &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="dt">p =</span> <span class="fl">0.75</span>) <span class="op">-</span><span class="st"> </span><span class="kw">qnorm</span>(<span class="dt">p =</span> <span class="fl">0.25</span>)</a>
<a class="sourceLine" id="cb49-9" data-line-number="9">normII &lt;-<span class="st"> </span>normII <span class="op">*</span><span class="st"> </span>normIQR</a>
<a class="sourceLine" id="cb49-10" data-line-number="10"><span class="co"># sd(normII)</span></a>
<a class="sourceLine" id="cb49-11" data-line-number="11"><span class="co"># IQR(normII)</span></a>
<a class="sourceLine" id="cb49-12" data-line-number="12"></a>
<a class="sourceLine" id="cb49-13" data-line-number="13">supTable<span class="op">$</span>normInhibIndex &lt;-<span class="st"> </span>normII</a></code></pre></div>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" data-line-number="1"><span class="co">### Descriptive statistics on the normalized Inhibition Index ####</span></a>
<a class="sourceLine" id="cb50-2" data-line-number="2">normIIStat &lt;-<span class="st"> </span><span class="kw">list</span>(</a>
<a class="sourceLine" id="cb50-3" data-line-number="3">  <span class="dt">mean =</span> <span class="kw">mean</span>(normII),</a>
<a class="sourceLine" id="cb50-4" data-line-number="4">  <span class="dt">sd =</span> <span class="kw">sd</span>(normII),</a>
<a class="sourceLine" id="cb50-5" data-line-number="5">  <span class="dt">IQR =</span> <span class="kw">IQR</span>(normII),</a>
<a class="sourceLine" id="cb50-6" data-line-number="6">  <span class="dt">var =</span> <span class="kw">var</span>(normII),</a>
<a class="sourceLine" id="cb50-7" data-line-number="7">  <span class="dt">min =</span> <span class="kw">min</span>(normII),</a>
<a class="sourceLine" id="cb50-8" data-line-number="8">  <span class="dt">Q1 =</span> <span class="kw">as.vector</span>(<span class="kw">quantile</span>(normII, <span class="dt">probs =</span> <span class="fl">0.25</span>)),</a>
<a class="sourceLine" id="cb50-9" data-line-number="9">  <span class="dt">median =</span> <span class="kw">median</span>(normII),</a>
<a class="sourceLine" id="cb50-10" data-line-number="10">  <span class="dt">Q3 =</span> <span class="kw">as.vector</span>(<span class="kw">quantile</span>(normII, <span class="dt">probs =</span> <span class="fl">0.75</span>)),</a>
<a class="sourceLine" id="cb50-11" data-line-number="11">  <span class="dt">max =</span> <span class="kw">max</span>(normII)</a>
<a class="sourceLine" id="cb50-12" data-line-number="12">)</a>
<a class="sourceLine" id="cb50-13" data-line-number="13"></a>
<a class="sourceLine" id="cb50-14" data-line-number="14"><span class="kw">kable</span>(<span class="kw">t</span>(<span class="kw">as.data.frame.list</span>(normIIStat)), <span class="dt">col.names =</span> <span class="st">&quot;Stat&quot;</span>, <span class="dt">caption =</span> <span class="st">&quot;Statistics of the plate-wise normalized inhibition index&quot;</span>)</a></code></pre></div>
<table>
<caption>Statistics of the plate-wise normalized inhibition index</caption>
<thead>
<tr class="header">
<th></th>
<th align="right">Stat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>mean</td>
<td align="right">0.4144692</td>
</tr>
<tr class="even">
<td>sd</td>
<td align="right">1.8129741</td>
</tr>
<tr class="odd">
<td>IQR</td>
<td align="right">1.3183994</td>
</tr>
<tr class="even">
<td>var</td>
<td align="right">3.2868752</td>
</tr>
<tr class="odd">
<td>min</td>
<td align="right">-2.6280587</td>
</tr>
<tr class="even">
<td>Q1</td>
<td align="right">-0.5094508</td>
</tr>
<tr class="odd">
<td>median</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td>Q3</td>
<td align="right">0.8089486</td>
</tr>
<tr class="odd">
<td>max</td>
<td align="right">17.3161990</td>
</tr>
</tbody>
</table>
<p>The histogram of plate-wise normalized values shows a clear improvement : the median is much closer to the mode than with the raw or log-transformed II values.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" data-line-number="1"><span class="kw">hist</span>(normII, <span class="dt">breaks =</span> <span class="dv">100</span>, <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">border =</span> <span class="st">&quot;grey&quot;</span>)</a>
<a class="sourceLine" id="cb51-2" data-line-number="2"><span class="kw">abline</span>(<span class="dt">v =</span> <span class="kw">mean</span>(normII), <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</a>
<a class="sourceLine" id="cb51-3" data-line-number="3"><span class="kw">abline</span>(<span class="dt">v =</span> <span class="kw">median</span>(normII), <span class="dt">col =</span> <span class="st">&quot;darkgreen&quot;</span>)</a>
<a class="sourceLine" id="cb51-4" data-line-number="4"></a>
<a class="sourceLine" id="cb51-5" data-line-number="5"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;mean&quot;</span>, <span class="st">&quot;median&quot;</span>),</a>
<a class="sourceLine" id="cb51-6" data-line-number="6">       <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;darkgreen&quot;</span>),</a>
<a class="sourceLine" id="cb51-7" data-line-number="7">       <span class="dt">lwd =</span> <span class="dv">2</span>)</a></code></pre></div>
<div class="figure" style="text-align: center">
<img src="figures/touret_sars-cov-2_inhibitorsnormII_distrib-1.png" alt="Distribution of the plate-wise normalized inhibition index" width="60%" />
<p class="caption">
Distribution of the plate-wise normalized inhibition index
</p>
</div>
<div id="normalized-ii-plots" class="section level3">
<h3>Normalized II plots</h3>
<p>The plot of normalized II values (top panel) clearly shows that the plate-wise normalization suppressed the background bias.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" data-line-number="1"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb52-2" data-line-number="2"><span class="kw">plot</span>(normII,</a>
<a class="sourceLine" id="cb52-3" data-line-number="3">     <span class="dt">panel.first =</span> <span class="kw">grid</span>(),</a>
<a class="sourceLine" id="cb52-4" data-line-number="4">     <span class="dt">main =</span> <span class="st">&quot;Inhibition index values&quot;</span>,</a>
<a class="sourceLine" id="cb52-5" data-line-number="5">     <span class="dt">xlab =</span> <span class="st">&quot;Molecules (ranked by inhibition index)&quot;</span>,</a>
<a class="sourceLine" id="cb52-6" data-line-number="6">     <span class="dt">ylab =</span> <span class="st">&quot;Inhibition index&quot;</span>,</a>
<a class="sourceLine" id="cb52-7" data-line-number="7">     <span class="dt">col =</span> supTable<span class="op">$</span>color,</a>
<a class="sourceLine" id="cb52-8" data-line-number="8">     <span class="dt">cex =</span> <span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb52-9" data-line-number="9">     <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="kw">length</span>(normII)<span class="op">*</span><span class="fl">1.05</span>)</a>
<a class="sourceLine" id="cb52-10" data-line-number="10">     )</a>
<a class="sourceLine" id="cb52-11" data-line-number="11"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, </a>
<a class="sourceLine" id="cb52-12" data-line-number="12">       <span class="dt">legend =</span> <span class="kw">names</span>(plateColor), </a>
<a class="sourceLine" id="cb52-13" data-line-number="13">       <span class="dt">col =</span> plateColor, <span class="dt">pch =</span> <span class="dv">1</span>, </a>
<a class="sourceLine" id="cb52-14" data-line-number="14">       <span class="dt">cex =</span> <span class="fl">0.7</span>)</a>
<a class="sourceLine" id="cb52-15" data-line-number="15"></a>
<a class="sourceLine" id="cb52-16" data-line-number="16"><span class="co"># names(supTable)</span></a>
<a class="sourceLine" id="cb52-17" data-line-number="17">normIIrank &lt;-<span class="st"> </span><span class="kw">order</span>(supTable<span class="op">$</span>normInhibIndex, <span class="dt">decreasing =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb52-18" data-line-number="18"><span class="kw">plot</span>(supTable[normIIrank, <span class="st">&quot;normInhibIndex&quot;</span>],</a>
<a class="sourceLine" id="cb52-19" data-line-number="19">     <span class="dt">panel.first =</span> <span class="kw">grid</span>(),</a>
<a class="sourceLine" id="cb52-20" data-line-number="20">     <span class="dt">main =</span> <span class="st">&quot;Ranked inhibition index values&quot;</span>,</a>
<a class="sourceLine" id="cb52-21" data-line-number="21">     <span class="dt">xlab =</span> <span class="st">&quot;Molecules (ranked by inhibition index)&quot;</span>,</a>
<a class="sourceLine" id="cb52-22" data-line-number="22">     <span class="dt">ylab =</span> <span class="st">&quot;Inhibition index&quot;</span>,</a>
<a class="sourceLine" id="cb52-23" data-line-number="23">     <span class="dt">col =</span> supTable[normIIrank, <span class="st">&quot;color&quot;</span>],</a>
<a class="sourceLine" id="cb52-24" data-line-number="24">     <span class="dt">cex =</span> <span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb52-25" data-line-number="25">     <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="kw">length</span>(normII)<span class="op">*</span><span class="fl">1.05</span>)</a>
<a class="sourceLine" id="cb52-26" data-line-number="26">     )</a>
<a class="sourceLine" id="cb52-27" data-line-number="27"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, </a>
<a class="sourceLine" id="cb52-28" data-line-number="28">       <span class="dt">legend =</span> <span class="kw">names</span>(plateColor), </a>
<a class="sourceLine" id="cb52-29" data-line-number="29">       <span class="dt">col =</span> plateColor, <span class="dt">pch =</span> <span class="dv">1</span>, </a>
<a class="sourceLine" id="cb52-30" data-line-number="30">       <span class="dt">cex =</span> <span class="fl">0.4</span>)</a></code></pre></div>
<div class="figure" style="text-align: center">
<img src="figures/touret_sars-cov-2_inhibitorsnormII_ranked-1.png" alt="Values of the plate-wise normalized inhibition index for all the tested molecules. Molecules are colored according to the plate number. " width="60%" />
<p class="caption">
Values of the plate-wise normalized inhibition index for all the tested molecules. Molecules are colored according to the plate number.
</p>
</div>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" data-line-number="1"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</a></code></pre></div>
</div>
</div>
<div id="p-value-computation-1" class="section level2">
<h2>P-value computation</h2>
<p>We compute the p-value as the upper tail of the normal distribution (rigth-side test) in order to detect significantly high values of the plate-wise normalized index.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" data-line-number="1"><span class="co">#### Compute P-value for the inhibition index ####</span></a>
<a class="sourceLine" id="cb54-2" data-line-number="2">supTable<span class="op">$</span>p.value &lt;-<span class="st"> </span><span class="kw">pnorm</span>(normII, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb54-3" data-line-number="3">supTable<span class="op">$</span>log10Pval &lt;-<span class="st"> </span><span class="kw">log10</span>(supTable<span class="op">$</span>p.value)</a>
<a class="sourceLine" id="cb54-4" data-line-number="4">supTable<span class="op">$</span>e.value &lt;-<span class="st"> </span>supTable<span class="op">$</span>p.value <span class="op">*</span><span class="st"> </span><span class="kw">length</span>(normII)</a>
<a class="sourceLine" id="cb54-5" data-line-number="5">supTable<span class="op">$</span>padj &lt;-<span class="st"> </span><span class="kw">p.adjust</span>(supTable<span class="op">$</span>p.value, <span class="dt">method =</span> <span class="st">&quot;fdr&quot;</span>)</a>
<a class="sourceLine" id="cb54-6" data-line-number="6">supTable<span class="op">$</span>log10Padj &lt;-<span class="st"> </span><span class="kw">log10</span>(supTable<span class="op">$</span>padj)</a></code></pre></div>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" data-line-number="1"><span class="kw">hist</span>(supTable<span class="op">$</span>p.value, <span class="dt">breaks =</span> <span class="dv">20</span>, </a>
<a class="sourceLine" id="cb55-2" data-line-number="2">     <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>,</a>
<a class="sourceLine" id="cb55-3" data-line-number="3">     <span class="dt">main =</span> <span class="st">&quot;P-value histogram after plate-wise normalization&quot;</span>,</a>
<a class="sourceLine" id="cb55-4" data-line-number="4">     <span class="dt">xlab =</span> <span class="st">&quot;Nominal P-value (unadjusted)&quot;</span>,</a>
<a class="sourceLine" id="cb55-5" data-line-number="5">     <span class="dt">ylab =</span> <span class="st">&quot;Frequency&quot;</span>)</a></code></pre></div>
<div class="figure" style="text-align: center">
<img src="figures/touret_sars-cov-2_inhibitorspval_histogram-1.png" alt="Histogram of the nominal (unadjusted) p-values derived from the plate-wise normalized inhibition index. " width="60%" />
<p class="caption">
Histogram of the nominal (unadjusted) p-values derived from the plate-wise normalized inhibition index.
</p>
</div>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" data-line-number="1"><span class="co">#### Volcano plot ####</span></a>
<a class="sourceLine" id="cb56-2" data-line-number="2"></a>
<a class="sourceLine" id="cb56-3" data-line-number="3"><span class="kw">plot</span>(<span class="dt">x =</span> supTable<span class="op">$</span>normInhibIndex,</a>
<a class="sourceLine" id="cb56-4" data-line-number="4">     <span class="dt">y =</span> <span class="op">-</span>supTable<span class="op">$</span>log10Padj, </a>
<a class="sourceLine" id="cb56-5" data-line-number="5">     <span class="dt">col =</span> supTable<span class="op">$</span>color,</a>
<a class="sourceLine" id="cb56-6" data-line-number="6">     <span class="dt">main =</span> <span class="st">&quot;Volcano plot&quot;</span>,</a>
<a class="sourceLine" id="cb56-7" data-line-number="7">     <span class="dt">xlab =</span> <span class="st">&quot;Normalized inhibition index&quot;</span>,</a>
<a class="sourceLine" id="cb56-8" data-line-number="8">     <span class="dt">ylab =</span> <span class="st">&quot;Significance = -log10(Padj)&quot;</span>)</a>
<a class="sourceLine" id="cb56-9" data-line-number="9"><span class="kw">grid</span>()</a></code></pre></div>
<div class="figure" style="text-align: center">
<img src="figures/touret_sars-cov-2_inhibitorsvolcano_plot-1.png" alt="Volcano plot. " width="60%" />
<p class="caption">
Volcano plot.
</p>
</div>
</div>
<div id="selection-of-candidate-molecules-1" class="section level2">
<h2>Selection of candidate molecules</h2>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" data-line-number="1"><span class="co">#### Select significant normalized II values ####</span></a>
<a class="sourceLine" id="cb57-2" data-line-number="2">alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></a>
<a class="sourceLine" id="cb57-3" data-line-number="3"><span class="co"># table(supTable$padj &lt; alpha)</span></a>
<a class="sourceLine" id="cb57-4" data-line-number="4">selected &lt;-<span class="st"> </span><span class="kw">subset</span>(supTable, supTable<span class="op">$</span>padj <span class="op">&lt;</span><span class="st"> </span>alpha)</a>
<a class="sourceLine" id="cb57-5" data-line-number="5"></a>
<a class="sourceLine" id="cb57-6" data-line-number="6"><span class="co">## Sort by decreasing adjusted p-value</span></a>
<a class="sourceLine" id="cb57-7" data-line-number="7">selected &lt;-<span class="st"> </span>selected[<span class="kw">order</span>(selected<span class="op">$</span>padj, <span class="dt">decreasing =</span> <span class="ot">FALSE</span>), ]</a>
<a class="sourceLine" id="cb57-8" data-line-number="8"><span class="co"># kable(names(selected), row.names=TRUE)</span></a>
<a class="sourceLine" id="cb57-9" data-line-number="9"></a>
<a class="sourceLine" id="cb57-10" data-line-number="10"><span class="co">## Print selected molecules</span></a>
<a class="sourceLine" id="cb57-11" data-line-number="11"><span class="kw">kable</span>(selected[ , <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dv">5</span><span class="op">:</span><span class="dv">7</span>, <span class="dv">10</span>, <span class="dv">12</span>, <span class="dv">15</span>)], </a>
<a class="sourceLine" id="cb57-12" data-line-number="12">      <span class="dt">row.names =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb57-13" data-line-number="13">      <span class="dt">digits =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb57-14" data-line-number="14">      <span class="dt">caption =</span> <span class="st">&quot;Candidate moecules sorted by significance after plate-wise normalization. &quot;</span>)</a></code></pre></div>
<table>
<caption>Candidate moecules sorted by significance after plate-wise normalization.</caption>
<thead>
<tr class="header">
<th align="left">ID</th>
<th align="left">Prestw.number</th>
<th align="left">Chemical.name</th>
<th align="left">Broad.Therapeutic.class</th>
<th align="left">Reported.therapeutic.effect</th>
<th align="right">Inhibition.Index</th>
<th align="right">normInhibIndex</th>
<th align="right">log10Pval</th>
<th align="right">log10Padj</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">01F08</td>
<td align="left">Prestw-57</td>
<td align="left">Benoxinate hydrochloride</td>
<td align="left">Neuromuscular</td>
<td align="left">Local anesthetic</td>
<td align="right">1.1929</td>
<td align="right">17.3162</td>
<td align="right">-66.7507</td>
<td align="right">-63.5689</td>
</tr>
<tr class="even">
<td align="left">09F04</td>
<td align="left">Prestw-693</td>
<td align="left">Promazine hydrochloride</td>
<td align="left">Central Nervous System</td>
<td align="left">Antipsychotic</td>
<td align="right">1.1610</td>
<td align="right">13.6259</td>
<td align="right">-41.8527</td>
<td align="right">-38.9719</td>
</tr>
<tr class="odd">
<td align="left">01H07</td>
<td align="left">Prestw-76</td>
<td align="left">Dibucaine</td>
<td align="left">Neuromuscular</td>
<td align="left">Local anesthetic</td>
<td align="right">0.9095</td>
<td align="right">13.1373</td>
<td align="right">-38.9971</td>
<td align="right">-36.2924</td>
</tr>
<tr class="even">
<td align="left">01A06</td>
<td align="left">Prestw-5</td>
<td align="left">Atracurium besylate</td>
<td align="left">Neuromuscular</td>
<td align="left">Curarizing</td>
<td align="right">0.8693</td>
<td align="right">12.5450</td>
<td align="right">-35.6745</td>
<td align="right">-33.0947</td>
</tr>
<tr class="odd">
<td align="left">09D04</td>
<td align="left">Prestw-1456</td>
<td align="left">Opipramol dihydrochloride</td>
<td align="left">Central Nervous System</td>
<td align="left">Antidepressant ’Antipsychotic</td>
<td align="right">1.0521</td>
<td align="right">12.3002</td>
<td align="right">-34.3449</td>
<td align="right">-31.8620</td>
</tr>
<tr class="even">
<td align="left">01D05</td>
<td align="left">Prestw-34</td>
<td align="left">Triamterene</td>
<td align="left">Metabolism</td>
<td align="left">Antihypertensive ’Diuretic</td>
<td align="right">0.7586</td>
<td align="right">10.9129</td>
<td align="right">-27.3010</td>
<td align="right">-24.8973</td>
</tr>
<tr class="odd">
<td align="left">01D08</td>
<td align="left">Prestw-37</td>
<td align="left">Pyrimethamine</td>
<td align="left">Infectiology</td>
<td align="left">Antimalarial ’Antiprotozoal ’Antineoplastic</td>
<td align="right">0.7421</td>
<td align="right">10.6701</td>
<td align="right">-26.1533</td>
<td align="right">-23.8165</td>
</tr>
<tr class="even">
<td align="left">01H05</td>
<td align="left">Prestw-74</td>
<td align="left">Amitryptiline hydrochloride</td>
<td align="left">Central Nervous System</td>
<td align="left">Antidepressant</td>
<td align="right">0.7185</td>
<td align="right">10.3214</td>
<td align="right">-24.5496</td>
<td align="right">-22.2709</td>
</tr>
<tr class="odd">
<td align="left">07G07</td>
<td align="left">Prestw-546</td>
<td align="left">Pregnenolone</td>
<td align="left">Endocrinology</td>
<td align="left">Anabolic ’Anti-inflammatory</td>
<td align="right">1.6589</td>
<td align="right">10.2242</td>
<td align="right">-24.1121</td>
<td align="right">-21.8845</td>
</tr>
<tr class="even">
<td align="left">09G07</td>
<td align="left">Prestw-706</td>
<td align="left">Chlorcyclizine hydrochloride</td>
<td align="left">Allergology ’Central Nervous System</td>
<td align="left">Antiemetic ’Antihistaminic ’Sedative</td>
<td align="right">0.8573</td>
<td align="right">9.9275</td>
<td align="right">-22.8014</td>
<td align="right">-20.6195</td>
</tr>
<tr class="odd">
<td align="left">08E11</td>
<td align="left">Prestw-1284</td>
<td align="left">Hydroxychloroquine sulfate</td>
<td align="left">Metabolism</td>
<td align="left">Antimalarial</td>
<td align="right">1.4327</td>
<td align="right">9.5497</td>
<td align="right">-21.1869</td>
<td align="right">-19.0464</td>
</tr>
<tr class="even">
<td align="left">09G08</td>
<td align="left">Prestw-707</td>
<td align="left">Diphenylpyraline hydrochloride</td>
<td align="left">Allergology ’Central Nervous System</td>
<td align="left">Antihistaminic ’Antipruritic ’Sedative</td>
<td align="right">0.8198</td>
<td align="right">9.4706</td>
<td align="right">-20.8568</td>
<td align="right">-18.7541</td>
</tr>
<tr class="odd">
<td align="left">01H03</td>
<td align="left">Prestw-72</td>
<td align="left">Imipramine hydrochloride</td>
<td align="left">Central Nervous System</td>
<td align="left">Antidepressant</td>
<td align="right">0.6546</td>
<td align="right">9.3790</td>
<td align="right">-20.4777</td>
<td align="right">-18.4098</td>
</tr>
<tr class="even">
<td align="left">03G08</td>
<td align="left">Prestw-227</td>
<td align="left">Clemizole hydrochloride</td>
<td align="left">Allergology ’Dermatology ’Infectiology</td>
<td align="left">Antibacterial ’Antifungal ’Antihistaminic ’Antipruritic</td>
<td align="right">1.0073</td>
<td align="right">9.2085</td>
<td align="right">-19.7816</td>
<td align="right">-17.7459</td>
</tr>
<tr class="odd">
<td align="left">03H10</td>
<td align="left">Prestw-239</td>
<td align="left">Orphenadrine hydrochloride</td>
<td align="left">Allergology ’Central Nervous System</td>
<td align="left">Antihistaminic ’Antiparkinsonian</td>
<td align="right">0.9732</td>
<td align="right">8.8673</td>
<td align="right">-18.4263</td>
<td align="right">-16.4205</td>
</tr>
<tr class="even">
<td align="left">10G08</td>
<td align="left">Prestw-787</td>
<td align="left">Merbromin disodium salt</td>
<td align="left">Infectiology</td>
<td align="left">Antibacterial ’Antineoplastic</td>
<td align="right">1.1210</td>
<td align="right">8.5583</td>
<td align="right">-17.2420</td>
<td align="right">-15.2642</td>
</tr>
<tr class="odd">
<td align="left">01G11</td>
<td align="left">Prestw-70</td>
<td align="left">Tolnaftate</td>
<td align="left">Infectiology</td>
<td align="left">Antifungal ’Antifungal</td>
<td align="right">0.5943</td>
<td align="right">8.4900</td>
<td align="right">-16.9857</td>
<td align="right">-15.0343</td>
</tr>
<tr class="even">
<td align="left">07G09</td>
<td align="left">Prestw-548</td>
<td align="left">Chloroquine diphosphate</td>
<td align="left">Metabolism</td>
<td align="left">Anti-inflammatory ’Antimalarial ’Antiprotozoal</td>
<td align="right">1.3510</td>
<td align="right">8.2212</td>
<td align="right">-15.9967</td>
<td align="right">-14.0701</td>
</tr>
<tr class="odd">
<td align="left">01H04</td>
<td align="left">Prestw-73</td>
<td align="left">Sulindac</td>
<td align="left">Central Nervous System</td>
<td align="left">Analgesic ’Anti-inflammatory ’Antipyretic</td>
<td align="right">0.5382</td>
<td align="right">7.6639</td>
<td align="right">-14.0448</td>
<td align="right">-12.1417</td>
</tr>
<tr class="even">
<td align="left">07B04</td>
<td align="left">Prestw-493</td>
<td align="left">Omeprazole</td>
<td align="left">Gastroenterology</td>
<td align="left">Antiulcer</td>
<td align="right">1.2487</td>
<td align="right">7.5558</td>
<td align="right">-13.6816</td>
<td align="right">-11.8008</td>
</tr>
<tr class="odd">
<td align="left">08D06</td>
<td align="left">Prestw-1410</td>
<td align="left">Exemestane</td>
<td align="left">Endocrinology</td>
<td align="left">Antineoplastic</td>
<td align="right">1.0965</td>
<td align="right">7.2559</td>
<td align="right">-12.7002</td>
<td align="right">-10.8405</td>
</tr>
<tr class="even">
<td align="left">01C05</td>
<td align="left">Prestw-24</td>
<td align="left">Norethynodrel</td>
<td align="left">Endocrinology</td>
<td align="left">Contraceptive</td>
<td align="right">0.5082</td>
<td align="right">7.2204</td>
<td align="right">-12.5864</td>
<td align="right">-10.7469</td>
</tr>
<tr class="odd">
<td align="left">09G09</td>
<td align="left">Prestw-708</td>
<td align="left">Benzethonium chloride</td>
<td align="left">Infectiology</td>
<td align="left">Antibacterial ’Antiseptic ’Antineoplastic</td>
<td align="right">0.6042</td>
<td align="right">6.8461</td>
<td align="right">-11.4209</td>
<td align="right">-9.6193</td>
</tr>
<tr class="even">
<td align="left">10D08</td>
<td align="left">Prestw-757</td>
<td align="left">Chlorotrianisene</td>
<td align="left">Endocrinology</td>
<td align="left">Antineoplastic</td>
<td align="right">0.9163</td>
<td align="right">6.8511</td>
<td align="right">-11.4360</td>
<td align="right">-9.6193</td>
</tr>
<tr class="odd">
<td align="left">03B05</td>
<td align="left">Prestw-174</td>
<td align="left">Alverine citrate salt</td>
<td align="left">Neuromuscular</td>
<td align="left">Antispastic</td>
<td align="right">0.7629</td>
<td align="right">6.7652</td>
<td align="right">-11.1768</td>
<td align="right">-9.3929</td>
</tr>
<tr class="even">
<td align="left">08H03</td>
<td align="left">Prestw-632</td>
<td align="left">Dipivefrin hydrochloride</td>
<td align="left">Ophthalmology</td>
<td align="left">Antiglaucoma</td>
<td align="right">1.0095</td>
<td align="right">6.6623</td>
<td align="right">-10.8704</td>
<td align="right">-9.1035</td>
</tr>
<tr class="odd">
<td align="left">01E08</td>
<td align="left">Prestw-47</td>
<td align="left">Ticlopidine hydrochloride</td>
<td align="left">Hematology</td>
<td align="left">Anticoagulant ’Antiplatelet</td>
<td align="right">0.4552</td>
<td align="right">6.4400</td>
<td align="right">-10.2236</td>
<td align="right">-8.4731</td>
</tr>
<tr class="even">
<td align="left">06D11</td>
<td align="left">Prestw-440</td>
<td align="left">Epiandrosterone</td>
<td align="left">Endocrinology</td>
<td align="left">Anabolic</td>
<td align="right">1.0748</td>
<td align="right">6.1387</td>
<td align="right">-9.3809</td>
<td align="right">-7.6762</td>
</tr>
<tr class="odd">
<td align="left">07H07</td>
<td align="left">Prestw-1144</td>
<td align="left">Mirtazapine</td>
<td align="left">Central Nervous System</td>
<td align="left">Antidepressant</td>
<td align="right">1.0320</td>
<td align="right">6.1458</td>
<td align="right">-9.4004</td>
<td align="right">-7.6762</td>
</tr>
<tr class="even">
<td align="left">10H10</td>
<td align="left">Prestw-799</td>
<td align="left">Pridinol methanesulfonate salt</td>
<td align="left">Central Nervous System</td>
<td align="left">Antiparkinsonian</td>
<td align="right">0.8315</td>
<td align="right">6.1438</td>
<td align="right">-9.3947</td>
<td align="right">-7.6762</td>
</tr>
<tr class="odd">
<td align="left">05A10</td>
<td align="left">Prestw-329</td>
<td align="left">Tacrine hydrochloride</td>
<td align="left">Central Nervous System</td>
<td align="left">CNS Stimulant</td>
<td align="right">1.4422</td>
<td align="right">6.1320</td>
<td align="right">-9.3627</td>
<td align="right">-7.6722</td>
</tr>
<tr class="even">
<td align="left">01G06</td>
<td align="left">Prestw-65</td>
<td align="left">Diphenhydramine hydrochloride</td>
<td align="left">Allergology ’Central Nervous System</td>
<td align="left">Antiemetic ’Antihistaminic ’Antitussive ’Sedative</td>
<td align="right">0.4338</td>
<td align="right">6.1245</td>
<td align="right">-9.3420</td>
<td align="right">-7.6679</td>
</tr>
<tr class="odd">
<td align="left">09D02</td>
<td align="left">Prestw-671</td>
<td align="left">Dydrogesterone</td>
<td align="left">Endocrinology</td>
<td align="left">Progestogen</td>
<td align="right">0.5447</td>
<td align="right">6.1205</td>
<td align="right">-9.3313</td>
<td align="right">-7.6679</td>
</tr>
<tr class="even">
<td align="left">06H02</td>
<td align="left">Prestw-1358</td>
<td align="left">Vatalanib</td>
<td align="left">Oncology</td>
<td align="left">Antineoplastic</td>
<td align="right">0.9984</td>
<td align="right">5.6848</td>
<td align="right">-8.1838</td>
<td align="right">-6.5334</td>
</tr>
<tr class="odd">
<td align="left">07B03</td>
<td align="left">Prestw-492</td>
<td align="left">Nitrofural</td>
<td align="left">Infectiology</td>
<td align="left">Antibacterial ’Antidotes</td>
<td align="right">0.9359</td>
<td align="right">5.5207</td>
<td align="right">-7.7727</td>
<td align="right">-6.1349</td>
</tr>
<tr class="even">
<td align="left">07F02</td>
<td align="left">Prestw-531</td>
<td align="left">Pirenperone</td>
<td align="left">Central Nervous System</td>
<td align="left">Anxiolytic</td>
<td align="right">0.9157</td>
<td align="right">5.3890</td>
<td align="right">-7.4506</td>
<td align="right">-5.8251</td>
</tr>
<tr class="odd">
<td align="left">08H02</td>
<td align="left">Prestw-1210</td>
<td align="left">Alendronate sodium</td>
<td align="left">Metabolism</td>
<td align="left">Antiosteoporetic</td>
<td align="right">0.8169</td>
<td align="right">5.3477</td>
<td align="right">-7.3512</td>
<td align="right">-5.7376</td>
</tr>
<tr class="even">
<td align="left">07H10</td>
<td align="left">Prestw-1817</td>
<td align="left">Tazarotene</td>
<td align="left">Dermatology</td>
<td align="left">Antipsoriatic ’Antiacneic</td>
<td align="right">0.9001</td>
<td align="right">5.2876</td>
<td align="right">-7.2079</td>
<td align="right">-5.6058</td>
</tr>
<tr class="odd">
<td align="left">07C10</td>
<td align="left">Prestw-509</td>
<td align="left">Bromperidol</td>
<td align="left">Central Nervous System</td>
<td align="left">Antipsychotic</td>
<td align="right">0.8959</td>
<td align="right">5.2605</td>
<td align="right">-7.1438</td>
<td align="right">-5.5530</td>
</tr>
<tr class="even">
<td align="left">02C08</td>
<td align="left">Prestw-1314</td>
<td align="left">Pioglitazone</td>
<td align="left">Endocrinology</td>
<td align="left">NA</td>
<td align="right">0.9499</td>
<td align="right">5.2324</td>
<td align="right">-7.0774</td>
<td align="right">-5.4977</td>
</tr>
<tr class="odd">
<td align="left">09G04</td>
<td align="left">Prestw-703</td>
<td align="left">Famprofazone</td>
<td align="left">Central Nervous System ’Metabolism</td>
<td align="left">Analgesic ’Antipyretic</td>
<td align="right">0.4661</td>
<td align="right">5.1634</td>
<td align="right">-6.9163</td>
<td align="right">-5.3472</td>
</tr>
<tr class="even">
<td align="left">07C03</td>
<td align="left">Prestw-502</td>
<td align="left">Biperiden hydrochloride</td>
<td align="left">Central Nervous System</td>
<td align="left">Antiparkinsonian ’Antineoplastic</td>
<td align="right">0.8495</td>
<td align="right">4.9587</td>
<td align="right">-6.4500</td>
<td align="right">-4.8914</td>
</tr>
<tr class="odd">
<td align="left">10A08</td>
<td align="left">Prestw-1140</td>
<td align="left">Liranaftate</td>
<td align="left">Infectiology</td>
<td align="left">Antifungal</td>
<td align="right">0.6869</td>
<td align="right">4.9379</td>
<td align="right">-6.4035</td>
<td align="right">-4.8551</td>
</tr>
<tr class="even">
<td align="left">09F10</td>
<td align="left">Prestw-699</td>
<td align="left">Hexestrol</td>
<td align="left">Endocrinology</td>
<td align="left">Antineoplastic</td>
<td align="right">0.4442</td>
<td align="right">4.8967</td>
<td align="right">-6.3122</td>
<td align="right">-4.7738</td>
</tr>
<tr class="odd">
<td align="left">03F02</td>
<td align="left">Prestw-211</td>
<td align="left">Piroxicam</td>
<td align="left">Central Nervous System ’Hematology ’Metabolism</td>
<td align="left">Analgesic ’Anticoagulant ’Anti-inflammatory ’Antiplatelet ’Antipyretic ’Uricosuric</td>
<td align="right">0.5726</td>
<td align="right">4.8617</td>
<td align="right">-6.2351</td>
<td align="right">-4.7065</td>
</tr>
<tr class="even">
<td align="left">02B04</td>
<td align="left">Prestw-93</td>
<td align="left">Azacyclonol</td>
<td align="left">Central Nervous System</td>
<td align="left">Antipsychotic</td>
<td align="right">0.8837</td>
<td align="right">4.8187</td>
<td align="right">-6.1413</td>
<td align="right">-4.6222</td>
</tr>
<tr class="odd">
<td align="left">09A09</td>
<td align="left">Prestw-1154</td>
<td align="left">Nilvadipine</td>
<td align="left">Cardiovascular</td>
<td align="left">Antianginal ’Antihypertensive</td>
<td align="right">0.4331</td>
<td align="right">4.7626</td>
<td align="right">-6.0197</td>
<td align="right">-4.5100</td>
</tr>
<tr class="even">
<td align="left">06F06</td>
<td align="left">Prestw-455</td>
<td align="left">Mebhydroline 1,5-naphtalenedisulfonate</td>
<td align="left">Allergology</td>
<td align="left">Antihistaminic</td>
<td align="right">0.8344</td>
<td align="right">4.7109</td>
<td align="right">-5.9090</td>
<td align="right">-4.4084</td>
</tr>
<tr class="odd">
<td align="left">10E06</td>
<td align="left">Prestw-765</td>
<td align="left">Ethoxyquin</td>
<td align="left">Metabolism</td>
<td align="left">Antifungal ’Antineoplastic</td>
<td align="right">0.6516</td>
<td align="right">4.6433</td>
<td align="right">-5.7658</td>
<td align="right">-4.2742</td>
</tr>
<tr class="even">
<td align="left">09G02</td>
<td align="left">Prestw-701</td>
<td align="left">Trihexyphenidyl-D,L hydrochloride</td>
<td align="left">Central Nervous System</td>
<td align="left">Antiparkinsonian</td>
<td align="right">0.4224</td>
<td align="right">4.6316</td>
<td align="right">-5.7412</td>
<td align="right">-4.2583</td>
</tr>
<tr class="odd">
<td align="left">07H06</td>
<td align="left">Prestw-555</td>
<td align="left">Nifuroxazide</td>
<td align="left">Infectiology ’Metabolism</td>
<td align="left">Antibacterial ’Antineoplastic</td>
<td align="right">0.7750</td>
<td align="right">4.4736</td>
<td align="right">-5.4151</td>
<td align="right">-3.9409</td>
</tr>
<tr class="even">
<td align="left">08G02</td>
<td align="left">Prestw-1506</td>
<td align="left">Mizolastine</td>
<td align="left">Allergology</td>
<td align="left">Antihistaminic</td>
<td align="right">0.6881</td>
<td align="right">4.4689</td>
<td align="right">-5.4056</td>
<td align="right">-3.9397</td>
</tr>
<tr class="odd">
<td align="left">05E07</td>
<td align="left">Prestw-366</td>
<td align="left">Ambroxol hydrochloride</td>
<td align="left">Respiratory</td>
<td align="left">Expectorant ’Mucolytic</td>
<td align="right">1.0851</td>
<td align="right">4.4205</td>
<td align="right">-5.3077</td>
<td align="right">-3.8501</td>
</tr>
<tr class="even">
<td align="left">08E07</td>
<td align="left">Prestw-1331</td>
<td align="left">Rimantadine hydrochloride</td>
<td align="left">Infectiology</td>
<td align="left">Antiviral</td>
<td align="right">0.6754</td>
<td align="right">4.3825</td>
<td align="right">-5.2316</td>
<td align="right">-3.7822</td>
</tr>
<tr class="odd">
<td align="left">02B03</td>
<td align="left">Prestw-92</td>
<td align="left">Zimelidine dihydrochloride monohydrate</td>
<td align="left">Central Nervous System</td>
<td align="left">Antidepressant</td>
<td align="right">0.8074</td>
<td align="right">4.3412</td>
<td align="right">-5.1496</td>
<td align="right">-3.7081</td>
</tr>
<tr class="even">
<td align="left">08B06</td>
<td align="left">Prestw-1351</td>
<td align="left">Tenatoprazole</td>
<td align="left">Metabolism</td>
<td align="left">Antiulcer</td>
<td align="right">0.6656</td>
<td align="right">4.3155</td>
<td align="right">-5.0989</td>
<td align="right">-3.6652</td>
</tr>
<tr class="odd">
<td align="left">07D09</td>
<td align="left">Prestw-518</td>
<td align="left">Budesonide</td>
<td align="left">Endocrinology</td>
<td align="left">Anti-inflammatory ’Antineoplastic</td>
<td align="right">0.7260</td>
<td align="right">4.1553</td>
<td align="right">-4.7894</td>
<td align="right">-3.3634</td>
</tr>
<tr class="even">
<td align="left">10C04</td>
<td align="left">Prestw-743</td>
<td align="left">Medrysone</td>
<td align="left">Metabolism</td>
<td align="left">Anti-inflammatory</td>
<td align="right">0.5853</td>
<td align="right">4.0908</td>
<td align="right">-4.6677</td>
<td align="right">-3.2493</td>
</tr>
<tr class="odd">
<td align="left">18B09</td>
<td align="left">Prestw-1951</td>
<td align="left">Eperisone HCl</td>
<td align="left">Neuromuscular</td>
<td align="left">Muscle relaxant ’Antispastic</td>
<td align="right">1.2543</td>
<td align="right">4.0465</td>
<td align="right">-4.5852</td>
<td align="right">-3.1742</td>
</tr>
<tr class="even">
<td align="left">05F11</td>
<td align="left">Prestw-380</td>
<td align="left">Clebopride maleate</td>
<td align="left">Central Nervous System</td>
<td align="left">Antiemetic ’Antispastic</td>
<td align="right">1.0019</td>
<td align="right">4.0215</td>
<td align="right">-4.5389</td>
<td align="right">-3.1352</td>
</tr>
<tr class="odd">
<td align="left">03E06</td>
<td align="left">Prestw-205</td>
<td align="left">Tolfenamic acid</td>
<td align="left">Central Nervous System ’Metabolism</td>
<td align="left">Analgesic ’Anti-inflammatory</td>
<td align="right">0.4812</td>
<td align="right">3.9481</td>
<td align="right">-4.4046</td>
<td align="right">-3.0081</td>
</tr>
<tr class="even">
<td align="left">06G08</td>
<td align="left">Prestw-1157</td>
<td align="left">Rifapentine</td>
<td align="left">Infectiology</td>
<td align="left">Antibacterial</td>
<td align="right">0.7050</td>
<td align="right">3.9421</td>
<td align="right">-4.3938</td>
<td align="right">-3.0044</td>
</tr>
<tr class="odd">
<td align="left">02B07</td>
<td align="left">Prestw-96</td>
<td align="left">Guanabenz acetate</td>
<td align="left">Central Nervous System</td>
<td align="left">Antihypertensive</td>
<td align="right">0.7415</td>
<td align="right">3.9291</td>
<td align="right">-4.3703</td>
<td align="right">-2.9878</td>
</tr>
<tr class="even">
<td align="left">19B02</td>
<td align="left">Prestw-1996</td>
<td align="left">Budralazine</td>
<td align="left">Cardiovascular</td>
<td align="left">Vasodilator ’Antihypertensive</td>
<td align="right">1.5490</td>
<td align="right">3.8570</td>
<td align="right">-4.2411</td>
<td align="right">-2.8655</td>
</tr>
<tr class="odd">
<td align="left">02F05</td>
<td align="left">Prestw-134</td>
<td align="left">Diltiazem hydrochloride</td>
<td align="left">Cardiovascular ’Hematology ’Metabolism</td>
<td align="left">Antianginal ’Antiarrhythmic ’Antihypertensive ’Antiplatelet ’Diuretic ’Vasodilator</td>
<td align="right">0.7261</td>
<td align="right">3.8328</td>
<td align="right">-4.1983</td>
<td align="right">-2.8294</td>
</tr>
<tr class="even">
<td align="left">07B10</td>
<td align="left">Prestw-499</td>
<td align="left">Propafenone hydrochloride</td>
<td align="left">Cardiovascular</td>
<td align="left">Antiarrhythmic</td>
<td align="right">0.6744</td>
<td align="right">3.8192</td>
<td align="right">-4.1743</td>
<td align="right">-2.8120</td>
</tr>
<tr class="odd">
<td align="left">06H07</td>
<td align="left">Prestw-476</td>
<td align="left">Primaquine diphosphate</td>
<td align="left">Infectiology</td>
<td align="left">Antimalarial</td>
<td align="right">0.6817</td>
<td align="right">3.8043</td>
<td align="right">-4.1481</td>
<td align="right">-2.7923</td>
</tr>
<tr class="even">
<td align="left">10G06</td>
<td align="left">Prestw-785</td>
<td align="left">Dicumarol</td>
<td align="left">Hematology</td>
<td align="left">Anticoagulant</td>
<td align="right">0.5496</td>
<td align="right">3.7924</td>
<td align="right">-4.1273</td>
<td align="right">-2.7780</td>
</tr>
<tr class="odd">
<td align="left">04B07</td>
<td align="left">Prestw-256</td>
<td align="left">Isotretinoin</td>
<td align="left">Dermatology</td>
<td align="left">Keratolytic ’Antineoplastic</td>
<td align="right">1.4837</td>
<td align="right">3.7675</td>
<td align="right">-4.0838</td>
<td align="right">-2.7408</td>
</tr>
<tr class="even">
<td align="left">02G02</td>
<td align="left">Prestw-141</td>
<td align="left">Verapamil hydrochloride</td>
<td align="left">Cardiovascular</td>
<td align="left">Antihypertensive ’Antineoplastic</td>
<td align="right">0.7099</td>
<td align="right">3.7315</td>
<td align="right">-4.0215</td>
<td align="right">-2.6847</td>
</tr>
<tr class="odd">
<td align="left">07A09</td>
<td align="left">Prestw-488</td>
<td align="left">Dosulepin hydrochloride</td>
<td align="left">Central Nervous System</td>
<td align="left">Antidepressant ’CNS Stimulant</td>
<td align="right">0.6519</td>
<td align="right">3.6729</td>
<td align="right">-3.9212</td>
<td align="right">-2.5906</td>
</tr>
<tr class="even">
<td align="left">05G08</td>
<td align="left">Prestw-387</td>
<td align="left">Carbetapentane citrate</td>
<td align="left">Central Nervous System ’Neuromuscular</td>
<td align="left">Antispastic ’Antitussive ’Local anesthetic</td>
<td align="right">0.9224</td>
<td align="right">3.6408</td>
<td align="right">-3.8668</td>
<td align="right">-2.5423</td>
</tr>
<tr class="odd">
<td align="left">04D11</td>
<td align="left">Prestw-280</td>
<td align="left">Quinidine hydrochloride monohydrate</td>
<td align="left">Cardiovascular ’Infectiology</td>
<td align="left">Antiarrhythmic ’Antimalarial</td>
<td align="right">1.4110</td>
<td align="right">3.5606</td>
<td align="right">-3.7328</td>
<td align="right">-2.4143</td>
</tr>
<tr class="even">
<td align="left">18C04</td>
<td align="left">Prestw-1961</td>
<td align="left">Methandrostenolone</td>
<td align="left">Endocrinology</td>
<td align="left">Anabolic</td>
<td align="right">1.1262</td>
<td align="right">3.5425</td>
<td align="right">-3.7030</td>
<td align="right">-2.3904</td>
</tr>
<tr class="odd">
<td align="left">10B11</td>
<td align="left">Prestw-1820</td>
<td align="left">Amprenavir</td>
<td align="left">Infectiology</td>
<td align="left">Antiviral</td>
<td align="right">0.5188</td>
<td align="right">3.5356</td>
<td align="right">-3.6916</td>
<td align="right">-2.3848</td>
</tr>
<tr class="even">
<td align="left">06E06</td>
<td align="left">Prestw-445</td>
<td align="left">Cyclobenzaprine hydrochloride</td>
<td align="left">Neuromuscular</td>
<td align="left">Muscle relaxant</td>
<td align="right">0.6333</td>
<td align="right">3.5168</td>
<td align="right">-3.6608</td>
<td align="right">-2.3598</td>
</tr>
<tr class="odd">
<td align="left">10G10</td>
<td align="left">Prestw-789</td>
<td align="left">Drofenine hydrochloride</td>
<td align="left">Neuromuscular</td>
<td align="left">Antispastic</td>
<td align="right">0.4990</td>
<td align="right">3.3704</td>
<td align="right">-3.4257</td>
<td align="right">-2.1325</td>
</tr>
<tr class="even">
<td align="left">11E11</td>
<td align="left">Prestw-850</td>
<td align="left">Equilin</td>
<td align="left">Endocrinology</td>
<td align="left">NA</td>
<td align="right">1.2816</td>
<td align="right">3.3683</td>
<td align="right">-3.4223</td>
<td align="right">-2.1325</td>
</tr>
<tr class="odd">
<td align="left">08A08</td>
<td align="left">Prestw-1139</td>
<td align="left">Itraconazole</td>
<td align="left">Infectiology ’Metabolism</td>
<td align="left">Antifungal ’Antifungal</td>
<td align="right">0.5215</td>
<td align="right">3.3324</td>
<td align="right">-3.3660</td>
<td align="right">-2.0818</td>
</tr>
<tr class="even">
<td align="left">06C08</td>
<td align="left">Prestw-1393</td>
<td align="left">Dibenzepine hydrochloride</td>
<td align="left">Central Nervous System</td>
<td align="left">Antidepressant</td>
<td align="right">0.5990</td>
<td align="right">3.3127</td>
<td align="right">-3.3354</td>
<td align="right">-2.0566</td>
</tr>
<tr class="odd">
<td align="left">11F03</td>
<td align="left">Prestw-1454</td>
<td align="left">Nylidrin</td>
<td align="left">Cardiovascular</td>
<td align="left">Vasodilator</td>
<td align="right">1.2631</td>
<td align="right">3.3078</td>
<td align="right">-3.3278</td>
<td align="right">-2.0545</td>
</tr>
<tr class="even">
<td align="left">08C11</td>
<td align="left">Prestw-1409</td>
<td align="left">Etretinate</td>
<td align="left">Dermatology</td>
<td align="left">Antipsoriatic</td>
<td align="right">0.5098</td>
<td align="right">3.2523</td>
<td align="right">-3.2423</td>
<td align="right">-1.9743</td>
</tr>
<tr class="odd">
<td align="left">05F02</td>
<td align="left">Prestw-371</td>
<td align="left">Ketotifen fumarate</td>
<td align="left">Allergology</td>
<td align="left">Antihistaminic</td>
<td align="right">0.8370</td>
<td align="right">3.2313</td>
<td align="right">-3.2103</td>
<td align="right">-1.9476</td>
</tr>
<tr class="even">
<td align="left">05D10</td>
<td align="left">Prestw-359</td>
<td align="left">Dextromethorphan hydrobromide monohydrate</td>
<td align="left">Central Nervous System</td>
<td align="left">Antitussive</td>
<td align="right">0.8332</td>
<td align="right">3.2131</td>
<td align="right">-3.1827</td>
<td align="right">-1.9251</td>
</tr>
<tr class="odd">
<td align="left">18H11</td>
<td align="left">Prestw-2043</td>
<td align="left">Artenimol</td>
<td align="left">Infectiology</td>
<td align="left">Antimalarial ’Antipaludic</td>
<td align="right">1.0394</td>
<td align="right">3.2008</td>
<td align="right">-3.1642</td>
<td align="right">-1.9117</td>
</tr>
<tr class="even">
<td align="left">03H09</td>
<td align="left">Prestw-238</td>
<td align="left">Lomefloxacin hydrochloride</td>
<td align="left">Infectiology</td>
<td align="left">Antibacterial</td>
<td align="right">0.3996</td>
<td align="right">3.1324</td>
<td align="right">-3.0620</td>
<td align="right">-1.8146</td>
</tr>
<tr class="odd">
<td align="left">19E10</td>
<td align="left">Prestw-2052</td>
<td align="left">Dilevalol</td>
<td align="left">Cardiovascular</td>
<td align="left">Antihypertensive</td>
<td align="right">1.2767</td>
<td align="right">3.0795</td>
<td align="right">-2.9843</td>
<td align="right">-1.7440</td>
</tr>
<tr class="even">
<td align="left">19H04</td>
<td align="left">Prestw-1940</td>
<td align="left">Acetyl spiramycin</td>
<td align="left">Infectiology</td>
<td align="left">Antibacterial</td>
<td align="right">1.2760</td>
<td align="right">3.0774</td>
<td align="right">-2.9813</td>
<td align="right">-1.7440</td>
</tr>
<tr class="odd">
<td align="left">05F08</td>
<td align="left">Prestw-377</td>
<td align="left">Nafronyl oxalate</td>
<td align="left">Cardiovascular ’Neuromuscular</td>
<td align="left">Anti-ischemic ’Antispastic ’Vasodilator</td>
<td align="right">0.8036</td>
<td align="right">3.0714</td>
<td align="right">-2.9726</td>
<td align="right">-1.7401</td>
</tr>
<tr class="even">
<td align="left">12E07</td>
<td align="left">Prestw-926</td>
<td align="left">Idazoxan hydrochloride</td>
<td align="left">Central Nervous System</td>
<td align="left">Antiparkinsonian ’Antipsychotic</td>
<td align="right">1.1619</td>
<td align="right">3.0338</td>
<td align="right">-2.9182</td>
<td align="right">-1.6906</td>
</tr>
<tr class="odd">
<td align="left">06G05</td>
<td align="left">Prestw-1323</td>
<td align="left">Quetiapine hemifumarate</td>
<td align="left">Central Nervous System</td>
<td align="left">Antipsychotic</td>
<td align="right">0.5507</td>
<td align="right">3.0260</td>
<td align="right">-2.9069</td>
<td align="right">-1.6860</td>
</tr>
<tr class="even">
<td align="left">09A03</td>
<td align="left">Prestw-1270</td>
<td align="left">Gefitinib</td>
<td align="left">Oncology</td>
<td align="left">Antineoplastic</td>
<td align="right">0.2901</td>
<td align="right">3.0207</td>
<td align="right">-2.8994</td>
<td align="right">-1.6860</td>
</tr>
<tr class="odd">
<td align="left">16C10</td>
<td align="left">Prestw-1710</td>
<td align="left">Ethoxzolamide</td>
<td align="left">Ophthalmology ’Gastroenterology ’Central Nervous System</td>
<td align="left">Antiglaucoma ’Antiulcer ’Diuretic ’Antiepileptic</td>
<td align="right">2.0989</td>
<td align="right">3.0236</td>
<td align="right">-2.9034</td>
<td align="right">-1.6860</td>
</tr>
<tr class="even">
<td align="left">08B02</td>
<td align="left">Prestw-571</td>
<td align="left">Tetracaïne hydrochloride</td>
<td align="left">Neuromuscular</td>
<td align="left">NA</td>
<td align="right">0.4749</td>
<td align="right">3.0145</td>
<td align="right">-2.8904</td>
<td align="right">-1.6817</td>
</tr>
<tr class="odd">
<td align="left">11E02</td>
<td align="left">Prestw-1455</td>
<td align="left">Olanzapine</td>
<td align="left">Central Nervous System</td>
<td align="left">Antipsychotic</td>
<td align="right">1.1565</td>
<td align="right">2.9604</td>
<td align="right">-2.8136</td>
<td align="right">-1.6095</td>
</tr>
<tr class="even">
<td align="left">17D04</td>
<td align="left">Prestw-1857</td>
<td align="left">Oxiglutatione</td>
<td align="left">Ophthalmology</td>
<td align="left">Antidote</td>
<td align="right">1.2966</td>
<td align="right">2.9464</td>
<td align="right">-2.7939</td>
<td align="right">-1.5943</td>
</tr>
<tr class="odd">
<td align="left">19A03</td>
<td align="left">Prestw-2045</td>
<td align="left">Eletriptan</td>
<td align="left">Central Nervous System</td>
<td align="left">Antimigraine</td>
<td align="right">1.2273</td>
<td align="right">2.9383</td>
<td align="right">-2.7825</td>
<td align="right">-1.5875</td>
</tr>
<tr class="even">
<td align="left">03E08</td>
<td align="left">Prestw-1181</td>
<td align="left">Tibolone</td>
<td align="left">Endocrinology</td>
<td align="left">NA</td>
<td align="right">0.3794</td>
<td align="right">2.9300</td>
<td align="right">-2.7708</td>
<td align="right">-1.5802</td>
</tr>
<tr class="odd">
<td align="left">01G07</td>
<td align="left">Prestw-66</td>
<td align="left">Minaprine dihydrochloride</td>
<td align="left">Central Nervous System</td>
<td align="left">Anti-Alzheimer ’Antidepressant</td>
<td align="right">0.2144</td>
<td align="right">2.8893</td>
<td align="right">-2.7143</td>
<td align="right">-1.5281</td>
</tr>
<tr class="even">
<td align="left">02G11</td>
<td align="left">Prestw-150</td>
<td align="left">Dihydroergotamine tartrate</td>
<td align="left">Central Nervous System</td>
<td align="left">Antimigraine</td>
<td align="right">0.5699</td>
<td align="right">2.8555</td>
<td align="right">-2.6678</td>
<td align="right">-1.4860</td>
</tr>
<tr class="odd">
<td align="left">02F04</td>
<td align="left">Prestw-133</td>
<td align="left">Hydroxyzine dihydrochloride</td>
<td align="left">Allergology ’Central Nervous System</td>
<td align="left">Antiemetic ’Antihistaminic ’Antipruritic ’Anxiolytic ’Sedative</td>
<td align="right">0.5689</td>
<td align="right">2.8496</td>
<td align="right">-2.6598</td>
<td align="right">-1.4823</td>
</tr>
<tr class="even">
<td align="left">04H02</td>
<td align="left">Prestw-311</td>
<td align="left">Ifenprodil tartrate</td>
<td align="left">Cardiovascular</td>
<td align="left">Vasodilator</td>
<td align="right">1.1592</td>
<td align="right">2.8439</td>
<td align="right">-2.6521</td>
<td align="right">-1.4788</td>
</tr>
<tr class="odd">
<td align="left">03C03</td>
<td align="left">Prestw-182</td>
<td align="left">Levamisole hydrochloride</td>
<td align="left">Immunology ’Infectiology</td>
<td align="left">Antihelmintic ’Immunomodulator</td>
<td align="right">0.3696</td>
<td align="right">2.8321</td>
<td align="right">-2.6359</td>
<td align="right">-1.4669</td>
</tr>
<tr class="even">
<td align="left">04C06</td>
<td align="left">Prestw-265</td>
<td align="left">Dimenhydrinate</td>
<td align="left">Allergology ’Central Nervous System</td>
<td align="left">Antiemetic ’Antihistaminic ’Antivertigo</td>
<td align="right">1.1534</td>
<td align="right">2.8273</td>
<td align="right">-2.6294</td>
<td align="right">-1.4646</td>
</tr>
<tr class="odd">
<td align="left">18D06</td>
<td align="left">Prestw-2008</td>
<td align="left">Azaribine</td>
<td align="left">Oncology ’Dermatology</td>
<td align="left">Antineoplastic ’Antipsoriatic</td>
<td align="right">0.9419</td>
<td align="right">2.8168</td>
<td align="right">-2.6152</td>
<td align="right">-1.4545</td>
</tr>
<tr class="even">
<td align="left">06C11</td>
<td align="left">Prestw-430</td>
<td align="left">Cisapride</td>
<td align="left">Gastroenterology</td>
<td align="left">Gastroprokinetic</td>
<td align="right">0.5097</td>
<td align="right">2.7822</td>
<td align="right">-2.5687</td>
<td align="right">-1.4122</td>
</tr>
<tr class="odd">
<td align="left">19F05</td>
<td align="left">Prestw-2019</td>
<td align="left">Vonoprazan</td>
<td align="left">Gastroenterology</td>
<td align="left">Antiulcer</td>
<td align="right">1.1711</td>
<td align="right">2.7779</td>
<td align="right">-2.5630</td>
<td align="right">-1.4106</td>
</tr>
<tr class="even">
<td align="left">01G04</td>
<td align="left">Prestw-63</td>
<td align="left">Nifedipine</td>
<td align="left">Cardiovascular</td>
<td align="left">Antianginal ’Antihypertensive ’Vasodilator</td>
<td align="right">0.2063</td>
<td align="right">2.7696</td>
<td align="right">-2.5518</td>
<td align="right">-1.4034</td>
</tr>
<tr class="odd">
<td align="left">08H05</td>
<td align="left">Prestw-1463</td>
<td align="left">Tomoxetine hydrochloride</td>
<td align="left">Central Nervous System</td>
<td align="left">CNS Stimulant</td>
<td align="right">0.4373</td>
<td align="right">2.7576</td>
<td align="right">-2.5359</td>
<td align="right">-1.3914</td>
</tr>
<tr class="even">
<td align="left">19D11</td>
<td align="left">Prestw-2067</td>
<td align="left">Cyclofenil</td>
<td align="left">Endocrinology</td>
<td align="left">anti-estrogen</td>
<td align="right">1.1620</td>
<td align="right">2.7520</td>
<td align="right">-2.5284</td>
<td align="right">-1.3880</td>
</tr>
<tr class="odd">
<td align="left">04C05</td>
<td align="left">Prestw-264</td>
<td align="left">Dyclonine hydrochloride</td>
<td align="left">Neuromuscular</td>
<td align="left">Local anesthetic</td>
<td align="right">1.1193</td>
<td align="right">2.7301</td>
<td align="right">-2.4996</td>
<td align="right">-1.3631</td>
</tr>
<tr class="even">
<td align="left">09H08</td>
<td align="left">Prestw-717</td>
<td align="left">Finasteride</td>
<td align="left">Endocrinology</td>
<td align="left">Anti-alopecia ’Antineoplastic</td>
<td align="right">0.2658</td>
<td align="right">2.7245</td>
<td align="right">-2.4921</td>
<td align="right">-1.3595</td>
</tr>
<tr class="odd">
<td align="left">08E05</td>
<td align="left">Prestw-1252</td>
<td align="left">Butenafine hydrochloride</td>
<td align="left">Infectiology ’Metabolism</td>
<td align="left">Antifungal</td>
<td align="right">0.4285</td>
<td align="right">2.6975</td>
<td align="right">-2.4568</td>
<td align="right">-1.3280</td>
</tr>
<tr class="even">
<td align="left">18B06</td>
<td align="left">Prestw-1945</td>
<td align="left">Exifone</td>
<td align="left">Central Nervous System</td>
<td align="left">CNS Stimulant ’Nootropic</td>
<td align="right">0.9092</td>
<td align="right">2.6882</td>
<td align="right">-2.4446</td>
<td align="right">-1.3197</td>
</tr>
</tbody>
</table>
</div>
<div id="conclusions" class="section level2">
<h2>Conclusions</h2>
<ul>
<li><p>The analysis strongly suggests a batch effect: the distribution of viability measures show strong inter-plate differences. In particular, the viability measures of plates 11 to 19 are spread over the whole range from the virus control to the cell control.</p></li>
<li><p>To select candidate molecules, the fact to set a plate-wise threshold based on the mean viability of the arbidol duplicates might lead to ignore highly interesting candidates.</p></li>
<li><p>I propose here a plate-wise standardisation based on the median (for centering) and inter-quartile range (to standardise the dispersion).</p></li>
<li><p>This enables to compute a p-value (expected rate of false positive among all the tested molecules). This nominal p-value has to be corrected for multiple testing, in order to estimate the False Discovery Rate (FDR,i.e. the expected rate of false positives among the molecules declared positive). With a threshold of 0.05 on the FDR, 114 molecules are declared significant and could be considered as candidate for further characterization.</p></li>
</ul>
<hr />
</div>
</div>
<div id="libraries-and-versions" class="section level1">
<h1>Libraries and versions</h1>
<p>For the sake of reproducibility, we list hereafter the R libraries used to generate this report, as well as their versions.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" data-line-number="1"><span class="kw">sessionInfo</span>()</a></code></pre></div>
<pre><code>R version 3.6.1 (2019-07-05)
Platform: x86_64-apple-darwin15.6.0 (64-bit)
Running under: macOS Mojave 10.14.6

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRblas.0.dylib
LAPACK: /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRlapack.dylib

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] vioplot_0.3.4       zoo_1.8-7           sm_2.2-5.6          fitdistrplus_1.0-14 npsurv_0.4-0        lsei_1.2-0          survival_3.1-11     MASS_7.3-51.5       knitr_1.28          readxl_1.3.1        xlsx_0.6.3         

loaded via a namespace (and not attached):
 [1] Rcpp_1.0.4       highr_0.8        pillar_1.4.3     cellranger_1.1.0 compiler_3.6.1   tools_3.6.1      digest_0.6.25    evaluate_0.14    tibble_3.0.0     lifecycle_0.2.0  lattice_0.20-40  pkgconfig_2.0.3  rlang_0.4.5      Matrix_1.2-18    cli_2.0.2        yaml_2.2.1       xfun_0.12       
[18] rJava_0.9-12     stringr_1.4.0    vctrs_0.2.4      xlsxjars_0.6.1   grid_3.6.1       glue_1.3.2       rematch_1.0.1    fansi_0.4.1      tcltk_3.6.1      rmarkdown_2.1    magrittr_1.5     htmltools_0.4.0  ellipsis_0.3.0   splines_3.6.1    assertthat_0.2.1 stringi_1.4.6    crayon_1.3.4    </code></pre>
<hr />
<div id="experimental-design" class="section level2">
<h2>Experimental design</h2>
<ul>
<li><p>la manip consiste à faire un test colorimétrique</p>
<ul>
<li>sur certains puits tout est négatif, sur d’autres tout est positiv</li>
</ul></li>
<li><p>mortalité des cellules</p>
<ul>
<li>infectées non-traitées (“virus control”)</li>
<li>6 puits</li>
</ul></li>
<li><p>viabilité des cellules -&gt; 100%</p>
<ul>
<li>cellules non-infectées et non-traitées (“cell control”)</li>
<li>8 puits</li>
</ul></li>
<li><p>duplicat de traitement à l’arabidol 10µM</p>
<ul>
<li>seuil par plaque</li>
<li>contrôle interne de la protection des cellules contre la mortalité viro-induite</li>
</ul></li>
<li><p>Valeurs de départ</p>
<ul>
<li>mort cellulaire (moyenne sur 6 puits)</li>
<li>viabilité (moyenne sur 8 puits)</li>
<li>valeur du composé (monoplicat) : même concentration de 10µM par composé</li>
</ul></li>
</ul>
<p>Indice d’inhibition:</p>
<p><span class="math display">\[V = A / (D + A)\]</span></p>
<p><span class="math display">\[II = \]</span></p>
<p>On cherche des molécules inhibitrices avec l’EC50 aux alentours de 5µM -&gt; la concentration standard de 10µM on espère se trouver au début du plateau.</p>
</div>
<div id="a-faire" class="section level2">
<h2>A faire</h2>
<ul>
<li>comparer les listes de composés avant / après normalization par plaque</li>
<li>boxplot ou violin par plaque avant / après</li>
<li>standardization des valeurs de viabilité par la médiane</li>
<li><p>distribution de valeurs plaque par plaque –&gt; vérifier si certaines plaques ont l’air d’avoir plus de 20 cibles (percentile75)</p></li>
<li>Contrôles intra-plaques
<ul>
<li>utiliser médiane plutôt que moyenne ?</li>
</ul></li>
<li><p>Valeurs négatives:</p>
<ul>
<li>fluctuations expérimentales ?</li>
<li>mortalité induite par le virus + la molécule ?</li>
</ul></li>
<li><p>Marquer sur les graphiques les valeurs de l’arbidol (contrôle interne en duplicat)</p></li>
<li><p>boxplot des contrôles par plaque:</p>
<ul>
<li>cell viability</li>
<li>viral</li>
</ul></li>
</ul>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
