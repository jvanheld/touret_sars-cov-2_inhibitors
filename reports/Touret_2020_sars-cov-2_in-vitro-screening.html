<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Franck Touret, Magali Gilles, Karine Barral, Antoine Nougaire, Etienne Decroly, Xavier de Lamballerie, and Bruno Coutard (2020). Statistical analysis by Jacques van Helden." />

<meta name="date" content="2020-04-17" />

<title>Statistical analysis of in vitro screening for inhibitors of viral infection</title>

<script src="Touret_2020_sars-cov-2_in-vitro-screening_files/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="Touret_2020_sars-cov-2_in-vitro-screening_files/bootstrap-3.3.5/css/cerulean.min.css" rel="stylesheet" />
<script src="Touret_2020_sars-cov-2_in-vitro-screening_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="Touret_2020_sars-cov-2_in-vitro-screening_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="Touret_2020_sars-cov-2_in-vitro-screening_files/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="Touret_2020_sars-cov-2_in-vitro-screening_files/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="Touret_2020_sars-cov-2_in-vitro-screening_files/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="Touret_2020_sars-cov-2_in-vitro-screening_files/tocify-1.9.1/jquery.tocify.js"></script>
<script src="Touret_2020_sars-cov-2_in-vitro-screening_files/navigation-1.1/tabsets.js"></script>
<script src="Touret_2020_sars-cov-2_in-vitro-screening_files/navigation-1.1/codefolding.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  { color: #cccccc; background-color: #303030; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ffcfaf; } /* Alert */
code span.an { color: #7f9f7f; font-weight: bold; } /* Annotation */
code span.at { } /* Attribute */
code span.bn { color: #dca3a3; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #f0dfaf; } /* ControlFlow */
code span.ch { color: #dca3a3; } /* Char */
code span.cn { color: #dca3a3; font-weight: bold; } /* Constant */
code span.co { color: #7f9f7f; } /* Comment */
code span.cv { color: #7f9f7f; font-weight: bold; } /* CommentVar */
code span.do { color: #7f9f7f; } /* Documentation */
code span.dt { color: #dfdfbf; } /* DataType */
code span.dv { color: #dcdccc; } /* DecVal */
code span.er { color: #c3bf9f; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #c0bed1; } /* Float */
code span.fu { color: #efef8f; } /* Function */
code span.im { } /* Import */
code span.in { color: #7f9f7f; font-weight: bold; } /* Information */
code span.kw { color: #f0dfaf; } /* Keyword */
code span.op { color: #f0efd0; } /* Operator */
code span.ot { color: #efef8f; } /* Other */
code span.pp { color: #ffcfaf; font-weight: bold; } /* Preprocessor */
code span.sc { color: #dca3a3; } /* SpecialChar */
code span.ss { color: #cc9393; } /* SpecialString */
code span.st { color: #cc9393; } /* String */
code span.va { } /* Variable */
code span.vs { color: #cc9393; } /* VerbatimString */
code span.wa { color: #7f9f7f; font-weight: bold; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Statistical analysis of <em>in vitro</em> screening for inhibitors of viral infection</h1>
<h3 class="subtitle">Normalization and target selection methods</h3>
<h4 class="author">Franck Touret, Magali Gilles, Karine Barral, Antoine Nougaire, Etienne Decroly, Xavier de Lamballerie, and Bruno Coutard (2020). Statistical analysis by Jacques van Helden.</h4>
<h4 class="date">2020-04-17</h4>

</div>


<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co">#### Parameters ####</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="co">## Significance threshold</span></a>
<a class="sourceLine" id="cb1-4" data-line-number="4">alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"></a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="co">## Highlight colors</span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7">markColor &lt;-<span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb1-8" data-line-number="8">  <span class="dt">cellCtl =</span> <span class="st">&quot;grey&quot;</span>,</a>
<a class="sourceLine" id="cb1-9" data-line-number="9">  <span class="dt">virusCtl =</span> <span class="st">&quot;red&quot;</span>,</a>
<a class="sourceLine" id="cb1-10" data-line-number="10">  <span class="dt">treated =</span> <span class="st">&quot;blue&quot;</span>,</a>
<a class="sourceLine" id="cb1-11" data-line-number="11">  <span class="dt">Arbidol =</span> <span class="st">&quot;black&quot;</span>,</a>
<a class="sourceLine" id="cb1-12" data-line-number="12">  <span class="dt">Hydroxychloroquine =</span> <span class="st">&quot;orange&quot;</span></a>
<a class="sourceLine" id="cb1-13" data-line-number="13">)</a>
<a class="sourceLine" id="cb1-14" data-line-number="14"></a>
<a class="sourceLine" id="cb1-15" data-line-number="15"><span class="co">## Highlight point shaapes</span></a>
<a class="sourceLine" id="cb1-16" data-line-number="16">markPCh &lt;-<span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb1-17" data-line-number="17">  <span class="dt">cellCtl =</span> <span class="dv">5</span>,</a>
<a class="sourceLine" id="cb1-18" data-line-number="18">  <span class="dt">virusCtl =</span> <span class="dv">17</span>,</a>
<a class="sourceLine" id="cb1-19" data-line-number="19">  <span class="dt">treated =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb1-20" data-line-number="20">  <span class="dt">Arbidol =</span> <span class="dv">19</span>,</a>
<a class="sourceLine" id="cb1-21" data-line-number="21">  <span class="dt">Hydroxychloroquine =</span> <span class="dv">13</span></a>
<a class="sourceLine" id="cb1-22" data-line-number="22">)</a></code></pre></div>
<hr />
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>This document describes in detail the procedure used to select molecules having a potential inhibitory effect on the infection of cultured cells by covid-19.</p>
<p><strong>Pre-publication in bioRxiv:</strong></p>
<ul>
<li>In vitro screening of a FDA approved chemical library reveals potential inhibitors of SARS-CoV-2 replication. Franck Touret, Magali Gilles, Karine Barral, Antoine Nougairede, Etienne Decroly, Xavier de Lamballerie, Bruno Coutard. bioRxiv 2020.04.03.023846. <a href="https://doi.org/10.1101/2020.04.03.023846">DOI 10.1101/2020.04.03.023846</a></li>
</ul>
<hr />
</div>
<div id="data" class="section level1">
<h1>Data</h1>
<div id="sources" class="section level2">
<h2>Sources</h2>
<table>
<colgroup>
<col width="33%" />
<col width="66%" />
</colgroup>
<thead>
<tr class="header">
<th>Doc</th>
<th>URL</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>bioRxiv article</td>
<td><a href="https://www.biorxiv.org/content/10.1101/2020.04.03.023846v1" class="uri">https://www.biorxiv.org/content/10.1101/2020.04.03.023846v1</a></td>
</tr>
<tr class="even">
<td>Supplementary tables</td>
<td><a href="https://www.biorxiv.org/content/biorxiv/early/2020/04/05/2020.04.03.023846/DC1/embed/media-1.xlsx?download=true" class="uri">https://www.biorxiv.org/content/biorxiv/early/2020/04/05/2020.04.03.023846/DC1/embed/media-1.xlsx?download=true</a></td>
</tr>
</tbody>
</table>
</div>
<div id="supplementary-data-tables" class="section level2">
<h2>Supplementary data tables</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co">#### Directories ####</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="kw">message</span>(<span class="st">&quot;Directories and files&quot;</span>)</a>
<a class="sourceLine" id="cb2-3" data-line-number="3"></a>
<a class="sourceLine" id="cb2-4" data-line-number="4">dir &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">data =</span> <span class="st">&quot;../data&quot;</span>, </a>
<a class="sourceLine" id="cb2-5" data-line-number="5">         <span class="dt">results =</span> <span class="st">&quot;../results&quot;</span>,</a>
<a class="sourceLine" id="cb2-6" data-line-number="6">         <span class="dt">figures =</span> <span class="st">&quot;figures&quot;</span>)</a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="kw">dir.create</span>(dir[<span class="st">&quot;results&quot;</span>], <span class="dt">showWarnings =</span> <span class="ot">FALSE</span>, <span class="dt">recursive =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb2-8" data-line-number="8"></a>
<a class="sourceLine" id="cb2-9" data-line-number="9"><span class="co">## Data file</span></a>
<a class="sourceLine" id="cb2-10" data-line-number="10">supTableFile &lt;-<span class="st"> </span><span class="kw">file.path</span>(dir[<span class="st">&quot;data&quot;</span>], <span class="st">&quot;suppl-table_Touret-2020.xlsx&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="co">#### Load data from Excel workbook ####</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="kw">message</span>(<span class="st">&quot;Loading data from excel workbook.&quot;</span>)</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">supTable &lt;-<span class="st"> </span><span class="kw">read.xlsx</span>(<span class="dt">file =</span> supTableFile, <span class="dt">sheetIndex =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="co">#supTable &lt;- read_xlsx(path = supTableFile, sheet = 1, col_names = TRUE)</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="co"># dim(supTable)</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="co"># View(supTable)</span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="co"># names(supTable)</span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8"></a>
<a class="sourceLine" id="cb3-9" data-line-number="9">colNames &lt;-<span class="st"> </span><span class="kw">colnames</span>(supTable)</a>
<a class="sourceLine" id="cb3-10" data-line-number="10">colNames[<span class="dv">1</span>] &lt;-<span class="st"> &quot;ID&quot;</span></a>
<a class="sourceLine" id="cb3-11" data-line-number="11"><span class="kw">colnames</span>(supTable) &lt;-<span class="st"> </span>colNames</a>
<a class="sourceLine" id="cb3-12" data-line-number="12"></a>
<a class="sourceLine" id="cb3-13" data-line-number="13"><span class="co">## Suppress the last row (NA)</span></a>
<a class="sourceLine" id="cb3-14" data-line-number="14">supTable &lt;-<span class="st"> </span>supTable[<span class="op">!</span><span class="kw">is.na</span>(supTable<span class="op">$</span>ID), ]</a>
<a class="sourceLine" id="cb3-15" data-line-number="15"><span class="co"># dim(supTable)</span></a>
<a class="sourceLine" id="cb3-16" data-line-number="16"></a>
<a class="sourceLine" id="cb3-17" data-line-number="17"><span class="co">## Assign row names for convenience</span></a>
<a class="sourceLine" id="cb3-18" data-line-number="18"><span class="co"># View(supTable)</span></a>
<a class="sourceLine" id="cb3-19" data-line-number="19"></a>
<a class="sourceLine" id="cb3-20" data-line-number="20"></a>
<a class="sourceLine" id="cb3-21" data-line-number="21"><span class="co">## Extract plate number</span></a>
<a class="sourceLine" id="cb3-22" data-line-number="22">supTable<span class="op">$</span>plateNumber &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">substr</span>(supTable[, <span class="dv">1</span>], <span class="dt">start =</span> <span class="dv">1</span>, <span class="dt">stop =</span> <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb3-23" data-line-number="23"><span class="co"># table(supTable$plateNumber)</span></a>
<a class="sourceLine" id="cb3-24" data-line-number="24">plateNumbers &lt;-<span class="st"> </span><span class="kw">unique</span>(supTable<span class="op">$</span>plateNumber)</a>
<a class="sourceLine" id="cb3-25" data-line-number="25"></a>
<a class="sourceLine" id="cb3-26" data-line-number="26"><span class="co">## Assign a color to each molecule according to its plate number</span></a>
<a class="sourceLine" id="cb3-27" data-line-number="27">plateColor &lt;-<span class="st"> </span><span class="kw">rainbow</span>(<span class="dt">n =</span> <span class="kw">length</span>(plateNumbers))</a>
<a class="sourceLine" id="cb3-28" data-line-number="28"><span class="kw">names</span>(plateColor) &lt;-<span class="st"> </span><span class="kw">unique</span>(supTable<span class="op">$</span>plateNumber)</a>
<a class="sourceLine" id="cb3-29" data-line-number="29"></a>
<a class="sourceLine" id="cb3-30" data-line-number="30">supTable<span class="op">$</span>color &lt;-<span class="st"> </span>plateColor[supTable<span class="op">$</span>plateNumber]</a>
<a class="sourceLine" id="cb3-31" data-line-number="31"><span class="kw">message</span>(<span class="st">&quot;</span><span class="ch">\t</span><span class="st">Loaded main table with &quot;</span>, <span class="kw">nrow</span>(supTable), <span class="st">&quot; rows &quot;</span>)</a></code></pre></div>
<p>The supplementary table downloaded from bioRxiv contains 1520 molecules.</p>
<hr />
</div>
</div>
<div id="viability-measurements" class="section level1">
<h1>Viability measurements</h1>
<div id="cell-titer-blue-intensity-ctb" class="section level2">
<h2>Cell Titer Blue intensity (CTB)</h2>
<p>The number of viable cells per well is measured by a colorimetric test. The primary measure is the <strong>Cell Titer Blue intensity</strong> (<span class="math inline">\(CTB\)</span>).</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="co">#### Read the CTB values from the Excel workbook ####</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="kw">message</span>(<span class="st">&quot;Reading Cell Titer Blue (CTB) values from file &quot;</span>, supTableFile)</a>
<a class="sourceLine" id="cb4-3" data-line-number="3">nbPlates &lt;-<span class="st"> </span><span class="dv">19</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4">rowsPerPlate &lt;-<span class="st"> </span><span class="dv">8</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5">columnsPerPlate &lt;-<span class="st"> </span><span class="dv">12</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"></a>
<a class="sourceLine" id="cb4-7" data-line-number="7">dataPerPlate &lt;-<span class="st"> </span><span class="kw">list</span>()</a>
<a class="sourceLine" id="cb4-8" data-line-number="8"></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="co">## Control 1: uninfected cells</span></a>
<a class="sourceLine" id="cb4-10" data-line-number="10">cellControl &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">matrix</span>(<span class="dt">ncol =</span> <span class="dv">8</span>, <span class="dt">nrow =</span> nbPlates))</a>
<a class="sourceLine" id="cb4-11" data-line-number="11"><span class="kw">colnames</span>(cellControl) &lt;-<span class="st"> </span>LETTERS[<span class="dv">1</span><span class="op">:</span>rowsPerPlate]</a>
<a class="sourceLine" id="cb4-12" data-line-number="12"></a>
<a class="sourceLine" id="cb4-13" data-line-number="13"><span class="co">## Control 2: untreated infected cells</span></a>
<a class="sourceLine" id="cb4-14" data-line-number="14">virusControl &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">matrix</span>(<span class="dt">ncol =</span> <span class="dv">6</span>, <span class="dt">nrow =</span> nbPlates))</a>
<a class="sourceLine" id="cb4-15" data-line-number="15"><span class="kw">colnames</span>(virusControl) &lt;-<span class="st"> </span>LETTERS[<span class="dv">3</span><span class="op">:</span>rowsPerPlate]</a>
<a class="sourceLine" id="cb4-16" data-line-number="16"></a>
<a class="sourceLine" id="cb4-17" data-line-number="17"><span class="co">## Prepare a table to store the raw data</span></a>
<a class="sourceLine" id="cb4-18" data-line-number="18">inhibTable &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">matrix</span>(<span class="dt">ncol =</span> <span class="dv">8</span>, <span class="dt">nrow =</span> nbPlates<span class="op">*</span>rowsPerPlate <span class="op">*</span><span class="st"> </span>columnsPerPlate))</a>
<a class="sourceLine" id="cb4-19" data-line-number="19"><span class="kw">colnames</span>(inhibTable) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;ID&quot;</span>, </a>
<a class="sourceLine" id="cb4-20" data-line-number="20">                          <span class="st">&quot;Plate&quot;</span>, </a>
<a class="sourceLine" id="cb4-21" data-line-number="21">                          <span class="st">&quot;Row&quot;</span>, </a>
<a class="sourceLine" id="cb4-22" data-line-number="22">                          <span class="st">&quot;Column&quot;</span>, </a>
<a class="sourceLine" id="cb4-23" data-line-number="23">                          <span class="st">&quot;CTB&quot;</span>, </a>
<a class="sourceLine" id="cb4-24" data-line-number="24">                          <span class="st">&quot;cellControl&quot;</span>, </a>
<a class="sourceLine" id="cb4-25" data-line-number="25">                          <span class="st">&quot;virusControl&quot;</span>,</a>
<a class="sourceLine" id="cb4-26" data-line-number="26">                          <span class="st">&quot;Chemical.name&quot;</span>)</a>
<a class="sourceLine" id="cb4-27" data-line-number="27"></a>
<a class="sourceLine" id="cb4-28" data-line-number="28">i &lt;-<span class="st"> </span><span class="dv">2</span> <span class="co">## for quick test</span></a>
<a class="sourceLine" id="cb4-29" data-line-number="29"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>nbPlates) {</a>
<a class="sourceLine" id="cb4-30" data-line-number="30">  <span class="kw">message</span>(<span class="st">&quot;</span><span class="ch">\t</span><span class="st">Loading data from plate &quot;</span>, i)</a>
<a class="sourceLine" id="cb4-31" data-line-number="31">  sheetName &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;Plate&quot;</span>, i)</a>
<a class="sourceLine" id="cb4-32" data-line-number="32">  </a>
<a class="sourceLine" id="cb4-33" data-line-number="33">  <span class="co">## Raw measures</span></a>
<a class="sourceLine" id="cb4-34" data-line-number="34">  <span class="co"># rawMeasures &lt;- read.xlsx(file = supTableFile, </span></a>
<a class="sourceLine" id="cb4-35" data-line-number="35">  <span class="co">#                          sheetName = sheetName, </span></a>
<a class="sourceLine" id="cb4-36" data-line-number="36">  <span class="co">#                          rowIndex = 30:37,</span></a>
<a class="sourceLine" id="cb4-37" data-line-number="37">  <span class="co">#                          colIndex = 2:13, header = FALSE)</span></a>
<a class="sourceLine" id="cb4-38" data-line-number="38">  rawMeasures &lt;-<span class="st"> </span><span class="kw">read_xlsx</span>(<span class="dt">path =</span> supTableFile, <span class="dt">col_names =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb4-39" data-line-number="39">                           <span class="dt">sheet =</span> sheetName, </a>
<a class="sourceLine" id="cb4-40" data-line-number="40">                           <span class="dt">range =</span> <span class="st">&quot;B30:M37&quot;</span>, <span class="dt">progress =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb4-41" data-line-number="41">  rawMeasures &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(rawMeasures)</a>
<a class="sourceLine" id="cb4-42" data-line-number="42">  <span class="kw">rownames</span>(rawMeasures) &lt;-<span class="st"> </span>LETTERS[<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(rawMeasures)]</a>
<a class="sourceLine" id="cb4-43" data-line-number="43">  <span class="kw">colnames</span>(rawMeasures) &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(rawMeasures)</a>
<a class="sourceLine" id="cb4-44" data-line-number="44">  <span class="co"># dim(rawMeasures)</span></a>
<a class="sourceLine" id="cb4-45" data-line-number="45">  <span class="co"># View(rawMeasures)</span></a>
<a class="sourceLine" id="cb4-46" data-line-number="46"></a>
<a class="sourceLine" id="cb4-47" data-line-number="47">  <span class="co">## Extract control values</span></a>
<a class="sourceLine" id="cb4-48" data-line-number="48">  cellControl[i, ] &lt;-<span class="st"> </span><span class="kw">as.vector</span>(rawMeasures[,<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb4-49" data-line-number="49">  virusControl[i, ] &lt;-<span class="st"> </span><span class="kw">as.vector</span>(rawMeasures[<span class="dv">3</span><span class="op">:</span><span class="dv">8</span>,<span class="dv">12</span>])</a>
<a class="sourceLine" id="cb4-50" data-line-number="50">  platevc &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">unlist</span>(virusControl[i, ]))</a>
<a class="sourceLine" id="cb4-51" data-line-number="51">  platecc &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">unlist</span>(cellControl[i, ]))</a>
<a class="sourceLine" id="cb4-52" data-line-number="52"></a>
<a class="sourceLine" id="cb4-53" data-line-number="53">  <span class="co">## Extract all values</span></a>
<a class="sourceLine" id="cb4-54" data-line-number="54">  r &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb4-55" data-line-number="55">  <span class="cf">for</span> (r <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>rowsPerPlate) {</a>
<a class="sourceLine" id="cb4-56" data-line-number="56">    currentRowName &lt;-<span class="st"> </span>LETTERS[r]</a>
<a class="sourceLine" id="cb4-57" data-line-number="57">    currentValues &lt;-<span class="st"> </span><span class="kw">unlist</span>(rawMeasures[currentRowName,])</a>
<a class="sourceLine" id="cb4-58" data-line-number="58">    id &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">sprintf</span>(<span class="st">&quot;%02d&quot;</span>,i),</a>
<a class="sourceLine" id="cb4-59" data-line-number="59">                 currentRowName, </a>
<a class="sourceLine" id="cb4-60" data-line-number="60">                 <span class="kw">sprintf</span>(<span class="st">&quot;%02d&quot;</span>,<span class="dv">1</span><span class="op">:</span>columnsPerPlate))</a>
<a class="sourceLine" id="cb4-61" data-line-number="61">    </a>
<a class="sourceLine" id="cb4-62" data-line-number="62">    <span class="co">## Compute the start index for the data table</span></a>
<a class="sourceLine" id="cb4-63" data-line-number="63">    startIndex &lt;-<span class="st"> </span>(i <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>(rowsPerPlate <span class="op">*</span><span class="st"> </span>columnsPerPlate) <span class="op">+</span><span class="st"> </span>(r <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>columnsPerPlate <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb4-64" data-line-number="64">    <span class="co"># message(cat(&quot;\t\tIDs\t&quot;,  startIndex, id))</span></a>
<a class="sourceLine" id="cb4-65" data-line-number="65">    indices &lt;-<span class="st"> </span>startIndex<span class="op">:</span>(startIndex <span class="op">+</span><span class="st"> </span>columnsPerPlate <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb4-66" data-line-number="66">    <span class="co"># length(indices)</span></a>
<a class="sourceLine" id="cb4-67" data-line-number="67">    inhibTable[indices, <span class="st">&quot;ID&quot;</span>] &lt;-<span class="st"> </span>id</a>
<a class="sourceLine" id="cb4-68" data-line-number="68">    inhibTable[indices, <span class="st">&quot;Plate&quot;</span>] &lt;-<span class="st"> </span>i</a>
<a class="sourceLine" id="cb4-69" data-line-number="69">    inhibTable[indices, <span class="st">&quot;Row&quot;</span>] &lt;-<span class="st"> </span>currentRowName</a>
<a class="sourceLine" id="cb4-70" data-line-number="70">    inhibTable[indices, <span class="st">&quot;Column&quot;</span>] &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span>columnsPerPlate</a>
<a class="sourceLine" id="cb4-71" data-line-number="71">    inhibTable[indices, <span class="st">&quot;CTB&quot;</span>] &lt;-<span class="st"> </span>currentValues</a>
<a class="sourceLine" id="cb4-72" data-line-number="72">    inhibTable[indices, <span class="st">&quot;virusControl&quot;</span>] &lt;-<span class="st"> </span>platevc</a>
<a class="sourceLine" id="cb4-73" data-line-number="73">    inhibTable[indices, <span class="st">&quot;cellControl&quot;</span>] &lt;-<span class="st"> </span>platecc</a>
<a class="sourceLine" id="cb4-74" data-line-number="74">  }</a>
<a class="sourceLine" id="cb4-75" data-line-number="75">  </a>
<a class="sourceLine" id="cb4-76" data-line-number="76">  dataPerPlate[[i]] &lt;-<span class="st"> </span><span class="kw">list</span>()</a>
<a class="sourceLine" id="cb4-77" data-line-number="77">  dataPerPlate[[i]][[<span class="st">&quot;rawMeasures&quot;</span>]] &lt;-<span class="st"> </span>rawMeasures</a>
<a class="sourceLine" id="cb4-78" data-line-number="78">}</a>
<a class="sourceLine" id="cb4-79" data-line-number="79"></a>
<a class="sourceLine" id="cb4-80" data-line-number="80"><span class="co"># dim(inhibTable)</span></a>
<a class="sourceLine" id="cb4-81" data-line-number="81"><span class="co"># names(inhibTable)</span></a>
<a class="sourceLine" id="cb4-82" data-line-number="82"><span class="co"># View(inhibTable)</span></a>
<a class="sourceLine" id="cb4-83" data-line-number="83"><span class="co"># View(dataPerPlate)</span></a>
<a class="sourceLine" id="cb4-84" data-line-number="84"><span class="co"># View(dataPerPlate[[1]][[&quot;rawMeasures&quot;]])</span></a>
<a class="sourceLine" id="cb4-85" data-line-number="85"><span class="co"># table(inhibTable$Row, inhibTable$Column) ## Check that there are 19 entries for each plate position</span></a>
<a class="sourceLine" id="cb4-86" data-line-number="86"></a>
<a class="sourceLine" id="cb4-87" data-line-number="87"><span class="co">## Use the plate well ID as rowname</span></a>
<a class="sourceLine" id="cb4-88" data-line-number="88"><span class="kw">rownames</span>(inhibTable) &lt;-<span class="st"> </span>inhibTable<span class="op">$</span>ID</a>
<a class="sourceLine" id="cb4-89" data-line-number="89"></a>
<a class="sourceLine" id="cb4-90" data-line-number="90"><span class="co">## Check consistency between IDs in supplementary Touret Table 1</span></a>
<a class="sourceLine" id="cb4-91" data-line-number="91"><span class="co">##  and those created here</span></a>
<a class="sourceLine" id="cb4-92" data-line-number="92">touretIDs &lt;-<span class="st"> </span><span class="kw">unlist</span>(supTable<span class="op">$</span>ID)</a>
<a class="sourceLine" id="cb4-93" data-line-number="93"><span class="co"># length(touretIDs)</span></a>
<a class="sourceLine" id="cb4-94" data-line-number="94">inhibIDs &lt;-<span class="st"> </span>inhibTable<span class="op">$</span>ID</a>
<a class="sourceLine" id="cb4-95" data-line-number="95"><span class="co"># length(inhibIDs)</span></a>
<a class="sourceLine" id="cb4-96" data-line-number="96"></a>
<a class="sourceLine" id="cb4-97" data-line-number="97"><span class="co">## Cell control: uninfected cells</span></a>
<a class="sourceLine" id="cb4-98" data-line-number="98">cellControlIndices &lt;-<span class="st"> </span>inhibTable<span class="op">$</span>Column <span class="op">==</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb4-99" data-line-number="99">inhibTable[cellControlIndices, <span class="st">&quot;Chemical.name&quot;</span>] &lt;-<span class="st"> &quot;uninfected&quot;</span></a>
<a class="sourceLine" id="cb4-100" data-line-number="100"></a>
<a class="sourceLine" id="cb4-101" data-line-number="101"><span class="co">## Virus control: infected cells, no treatment</span></a>
<a class="sourceLine" id="cb4-102" data-line-number="102">virusControlIndices &lt;-<span class="st"> </span>(inhibTable<span class="op">$</span>Column <span class="op">==</span><span class="st"> </span><span class="dv">12</span>) <span class="op">&amp;</span><span class="st"> </span>(inhibTable<span class="op">$</span>Row <span class="op">%in%</span><span class="st"> </span>LETTERS[<span class="dv">3</span><span class="op">:</span><span class="dv">8</span>])</a>
<a class="sourceLine" id="cb4-103" data-line-number="103"><span class="co"># table(virusControlIndices)</span></a>
<a class="sourceLine" id="cb4-104" data-line-number="104">inhibTable[virusControlIndices, <span class="st">&quot;Chemical.name&quot;</span>] &lt;-<span class="st"> &quot;infected no treatment&quot;</span></a>
<a class="sourceLine" id="cb4-105" data-line-number="105"></a>
<a class="sourceLine" id="cb4-106" data-line-number="106"><span class="co">## Define the treatment type</span></a>
<a class="sourceLine" id="cb4-107" data-line-number="107">wellType &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb4-108" data-line-number="108">wellType[cellControlIndices] &lt;-<span class="st"> &quot;cellCtl&quot;</span></a>
<a class="sourceLine" id="cb4-109" data-line-number="109">wellType[virusControlIndices] &lt;-<span class="st"> &quot;virusCtl&quot;</span></a>
<a class="sourceLine" id="cb4-110" data-line-number="110"></a>
<a class="sourceLine" id="cb4-111" data-line-number="111"><span class="co">## All the other ones are treated with a given molecule</span></a>
<a class="sourceLine" id="cb4-112" data-line-number="112">wellType[<span class="op">!</span>(virusControlIndices <span class="op">|</span><span class="st"> </span>cellControlIndices)] &lt;-<span class="st"> &quot;treated&quot;</span></a>
<a class="sourceLine" id="cb4-113" data-line-number="113"></a>
<a class="sourceLine" id="cb4-114" data-line-number="114">inhibTable[, <span class="st">&quot;wellType&quot;</span>] &lt;-<span class="st"> </span>wellType</a>
<a class="sourceLine" id="cb4-115" data-line-number="115"></a>
<a class="sourceLine" id="cb4-116" data-line-number="116"></a>
<a class="sourceLine" id="cb4-117" data-line-number="117"><span class="co">#### Retrieve fields from the bioRxiv supplementary Table 1 ####</span></a>
<a class="sourceLine" id="cb4-118" data-line-number="118"></a>
<a class="sourceLine" id="cb4-119" data-line-number="119"><span class="cf">for</span> (field <span class="cf">in</span> <span class="kw">c</span>(<span class="st">&quot;Chemical.name&quot;</span>,</a>
<a class="sourceLine" id="cb4-120" data-line-number="120">                <span class="st">&quot;Broad.Therapeutic.class&quot;</span>,</a>
<a class="sourceLine" id="cb4-121" data-line-number="121">                <span class="st">&quot;Reported.therapeutic.effect&quot;</span>,</a>
<a class="sourceLine" id="cb4-122" data-line-number="122">                <span class="st">&quot;Inhibition.Index&quot;</span>)) {</a>
<a class="sourceLine" id="cb4-123" data-line-number="123">  inhibTable[, field] &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb4-124" data-line-number="124">  inhibTable[inhibTable<span class="op">$</span>ID <span class="op">%in%</span><span class="st"> </span>touretIDs, field] &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb4-125" data-line-number="125"><span class="st">    </span><span class="kw">as.vector</span>(supTable[, field])</a>
<a class="sourceLine" id="cb4-126" data-line-number="126">}</a>
<a class="sourceLine" id="cb4-127" data-line-number="127"></a>
<a class="sourceLine" id="cb4-128" data-line-number="128"></a>
<a class="sourceLine" id="cb4-129" data-line-number="129"><span class="co"># ## Retrieve the molecule names from Table 1 of the bioRxiv workbook</span></a>
<a class="sourceLine" id="cb4-130" data-line-number="130"><span class="co"># inhibTable$Chemical.name &lt;- NA</span></a>
<a class="sourceLine" id="cb4-131" data-line-number="131"><span class="co"># inhibTable[inhibTable$ID %in% touretIDs, &quot;Chemical.name&quot;] &lt;- </span></a>
<a class="sourceLine" id="cb4-132" data-line-number="132"><span class="co">#   as.vector(supTable$Chemical.name)</span></a>
<a class="sourceLine" id="cb4-133" data-line-number="133"></a>
<a class="sourceLine" id="cb4-134" data-line-number="134"></a>
<a class="sourceLine" id="cb4-135" data-line-number="135"></a>
<a class="sourceLine" id="cb4-136" data-line-number="136"></a>
<a class="sourceLine" id="cb4-137" data-line-number="137"><span class="kw">kable</span>(<span class="kw">t</span>(<span class="kw">table</span>(inhibTable<span class="op">$</span>wellType)), <span class="dt">caption =</span> <span class="st">&quot;Well types. cellCtl: no infection; virusCtl: infection without treatment; treated: inhected and treated with one molecule&quot;</span>, )</a></code></pre></div>
<table>
<caption>Well types. cellCtl: no infection; virusCtl: infection without treatment; treated: inhected and treated with one molecule</caption>
<thead>
<tr class="header">
<th align="right">cellCtl</th>
<th align="right">treated</th>
<th align="right">virusCtl</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">152</td>
<td align="right">1558</td>
<td align="right">114</td>
</tr>
</tbody>
</table>
<p>The raw data contains 19 plates with 8 rows (indiced A to H) and 12 columns (indiced from 1 to 12. )</p>
<p>The raw data consists of CTB measurements in cell cultures.</p>
</div>
<div id="distribution-of-raw-ctb-values" class="section level2">
<h2>Distribution of raw CTB values</h2>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="co">#### Distribution of raw measurements ####</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2">classInterval &lt;-<span class="st"> </span><span class="dv">500</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="co"># xmin &lt;- floor(min(inhibTable$CTB)/classInterval) * classInterval</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4">xmin &lt;-<span class="st"> </span><span class="dv">0</span> <span class="co">## Intently start the scale at0 to show the remnant CTB</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5">xmax &lt;-<span class="st"> </span><span class="kw">ceiling</span>(<span class="kw">max</span>(inhibTable<span class="op">$</span>CTB)<span class="op">/</span>classInterval) <span class="op">*</span><span class="st"> </span>classInterval</a>
<a class="sourceLine" id="cb5-6" data-line-number="6">breaks =<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from =</span> xmin, <span class="dt">to =</span> xmax, <span class="dt">by =</span> classInterval)</a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="co"># range(inhibTable$CTB)</span></a>
<a class="sourceLine" id="cb5-8" data-line-number="8"></a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb5-11" data-line-number="11"><span class="kw">hist</span>(inhibTable[wellType <span class="op">==</span><span class="st"> &quot;cellCtl&quot;</span>, <span class="st">&quot;CTB&quot;</span>], </a>
<a class="sourceLine" id="cb5-12" data-line-number="12">     <span class="dt">main =</span> <span class="st">&quot;Uninfected (cell control)&quot;</span>,</a>
<a class="sourceLine" id="cb5-13" data-line-number="13">     <span class="dt">xlab =</span> <span class="st">&quot;CTB&quot;</span>,</a>
<a class="sourceLine" id="cb5-14" data-line-number="14">     <span class="dt">ylab =</span> <span class="st">&quot;Number of plate wells&quot;</span>,</a>
<a class="sourceLine" id="cb5-15" data-line-number="15">     <span class="dt">las =</span> <span class="dv">1</span>, </a>
<a class="sourceLine" id="cb5-16" data-line-number="16">     <span class="dt">breaks =</span> breaks, <span class="dt">col =</span> <span class="st">&quot;palegreen&quot;</span>, <span class="dt">border =</span> <span class="st">&quot;palegreen&quot;</span>)</a>
<a class="sourceLine" id="cb5-17" data-line-number="17"></a>
<a class="sourceLine" id="cb5-18" data-line-number="18"><span class="kw">hist</span>(inhibTable[wellType <span class="op">==</span><span class="st"> &quot;virusCtl&quot;</span>, <span class="st">&quot;CTB&quot;</span>], </a>
<a class="sourceLine" id="cb5-19" data-line-number="19">     <span class="dt">main =</span> <span class="st">&quot;Infected, no treatment (virus control))&quot;</span>,</a>
<a class="sourceLine" id="cb5-20" data-line-number="20">     <span class="dt">xlab =</span> <span class="st">&quot;CTB&quot;</span>,</a>
<a class="sourceLine" id="cb5-21" data-line-number="21">     <span class="dt">ylab =</span> <span class="st">&quot;Number of plate wells&quot;</span>,</a>
<a class="sourceLine" id="cb5-22" data-line-number="22">     <span class="dt">las =</span> <span class="dv">1</span>, </a>
<a class="sourceLine" id="cb5-23" data-line-number="23">     <span class="dt">breaks =</span> breaks, <span class="dt">col =</span> <span class="st">&quot;orange&quot;</span>, <span class="dt">border =</span> <span class="st">&quot;orange&quot;</span>)</a>
<a class="sourceLine" id="cb5-24" data-line-number="24"></a>
<a class="sourceLine" id="cb5-25" data-line-number="25"><span class="kw">hist</span>(inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;CTB&quot;</span>], </a>
<a class="sourceLine" id="cb5-26" data-line-number="26">     <span class="dt">main =</span> <span class="st">&quot;Treated cells&quot;</span>,</a>
<a class="sourceLine" id="cb5-27" data-line-number="27">     <span class="dt">xlab =</span> <span class="st">&quot;CTB&quot;</span>,</a>
<a class="sourceLine" id="cb5-28" data-line-number="28">     <span class="dt">ylab =</span> <span class="st">&quot;Number of plate wells&quot;</span>,</a>
<a class="sourceLine" id="cb5-29" data-line-number="29">     <span class="dt">las =</span> <span class="dv">1</span>, </a>
<a class="sourceLine" id="cb5-30" data-line-number="30">     <span class="dt">breaks =</span> breaks, <span class="dt">col =</span> <span class="st">&quot;#AACCFF&quot;</span>, <span class="dt">border =</span> <span class="st">&quot;#AACCFF&quot;</span>)</a></code></pre></div>
<div class="figure" style="text-align: center">
<img src="figures/touret_sars-cov-2_inhibitorsraw_viab_distrib-1.png" alt="Distributions of the CTB measures. Top: uninfected cells. Middle: infected cells without treatment. Bottom: infected cells treated with a specific molecule. " width="80%" />
<p class="caption">
Distributions of the CTB measures. Top: uninfected cells. Middle: infected cells without treatment. Bottom: infected cells treated with a specific molecule.
</p>
</div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw">par</span>(par.ori)</a></code></pre></div>
<ul>
<li><p><strong><em>Cell control</em></strong>.</p>
<ul>
<li>The top panel (green) shows the distribution of CTB measurements in controls cultures, where the cells were neither infected by the virus nor treated with a drug.</li>
<li>Each plate contains 8 wells with uninfected cells (total = 152).</li>
</ul></li>
<li><p><strong><em>Virus control</em></strong>.</p>
<ul>
<li>The middle panel (orange) shows the distribution of CTB measurements in infected cells without drug treatment</li>
<li>The virus control was performed on 6 wells per plate, total = 114).</li>
</ul></li>
<li><p><strong><em>Treated cells</em></strong>.</p>
<ul>
<li><p>The bottom distribution (pale blue) shows the CTB values for cells infected and treated with a given drug.</p></li>
<li><p>Note that each drug was tested on a single well (no replicates). Indeed, in order to face the COVID-19 emergency, the study attempted to test as fast as possible a wide range of molecules. This first screening was thus performed without replicates. This has to be taken into account for the normalization, which should be done with no estimation of the variance for the individual drugs.</p></li>
<li><p>The distribution is strongly asymmetrical, and seems bi- or multi-modal. This distribution can be considered as a mixture between different distributions;</p>
<ul>
<li>all the drugs that have no inhibitory effect (and are thus expected to have a CTB similar to the virus control);</li>
<li>various drugs that inhibit the action of the virus, each one with its specific level of inhibition. This probably corresponds to the widely dispersed values above the bulk of distribution (and above the virus control distribution)</li>
</ul></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="co">#### Plate-wise colors ####</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2"></a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="co">## Assign a color to each plate</span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="co">## A trick: we alternate the colors of the rainbow in order </span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="co">## to see the contrast between successive plates</span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6">platePalette &lt;-<span class="st"> </span><span class="kw">rainbow</span>(<span class="dt">n =</span> <span class="kw">length</span>(plateNumbers))</a>
<a class="sourceLine" id="cb7-7" data-line-number="7">plateColor &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="dt">length =</span> nbPlates)</a>
<a class="sourceLine" id="cb7-8" data-line-number="8">oddIndices &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>, nbPlates, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb7-9" data-line-number="9">evenIndices &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">2</span>, nbPlates, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb7-10" data-line-number="10">plateColor[oddIndices] &lt;-<span class="st"> </span>platePalette[<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(oddIndices)]</a>
<a class="sourceLine" id="cb7-11" data-line-number="11">plateColor[evenIndices] &lt;-<span class="st"> </span>platePalette[(<span class="kw">length</span>(oddIndices) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)<span class="op">:</span>nbPlates]</a>
<a class="sourceLine" id="cb7-12" data-line-number="12"><span class="kw">names</span>(plateColor) &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span>nbPlates</a>
<a class="sourceLine" id="cb7-13" data-line-number="13"></a>
<a class="sourceLine" id="cb7-14" data-line-number="14"><span class="co">## Assign a color to each result according to its plate</span></a>
<a class="sourceLine" id="cb7-15" data-line-number="15">inhibTable<span class="op">$</span>color &lt;-<span class="st"> </span>plateColor[inhibTable<span class="op">$</span>Plate]</a>
<a class="sourceLine" id="cb7-16" data-line-number="16">inhibTable<span class="op">$</span>pch &lt;-<span class="st"> </span><span class="dv">1</span> <span class="co"># default point type for dot plots</span></a>
<a class="sourceLine" id="cb7-17" data-line-number="17">inhibTable[inhibTable<span class="op">$</span>wellType <span class="op">==</span><span class="st"> &quot;cellCtl&quot;</span>, <span class="st">&quot;pch&quot;</span>] &lt;-<span class="st"> </span>markPCh[<span class="st">&quot;cellCtl&quot;</span>]</a>
<a class="sourceLine" id="cb7-18" data-line-number="18">inhibTable[inhibTable<span class="op">$</span>wellType <span class="op">==</span><span class="st"> &quot;virusCtl&quot;</span>, <span class="st">&quot;pch&quot;</span>] &lt;-<span class="st"> </span>markPCh[<span class="st">&quot;virusCtl&quot;</span>]</a>
<a class="sourceLine" id="cb7-19" data-line-number="19"><span class="co"># table(inhibTable$color) ## Check that each plate has 96 wells</span></a>
<a class="sourceLine" id="cb7-20" data-line-number="20"><span class="co"># table(inhibTable$pch)</span></a></code></pre></div>
<div id="arbidol-treatment" class="section level3">
<h3>Arbidol treatment</h3>
<p>A treatment with 10µM Arbidol – a broad-spectrum antiviral – was used as control, with duplicate test in 2 wells per plate.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="co">#### Select arbidol duplicates as plate-wise milestones ####</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2">arbidolWells &lt;-<span class="st"> </span>(inhibTable<span class="op">$</span>Column <span class="op">==</span><span class="st"> </span><span class="dv">12</span>) <span class="op">&amp;</span><span class="st"> </span>(inhibTable<span class="op">$</span>Row <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>))</a>
<a class="sourceLine" id="cb8-3" data-line-number="3">inhibTable[arbidolWells, <span class="st">&quot;Chemical.name&quot;</span>] &lt;-<span class="st"> &quot;Arbidol&quot;</span></a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="co"># inhibTable[arbidolWells, c(&quot;ID&quot;, &quot;Chemical.name&quot;)]</span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5"></a>
<a class="sourceLine" id="cb8-6" data-line-number="6"><span class="co">#### Extract raw CTB measures per plate for arbidol ####</span></a>
<a class="sourceLine" id="cb8-7" data-line-number="7">arbidoltV &lt;-<span class="st"> </span>inhibTable[arbidolWells, <span class="kw">c</span>(<span class="st">&quot;Plate&quot;</span>, <span class="st">&quot;CTB&quot;</span>)]</a>
<a class="sourceLine" id="cb8-8" data-line-number="8">inhibTable[arbidolWells, <span class="st">&quot;color&quot;</span>] &lt;-<span class="st"> </span>markColor[<span class="st">&quot;Arbidol&quot;</span>]</a>
<a class="sourceLine" id="cb8-9" data-line-number="9">inhibTable[arbidolWells, <span class="st">&quot;pch&quot;</span>] &lt;-<span class="st"> </span>markPCh[<span class="st">&quot;Arbidol&quot;</span>]</a>
<a class="sourceLine" id="cb8-10" data-line-number="10"></a>
<a class="sourceLine" id="cb8-11" data-line-number="11"></a>
<a class="sourceLine" id="cb8-12" data-line-number="12"><span class="co"># table(inhibTable$color)</span></a></code></pre></div>
</div>
<div id="hydroxychloroquine-sulfate" class="section level3">
<h3>Hydroxychloroquine sulfate</h3>
<p>We assin a specific label to Hydroxychloroquine sulfate, which has a specific interest since it is one of the molecules tested in an European clinical trial.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">HOClSindex &lt;-<span class="st"> </span><span class="kw">which</span>(inhibTable<span class="op">$</span>Chemical.name <span class="op">==</span><span class="st"> &quot;Hydroxychloroquine sulfate&quot;</span>)</a>
<a class="sourceLine" id="cb9-2" data-line-number="2">HOClSpch &lt;-<span class="st"> </span><span class="dv">13</span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3">inhibTable[HOClSindex, <span class="st">&quot;color&quot;</span>] &lt;-<span class="st"> </span>markColor[<span class="st">&quot;Hydroxychloroquine&quot;</span>]</a>
<a class="sourceLine" id="cb9-4" data-line-number="4">inhibTable[HOClSindex, <span class="st">&quot;pch&quot;</span>] &lt;-<span class="st"> </span>HOClSpch</a></code></pre></div>
</div>
</div>
<div id="ctb-boxplots" class="section level2">
<h2>CTB boxplots</h2>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="co">#### Boxplots per plate  ####</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2"></a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="kw">boxplot</span>(CTB <span class="op">~</span><span class="st"> </span>Plate <span class="op">+</span><span class="st"> </span>wellType, </a>
<a class="sourceLine" id="cb10-4" data-line-number="4">        <span class="dt">main =</span> <span class="st">&quot;Cell Ttiter Blue (CTB) per plate&quot;</span>,</a>
<a class="sourceLine" id="cb10-5" data-line-number="5">        <span class="dt">data =</span> inhibTable, </a>
<a class="sourceLine" id="cb10-6" data-line-number="6">        <span class="dt">las =</span> <span class="dv">1</span>, <span class="dt">col =</span> plateColor, </a>
<a class="sourceLine" id="cb10-7" data-line-number="7">        <span class="dt">xlab =</span> <span class="st">&quot;CTB&quot;</span>, </a>
<a class="sourceLine" id="cb10-8" data-line-number="8">        <span class="dt">cex.axis =</span> <span class="fl">0.5</span>, <span class="dt">cex =</span> <span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb10-9" data-line-number="9">        <span class="dt">horizontal =</span> <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb10-10" data-line-number="10">        )</a>
<a class="sourceLine" id="cb10-11" data-line-number="11"><span class="kw">abline</span>(<span class="dt">v =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="kw">max</span>(inhibTable<span class="op">$</span>CTB), <span class="dt">by =</span> <span class="dv">2000</span>), <span class="dt">col =</span> <span class="st">&quot;#EEEEEE&quot;</span>, <span class="dt">lty =</span> <span class="st">&quot;dashed&quot;</span>)</a>
<a class="sourceLine" id="cb10-12" data-line-number="12"><span class="kw">abline</span>(<span class="dt">v =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="kw">max</span>(inhibTable<span class="op">$</span>CTB), <span class="dt">by =</span> <span class="dv">10000</span>), <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>)</a>
<a class="sourceLine" id="cb10-13" data-line-number="13"></a>
<a class="sourceLine" id="cb10-14" data-line-number="14"><span class="co">## Add points to denote the arbidol controls</span></a>
<a class="sourceLine" id="cb10-15" data-line-number="15"><span class="kw">stripchart</span>(CTB <span class="op">~</span><span class="st"> </span>Plate, <span class="dt">vertical =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb10-16" data-line-number="16">           <span class="dt">data =</span> inhibTable[arbidolWells, ],</a>
<a class="sourceLine" id="cb10-17" data-line-number="17">           <span class="dt">method =</span> <span class="st">&quot;jitter&quot;</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>, <span class="dt">cex =</span> <span class="fl">0.7</span>, </a>
<a class="sourceLine" id="cb10-18" data-line-number="18">           <span class="dt">col =</span> markColor[<span class="st">&quot;Arbidol&quot;</span>], <span class="dt">pch =</span> markPCh[<span class="st">&quot;Arbidol&quot;</span>])</a>
<a class="sourceLine" id="cb10-19" data-line-number="19"></a>
<a class="sourceLine" id="cb10-20" data-line-number="20"></a>
<a class="sourceLine" id="cb10-21" data-line-number="21"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">legend =</span> <span class="kw">names</span>(plateColor), </a>
<a class="sourceLine" id="cb10-22" data-line-number="22">       <span class="dt">title =</span> <span class="st">&quot;Plate&quot;</span>, <span class="dt">fill =</span> plateColor, <span class="dt">cex =</span> <span class="fl">0.8</span>)</a></code></pre></div>
<div class="figure" style="text-align: center">
<img src="figures/touret_sars-cov-2_inhibitorsboxplots_per_plate_CTB-1.png" alt="Distribution of CTB values per plate. Top virus control (untreated infected cells); middle: treated cells; bottom: cell control (uninfected). Black plain circles: arbidol control duplicates.  " width="80%" />
<p class="caption">
Distribution of CTB values per plate. Top virus control (untreated infected cells); middle: treated cells; bottom: cell control (uninfected). Black plain circles: arbidol control duplicates.
</p>
</div>
<p>The boxplot of the CTB measurements highlights a plate effect, for the treated cells (middle barplots) but also for the untreated virus control (top boxplots) and uninfected cell control (bottom boxplots).</p>
<ul>
<li><p><strong>Treated:</strong></p>
<ul>
<li>The medians and interquartile ranges show strong variations between plates.</li>
<li>In particular, plate 1 (in red) has a the smallest median and a remarkably compact interquartile range. There are many statistical outliers (empty circles) in this plate, which might correspond to the molecules having a significant inhibitory effect.</li>
<li>In contrast, plates 11 to 15 show a high median and a wide dispersion of CTB measures, and there is not a single statistical outlier.</li>
</ul></li>
<li><p><strong>Virus control (<span class="math inline">\(vc\)</span>)</strong></p>
<ul>
<li>As expected, untreated infected cells generally gave a very small CTB, with small variations (very compact interquartile rectangles)</li>
<li>There is a problem for the virus control of plate 17, which shows a broad range of values, with a third quartile falling in the range of the uninfected cells. This suggests a problem with at least 2 of the 6 replicates (missed infection ?). However, the median of the virus controls for this plate falls in the same range as for the virus control of the other plates.</li>
</ul></li>
<li><p><strong>Cell control (<span class="math inline">\(cc\)</span>)</strong></p>
<ul>
<li>The cell control performs as expected in all the plates, with high CTB values.</li>
<li>Note however that the CTB of uninfected cells show inter-plate variations, with median values ranging from ~37,000 to ~53,000.</li>
</ul></li>
</ul>
<p>Importantly, there is a consistency between the inter-plate differences observed for virus control, treated cells and cell control, respectively. For example, plate 2 whose consistently higher value than the other plates for the three types of wells. This highlights the importances to perform a plate-wise standardization.</p>
<hr />
</div>
</div>
<div id="plate-wise-standardization" class="section level1">
<h1>Plate-wise standardization</h1>
<div id="plate-wise-control-points" class="section level2">
<h2>Plate-wise control points</h2>
<p>Taking into account the above-reported results, we apply the following procedure to standardize the individual viability measures.</p>
<p>For each plate, we define two control values:</p>
<ul>
<li><span class="math inline">\(CTB_{cc,i}\)</span>: median CTB of the 8 <strong>cell controls</strong> (uninfected cells) of plate <span class="math inline">\(i\)</span></li>
<li><span class="math inline">\(CTB_{vc,i}\)</span>: median CTB of the 6 <strong>virus controls</strong> (infected untreated cells) of plate <span class="math inline">\(i\)</span></li>
</ul>
<p>These two values are deliberately estimated with the median measurement of the control replicate, in order to avoid the effect of outliers as denoted for the virus control of plate 17.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="co">#### Compute plate-wise statistics ####</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2">plateStat &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb11-3" data-line-number="3">  <span class="dt">plate =</span> plateNumbers,</a>
<a class="sourceLine" id="cb11-4" data-line-number="4">  </a>
<a class="sourceLine" id="cb11-5" data-line-number="5">  <span class="co">## Mean CTB</span></a>
<a class="sourceLine" id="cb11-6" data-line-number="6">  <span class="dt">CTBmean =</span> <span class="kw">as.vector</span>(<span class="kw">by</span>(</a>
<a class="sourceLine" id="cb11-7" data-line-number="7">    <span class="dt">data =</span> inhibTable<span class="op">$</span>CTB, </a>
<a class="sourceLine" id="cb11-8" data-line-number="8">    <span class="dt">INDICES =</span> inhibTable<span class="op">$</span>Plate, </a>
<a class="sourceLine" id="cb11-9" data-line-number="9">    <span class="dt">FUN =</span> mean)),</a>
<a class="sourceLine" id="cb11-10" data-line-number="10">  </a>
<a class="sourceLine" id="cb11-11" data-line-number="11">  <span class="co">## Standard deviation</span></a>
<a class="sourceLine" id="cb11-12" data-line-number="12">  <span class="dt">CTBsd =</span> <span class="kw">as.vector</span>(<span class="kw">by</span>(</a>
<a class="sourceLine" id="cb11-13" data-line-number="13">    <span class="dt">data =</span> inhibTable<span class="op">$</span>CTB, </a>
<a class="sourceLine" id="cb11-14" data-line-number="14">    <span class="dt">INDICES =</span> inhibTable<span class="op">$</span>Plate, </a>
<a class="sourceLine" id="cb11-15" data-line-number="15">    <span class="dt">FUN =</span> sd)),</a>
<a class="sourceLine" id="cb11-16" data-line-number="16">  </a>
<a class="sourceLine" id="cb11-17" data-line-number="17">  <span class="co">## Median</span></a>
<a class="sourceLine" id="cb11-18" data-line-number="18">  <span class="dt">CTBmedian =</span> <span class="kw">as.vector</span>(<span class="kw">by</span>(</a>
<a class="sourceLine" id="cb11-19" data-line-number="19">    <span class="dt">data =</span> inhibTable<span class="op">$</span>CTB, </a>
<a class="sourceLine" id="cb11-20" data-line-number="20">    <span class="dt">INDICES =</span> inhibTable<span class="op">$</span>Plate, </a>
<a class="sourceLine" id="cb11-21" data-line-number="21">    <span class="dt">FUN =</span> median)),</a>
<a class="sourceLine" id="cb11-22" data-line-number="22">  </a>
<a class="sourceLine" id="cb11-23" data-line-number="23">  <span class="co">## Minimum</span></a>
<a class="sourceLine" id="cb11-24" data-line-number="24">  <span class="dt">CTBmin =</span> <span class="kw">as.vector</span>(<span class="kw">by</span>(</a>
<a class="sourceLine" id="cb11-25" data-line-number="25">    <span class="dt">data =</span> inhibTable<span class="op">$</span>CTB, </a>
<a class="sourceLine" id="cb11-26" data-line-number="26">    <span class="dt">INDICES =</span> inhibTable<span class="op">$</span>Plate, </a>
<a class="sourceLine" id="cb11-27" data-line-number="27">    <span class="dt">FUN =</span> min)),</a>
<a class="sourceLine" id="cb11-28" data-line-number="28">  </a>
<a class="sourceLine" id="cb11-29" data-line-number="29">  <span class="co">## maximum</span></a>
<a class="sourceLine" id="cb11-30" data-line-number="30"> <span class="dt">CTBmax =</span> <span class="kw">as.vector</span>(<span class="kw">by</span>(</a>
<a class="sourceLine" id="cb11-31" data-line-number="31">    <span class="dt">data =</span> inhibTable<span class="op">$</span>CTB, </a>
<a class="sourceLine" id="cb11-32" data-line-number="32">    <span class="dt">INDICES =</span> inhibTable<span class="op">$</span>Plate, </a>
<a class="sourceLine" id="cb11-33" data-line-number="33">    <span class="dt">FUN =</span> max)),</a>
<a class="sourceLine" id="cb11-34" data-line-number="34">  </a>
<a class="sourceLine" id="cb11-35" data-line-number="35">  <span class="co"># ## interquartile range</span></a>
<a class="sourceLine" id="cb11-36" data-line-number="36">  <span class="co"># CTBiqr = as.vector(by(</span></a>
<a class="sourceLine" id="cb11-37" data-line-number="37">  <span class="co">#   data = inhibTable$CTB, </span></a>
<a class="sourceLine" id="cb11-38" data-line-number="38">  <span class="co">#   INDICES = inhibTable$Plate, </span></a>
<a class="sourceLine" id="cb11-39" data-line-number="39">  <span class="co">#   FUN = IQR)),</span></a>
<a class="sourceLine" id="cb11-40" data-line-number="40">  </a>
<a class="sourceLine" id="cb11-41" data-line-number="41">  <span class="co">## Plate-wise virus control</span></a>
<a class="sourceLine" id="cb11-42" data-line-number="42">  <span class="dt">CTBvc =</span> <span class="kw">as.vector</span>(<span class="kw">by</span>(</a>
<a class="sourceLine" id="cb11-43" data-line-number="43">    <span class="dt">data =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;virusCtl&quot;</span>, <span class="st">&quot;CTB&quot;</span>], </a>
<a class="sourceLine" id="cb11-44" data-line-number="44">    <span class="dt">INDICES =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;virusCtl&quot;</span>, <span class="st">&quot;Plate&quot;</span>], </a>
<a class="sourceLine" id="cb11-45" data-line-number="45">    <span class="dt">FUN =</span> median)),</a>
<a class="sourceLine" id="cb11-46" data-line-number="46">  </a>
<a class="sourceLine" id="cb11-47" data-line-number="47">  <span class="co">## Plate-wise cell control</span></a>
<a class="sourceLine" id="cb11-48" data-line-number="48">  <span class="dt">CTBcc =</span> <span class="kw">as.vector</span>(<span class="kw">by</span>(</a>
<a class="sourceLine" id="cb11-49" data-line-number="49">    <span class="dt">data =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;cellCtl&quot;</span>, <span class="st">&quot;CTB&quot;</span>], </a>
<a class="sourceLine" id="cb11-50" data-line-number="50">    <span class="dt">INDICES =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;cellCtl&quot;</span>, <span class="st">&quot;Plate&quot;</span>], </a>
<a class="sourceLine" id="cb11-51" data-line-number="51">    <span class="dt">FUN =</span> median))</a>
<a class="sourceLine" id="cb11-52" data-line-number="52">  </a>
<a class="sourceLine" id="cb11-53" data-line-number="53">)</a>
<a class="sourceLine" id="cb11-54" data-line-number="54"><span class="kw">rownames</span>(plateStat) &lt;-<span class="st"> </span>plateStat<span class="op">$</span>plate</a>
<a class="sourceLine" id="cb11-55" data-line-number="55"></a>
<a class="sourceLine" id="cb11-56" data-line-number="56"><span class="co">## print the plate-wise stats in the report</span></a>
<a class="sourceLine" id="cb11-57" data-line-number="57"><span class="kw">kable</span>(plateStat, <span class="dt">caption =</span> <span class="st">&quot;Plate-wise statistics on the CTB&quot;</span>)</a></code></pre></div>
<table>
<caption>Plate-wise statistics on the CTB</caption>
<thead>
<tr class="header">
<th align="right">plate</th>
<th align="right">CTBmean</th>
<th align="right">CTBsd</th>
<th align="right">CTBmedian</th>
<th align="right">CTBmin</th>
<th align="right">CTBmax</th>
<th align="right">CTBvc</th>
<th align="right">CTBcc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">14968.79</td>
<td align="right">9179.079</td>
<td align="right">10568.5</td>
<td align="right">7326</td>
<td align="right">45194</td>
<td align="right">10202.0</td>
<td align="right">37197.5</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">21151.54</td>
<td align="right">11359.022</td>
<td align="right">17339.0</td>
<td align="right">10069</td>
<td align="right">55014</td>
<td align="right">14018.0</td>
<td align="right">51971.0</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">15561.16</td>
<td align="right">8274.558</td>
<td align="right">12261.0</td>
<td align="right">8110</td>
<td align="right">43083</td>
<td align="right">10482.0</td>
<td align="right">40016.0</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">20376.58</td>
<td align="right">10986.807</td>
<td align="right">15742.0</td>
<td align="right">8648</td>
<td align="right">46289</td>
<td align="right">12241.0</td>
<td align="right">44342.0</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">16882.96</td>
<td align="right">9640.466</td>
<td align="right">13660.5</td>
<td align="right">7114</td>
<td align="right">43824</td>
<td align="right">9876.5</td>
<td align="right">42012.0</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">15654.72</td>
<td align="right">9488.589</td>
<td align="right">11291.5</td>
<td align="right">7389</td>
<td align="right">43312</td>
<td align="right">9942.0</td>
<td align="right">38458.5</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="right">17024.33</td>
<td align="right">9779.790</td>
<td align="right">12338.0</td>
<td align="right">8040</td>
<td align="right">43221</td>
<td align="right">10626.0</td>
<td align="right">39375.0</td>
</tr>
<tr class="even">
<td align="right">8</td>
<td align="right">16583.02</td>
<td align="right">9286.450</td>
<td align="right">12010.5</td>
<td align="right">8033</td>
<td align="right">43402</td>
<td align="right">11185.5</td>
<td align="right">38161.0</td>
</tr>
<tr class="odd">
<td align="right">9</td>
<td align="right">18603.48</td>
<td align="right">9702.154</td>
<td align="right">14293.5</td>
<td align="right">9418</td>
<td align="right">45126</td>
<td align="right">12852.5</td>
<td align="right">43904.5</td>
</tr>
<tr class="even">
<td align="right">10</td>
<td align="right">18183.64</td>
<td align="right">9574.292</td>
<td align="right">14639.0</td>
<td align="right">8690</td>
<td align="right">45927</td>
<td align="right">11993.0</td>
<td align="right">42310.5</td>
</tr>
<tr class="odd">
<td align="right">11</td>
<td align="right">22241.27</td>
<td align="right">10113.348</td>
<td align="right">19335.0</td>
<td align="right">5255</td>
<td align="right">46301</td>
<td align="right">12856.0</td>
<td align="right">40742.5</td>
</tr>
<tr class="even">
<td align="right">12</td>
<td align="right">21527.03</td>
<td align="right">9444.469</td>
<td align="right">19471.5</td>
<td align="right">5248</td>
<td align="right">43404</td>
<td align="right">10781.5</td>
<td align="right">40187.5</td>
</tr>
<tr class="odd">
<td align="right">13</td>
<td align="right">24039.02</td>
<td align="right">10818.207</td>
<td align="right">23996.5</td>
<td align="right">5097</td>
<td align="right">44821</td>
<td align="right">11987.0</td>
<td align="right">39596.5</td>
</tr>
<tr class="even">
<td align="right">14</td>
<td align="right">23585.09</td>
<td align="right">9364.788</td>
<td align="right">23567.0</td>
<td align="right">4263</td>
<td align="right">42400</td>
<td align="right">12083.0</td>
<td align="right">36942.0</td>
</tr>
<tr class="odd">
<td align="right">15</td>
<td align="right">24082.91</td>
<td align="right">10388.209</td>
<td align="right">23327.0</td>
<td align="right">4685</td>
<td align="right">45445</td>
<td align="right">11686.0</td>
<td align="right">38995.5</td>
</tr>
<tr class="even">
<td align="right">16</td>
<td align="right">19891.76</td>
<td align="right">8991.913</td>
<td align="right">19738.0</td>
<td align="right">4483</td>
<td align="right">45555</td>
<td align="right">10090.0</td>
<td align="right">34521.5</td>
</tr>
<tr class="odd">
<td align="right">17</td>
<td align="right">19518.59</td>
<td align="right">9053.786</td>
<td align="right">17587.0</td>
<td align="right">4983</td>
<td align="right">41762</td>
<td align="right">12314.5</td>
<td align="right">36445.0</td>
</tr>
<tr class="even">
<td align="right">18</td>
<td align="right">21942.55</td>
<td align="right">9706.601</td>
<td align="right">19075.5</td>
<td align="right">5173</td>
<td align="right">44573</td>
<td align="right">12623.0</td>
<td align="right">40740.5</td>
</tr>
<tr class="odd">
<td align="right">19</td>
<td align="right">19526.67</td>
<td align="right">9930.452</td>
<td align="right">15299.5</td>
<td align="right">4578</td>
<td align="right">43712</td>
<td align="right">10505.0</td>
<td align="right">37360.5</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="co">## Add columns with the control values according to the plate</span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2">inhibTable<span class="op">$</span>CTBvc &lt;-<span class="st"> </span>plateStat<span class="op">$</span>CTBvc[inhibTable<span class="op">$</span>Plate]</a>
<a class="sourceLine" id="cb12-3" data-line-number="3">inhibTable<span class="op">$</span>CTBcc &lt;-<span class="st"> </span>plateStat<span class="op">$</span>CTBcc[inhibTable<span class="op">$</span>Plate]</a>
<a class="sourceLine" id="cb12-4" data-line-number="4"><span class="co"># sort(table(inhibTable$CTBvc))</span></a>
<a class="sourceLine" id="cb12-5" data-line-number="5"><span class="co"># sort(table(inhibTable$CTBcc))</span></a></code></pre></div>
</div>
<div id="viability-ratio-and-log2ratio" class="section level2">
<h2>Viability ratio and log2(ratio)</h2>
<p>The <strong>viability ratio</strong> (<span class="math inline">\(R\)</span>) associated to a given treatment with molecule <span class="math inline">\(m\)</span> on a given plate <span class="math inline">\(i\)</span> is defined as the ratio between</p>
<ul>
<li>the <span class="math inline">\(CTB\)</span> measured on infected cells treated with this molecule (<span class="math inline">\(CTB_{m,i}\)</span>) and</li>
<li>the median <span class="math inline">\(CTB\)</span> of 8 replicates of uninfected cells (denoted <span class="math inline">\(cc\)</span> for <em>cell control</em>) on the same plate (<span class="math inline">\(CTB_{cc,i}\)</span>).</li>
</ul>
<p><span class="math display">\[R_{m,i} =  \frac{CTB_{m,i}}{CTB_{cc, i}}\]</span></p>
<p>We further apply logarithmic transformation in order to normalise this ratio.</p>
<p><span class="math display">\[R_{m,i} = log2(R) = log2 \left( \frac{CTB_{m,i}}{CTB_{cc, i}} \right)\]</span></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="co">#### Compute plate-relative viability ####</span></a>
<a class="sourceLine" id="cb13-2" data-line-number="2">inhibTable<span class="op">$</span>Vratio &lt;-<span class="st"> </span>inhibTable<span class="op">$</span>CTB <span class="op">/</span><span class="st"> </span>inhibTable<span class="op">$</span>CTBcc</a>
<a class="sourceLine" id="cb13-3" data-line-number="3">inhibTable<span class="op">$</span>Vlog2R &lt;-<span class="st"> </span><span class="kw">log2</span>(inhibTable<span class="op">$</span>Vratio)</a>
<a class="sourceLine" id="cb13-4" data-line-number="4"><span class="co"># table(wellType)</span></a>
<a class="sourceLine" id="cb13-5" data-line-number="5"><span class="co"># hist(inhibTable[wellType == &quot;cellCtl&quot;, &quot;Vratio&quot;], breaks = 50)</span></a>
<a class="sourceLine" id="cb13-6" data-line-number="6"><span class="co"># hist(inhibTable[wellType == &quot;cellCtl&quot;, &quot;Vlog2R&quot;], breaks = 50)</span></a>
<a class="sourceLine" id="cb13-7" data-line-number="7"></a>
<a class="sourceLine" id="cb13-8" data-line-number="8"><span class="co">## Plate-wise virus control viability ratio</span></a>
<a class="sourceLine" id="cb13-9" data-line-number="9">plateStat<span class="op">$</span>Rvc &lt;-<span class="st"> </span><span class="kw">as.vector</span>(<span class="kw">by</span>(</a>
<a class="sourceLine" id="cb13-10" data-line-number="10">  <span class="dt">data =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;virusCtl&quot;</span>, <span class="st">&quot;Vratio&quot;</span>], </a>
<a class="sourceLine" id="cb13-11" data-line-number="11">  <span class="dt">INDICES =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;virusCtl&quot;</span>, <span class="st">&quot;Plate&quot;</span>], </a>
<a class="sourceLine" id="cb13-12" data-line-number="12">  <span class="dt">FUN =</span> median))</a>
<a class="sourceLine" id="cb13-13" data-line-number="13"></a>
<a class="sourceLine" id="cb13-14" data-line-number="14"><span class="co">## Plate-wise cell control viability ratio</span></a>
<a class="sourceLine" id="cb13-15" data-line-number="15"><span class="co">## Note: this is 1 by definition, we compute it for validation</span></a>
<a class="sourceLine" id="cb13-16" data-line-number="16">plateStat<span class="op">$</span>Rcc &lt;-<span class="st"> </span><span class="kw">as.vector</span>(<span class="kw">by</span>(</a>
<a class="sourceLine" id="cb13-17" data-line-number="17">  <span class="dt">data =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;cellCtl&quot;</span>, <span class="st">&quot;Vratio&quot;</span>], </a>
<a class="sourceLine" id="cb13-18" data-line-number="18">  <span class="dt">INDICES =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;cellCtl&quot;</span>, <span class="st">&quot;Plate&quot;</span>], </a>
<a class="sourceLine" id="cb13-19" data-line-number="19">  <span class="dt">FUN =</span> median))</a>
<a class="sourceLine" id="cb13-20" data-line-number="20"></a>
<a class="sourceLine" id="cb13-21" data-line-number="21"></a>
<a class="sourceLine" id="cb13-22" data-line-number="22"><span class="co">## Plate-wise virus control viability log2 ratio</span></a>
<a class="sourceLine" id="cb13-23" data-line-number="23">plateStat<span class="op">$</span>Lvc &lt;-<span class="st"> </span><span class="kw">as.vector</span>(<span class="kw">by</span>(</a>
<a class="sourceLine" id="cb13-24" data-line-number="24">  <span class="dt">data =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;virusCtl&quot;</span>, <span class="st">&quot;Vlog2R&quot;</span>], </a>
<a class="sourceLine" id="cb13-25" data-line-number="25">  <span class="dt">INDICES =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;virusCtl&quot;</span>, <span class="st">&quot;Plate&quot;</span>], </a>
<a class="sourceLine" id="cb13-26" data-line-number="26">  <span class="dt">FUN =</span> median))</a>
<a class="sourceLine" id="cb13-27" data-line-number="27"></a>
<a class="sourceLine" id="cb13-28" data-line-number="28"><span class="co">## Plate-wise cell control viability log2 ratio</span></a>
<a class="sourceLine" id="cb13-29" data-line-number="29">plateStat<span class="op">$</span>Lcc &lt;-<span class="st"> </span><span class="kw">as.vector</span>(<span class="kw">by</span>(</a>
<a class="sourceLine" id="cb13-30" data-line-number="30">  <span class="dt">data =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;cellCtl&quot;</span>, <span class="st">&quot;Vlog2R&quot;</span>], </a>
<a class="sourceLine" id="cb13-31" data-line-number="31">  <span class="dt">INDICES =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;cellCtl&quot;</span>, <span class="st">&quot;Plate&quot;</span>], </a>
<a class="sourceLine" id="cb13-32" data-line-number="32">  <span class="dt">FUN =</span> median))</a></code></pre></div>
<div id="viability-ratio-boxplots" class="section level3">
<h3>Viability ratio boxplots</h3>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb14-2" data-line-number="2"></a>
<a class="sourceLine" id="cb14-3" data-line-number="3"></a>
<a class="sourceLine" id="cb14-4" data-line-number="4"><span class="co">#### Boxplots of viability ratios per plate ####</span></a>
<a class="sourceLine" id="cb14-5" data-line-number="5"></a>
<a class="sourceLine" id="cb14-6" data-line-number="6">Rfloor &lt;-<span class="st"> </span><span class="kw">floor</span>(<span class="kw">min</span>(inhibTable<span class="op">$</span>Vratio))</a>
<a class="sourceLine" id="cb14-7" data-line-number="7">Rceiling &lt;-<span class="st"> </span><span class="kw">max</span>(inhibTable<span class="op">$</span>Vratio) <span class="op">*</span><span class="st"> </span><span class="fl">1.1</span></a>
<a class="sourceLine" id="cb14-8" data-line-number="8"></a>
<a class="sourceLine" id="cb14-9" data-line-number="9"><span class="co">## Box plot per plate and well type</span></a>
<a class="sourceLine" id="cb14-10" data-line-number="10"><span class="kw">boxplot</span>(Vratio <span class="op">~</span><span class="st"> </span>Plate <span class="op">+</span><span class="st"> </span>wellType, </a>
<a class="sourceLine" id="cb14-11" data-line-number="11">        <span class="dt">main =</span> <span class="st">&quot;Viability ratio distribution&quot;</span>,</a>
<a class="sourceLine" id="cb14-12" data-line-number="12">        <span class="dt">data =</span> inhibTable, </a>
<a class="sourceLine" id="cb14-13" data-line-number="13">        <span class="dt">las =</span> <span class="dv">1</span>, <span class="dt">col =</span> plateColor, </a>
<a class="sourceLine" id="cb14-14" data-line-number="14">        <span class="dt">xlab =</span> <span class="st">&quot;R = CTB / CTBcc&quot;</span>, </a>
<a class="sourceLine" id="cb14-15" data-line-number="15">        <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="kw">min</span>(inhibTable<span class="op">$</span>Vratio), Rceiling),</a>
<a class="sourceLine" id="cb14-16" data-line-number="16">        <span class="dt">cex.axis =</span> <span class="fl">0.5</span>, <span class="dt">cex =</span> <span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb14-17" data-line-number="17">        <span class="dt">horizontal =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb14-18" data-line-number="18"><span class="kw">abline</span>(<span class="dt">v =</span> <span class="dv">1</span>, <span class="dt">col =</span> <span class="st">&quot;#00BB00&quot;</span>)</a>
<a class="sourceLine" id="cb14-19" data-line-number="19"><span class="kw">abline</span>(<span class="dt">v =</span> <span class="kw">seq</span>(<span class="dt">from =</span> Rfloor, <span class="dt">to =</span> Rceiling, <span class="dt">by =</span> <span class="fl">0.05</span>), <span class="dt">col =</span> <span class="st">&quot;#EEEEEE&quot;</span>, <span class="dt">lty =</span> <span class="st">&quot;dashed&quot;</span>)</a>
<a class="sourceLine" id="cb14-20" data-line-number="20"><span class="kw">abline</span>(<span class="dt">v =</span> <span class="kw">seq</span>(<span class="dt">from =</span> Rfloor, <span class="dt">to =</span> Rceiling, <span class="dt">by =</span> <span class="fl">0.2</span>), <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>)</a>
<a class="sourceLine" id="cb14-21" data-line-number="21"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">legend =</span> <span class="kw">names</span>(plateColor), </a>
<a class="sourceLine" id="cb14-22" data-line-number="22">       <span class="dt">title =</span> <span class="st">&quot;Plate&quot;</span>, <span class="dt">fill =</span> plateColor, <span class="dt">cex =</span> <span class="fl">0.6</span>)</a>
<a class="sourceLine" id="cb14-23" data-line-number="23"></a>
<a class="sourceLine" id="cb14-24" data-line-number="24"><span class="co">## Add points to denote the arbidol controls</span></a>
<a class="sourceLine" id="cb14-25" data-line-number="25"><span class="kw">stripchart</span>(Vratio <span class="op">~</span><span class="st"> </span>Plate, <span class="dt">vertical =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb14-26" data-line-number="26">           <span class="dt">data =</span> inhibTable[arbidolWells, ],</a>
<a class="sourceLine" id="cb14-27" data-line-number="27">           <span class="dt">method =</span> <span class="st">&quot;jitter&quot;</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>, <span class="dt">cex =</span> <span class="fl">0.7</span>, </a>
<a class="sourceLine" id="cb14-28" data-line-number="28">           <span class="dt">col =</span> markColor[<span class="st">&quot;Arbidol&quot;</span>], <span class="dt">pch =</span> markPCh[<span class="st">&quot;Arbidol&quot;</span>])</a>
<a class="sourceLine" id="cb14-29" data-line-number="29"></a>
<a class="sourceLine" id="cb14-30" data-line-number="30"><span class="kw">legend</span>(<span class="st">&quot;bottomleft&quot;</span>, </a>
<a class="sourceLine" id="cb14-31" data-line-number="31">       <span class="dt">title =</span> <span class="st">&quot;Markers&quot;</span>, </a>
<a class="sourceLine" id="cb14-32" data-line-number="32">       <span class="dt">legend =</span> <span class="st">&quot;Arbidol&quot;</span>, </a>
<a class="sourceLine" id="cb14-33" data-line-number="33">       <span class="dt">col =</span> markColor[<span class="st">&quot;Arbidol&quot;</span>], </a>
<a class="sourceLine" id="cb14-34" data-line-number="34">       <span class="dt">pch =</span> markPCh[<span class="st">&quot;Arbidol&quot;</span>],</a>
<a class="sourceLine" id="cb14-35" data-line-number="35">       <span class="dt">cex =</span> <span class="fl">0.8</span>)</a>
<a class="sourceLine" id="cb14-36" data-line-number="36"></a>
<a class="sourceLine" id="cb14-37" data-line-number="37"></a>
<a class="sourceLine" id="cb14-38" data-line-number="38"><span class="co">#### Boxplots of viability log(ratios) per plate ####</span></a>
<a class="sourceLine" id="cb14-39" data-line-number="39"></a>
<a class="sourceLine" id="cb14-40" data-line-number="40">Lfloor &lt;-<span class="st"> </span><span class="kw">floor</span>(<span class="kw">min</span>(inhibTable<span class="op">$</span>Vlog2R))</a>
<a class="sourceLine" id="cb14-41" data-line-number="41">Lceiling &lt;-<span class="st"> </span><span class="kw">ceiling</span>(<span class="kw">max</span>(inhibTable<span class="op">$</span>Vlog2R))</a>
<a class="sourceLine" id="cb14-42" data-line-number="42"></a>
<a class="sourceLine" id="cb14-43" data-line-number="43"><span class="co">## Box plot per plate and well type</span></a>
<a class="sourceLine" id="cb14-44" data-line-number="44"><span class="kw">boxplot</span>(Vlog2R <span class="op">~</span><span class="st"> </span>Plate <span class="op">+</span><span class="st"> </span>wellType, </a>
<a class="sourceLine" id="cb14-45" data-line-number="45">        <span class="dt">main =</span> <span class="st">&quot;Viability log2(ratio) distribution&quot;</span>,</a>
<a class="sourceLine" id="cb14-46" data-line-number="46">        <span class="dt">data =</span> inhibTable, </a>
<a class="sourceLine" id="cb14-47" data-line-number="47">        <span class="dt">las =</span> <span class="dv">1</span>, <span class="dt">col =</span> plateColor, </a>
<a class="sourceLine" id="cb14-48" data-line-number="48">        <span class="dt">xlab =</span> <span class="st">&quot;L = log2(CTB / CTBcc)&quot;</span>, </a>
<a class="sourceLine" id="cb14-49" data-line-number="49">        <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="kw">min</span>(inhibTable<span class="op">$</span>Vlog2R), Lceiling),</a>
<a class="sourceLine" id="cb14-50" data-line-number="50">        <span class="dt">cex.axis =</span> <span class="fl">0.5</span>, <span class="dt">cex =</span> <span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb14-51" data-line-number="51">        <span class="dt">horizontal =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb14-52" data-line-number="52"><span class="kw">abline</span>(<span class="dt">v =</span> <span class="kw">seq</span>(<span class="dt">from =</span> Lfloor, <span class="dt">to =</span> Lceiling, <span class="dt">by =</span> <span class="fl">0.2</span>), <span class="dt">col =</span> <span class="st">&quot;#EEEEEE&quot;</span>, <span class="dt">lty =</span> <span class="st">&quot;dashed&quot;</span>)</a>
<a class="sourceLine" id="cb14-53" data-line-number="53"><span class="kw">abline</span>(<span class="dt">v =</span> <span class="kw">seq</span>(<span class="dt">from =</span> Lfloor, <span class="dt">to =</span> Lceiling, <span class="dt">by =</span> <span class="dv">1</span>), <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>)</a>
<a class="sourceLine" id="cb14-54" data-line-number="54"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">legend =</span> <span class="kw">names</span>(plateColor), </a>
<a class="sourceLine" id="cb14-55" data-line-number="55">       <span class="dt">title =</span> <span class="st">&quot;Plate&quot;</span>, <span class="dt">fill =</span> plateColor, <span class="dt">cex =</span> <span class="fl">0.6</span>)</a>
<a class="sourceLine" id="cb14-56" data-line-number="56"></a>
<a class="sourceLine" id="cb14-57" data-line-number="57"><span class="co">## Add points to denote the arbidol controls</span></a>
<a class="sourceLine" id="cb14-58" data-line-number="58"><span class="kw">stripchart</span>(Vlog2R <span class="op">~</span><span class="st"> </span>Plate, <span class="dt">vertical =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb14-59" data-line-number="59">           <span class="dt">data =</span> inhibTable[arbidolWells, ],</a>
<a class="sourceLine" id="cb14-60" data-line-number="60">           <span class="dt">method =</span> <span class="st">&quot;jitter&quot;</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>, <span class="dt">cex =</span> <span class="fl">0.7</span>, </a>
<a class="sourceLine" id="cb14-61" data-line-number="61">           <span class="dt">col =</span> markColor[<span class="st">&quot;Arbidol&quot;</span>], <span class="dt">pch =</span> markPCh[<span class="st">&quot;Arbidol&quot;</span>])</a>
<a class="sourceLine" id="cb14-62" data-line-number="62"></a>
<a class="sourceLine" id="cb14-63" data-line-number="63"><span class="kw">legend</span>(<span class="st">&quot;bottomleft&quot;</span>, </a>
<a class="sourceLine" id="cb14-64" data-line-number="64">       <span class="dt">title =</span> <span class="st">&quot;Markers&quot;</span>, </a>
<a class="sourceLine" id="cb14-65" data-line-number="65">       <span class="dt">legend =</span> <span class="st">&quot;Arbidol&quot;</span>, </a>
<a class="sourceLine" id="cb14-66" data-line-number="66">       <span class="dt">col =</span> markColor[<span class="st">&quot;Arbidol&quot;</span>], </a>
<a class="sourceLine" id="cb14-67" data-line-number="67">       <span class="dt">pch =</span> markPCh[<span class="st">&quot;Arbidol&quot;</span>],</a>
<a class="sourceLine" id="cb14-68" data-line-number="68">       <span class="dt">cex =</span> <span class="fl">0.8</span>)</a></code></pre></div>
<div class="figure" style="text-align: center">
<img src="figures/touret_sars-cov-2_inhibitorsboxplots_per_plate_R_L-1.png" alt="Distribution of the viability ratio (left) and log(ratio) (right)  per plate. Top virus control (untreated infected cells); middle: treated cells; bottom: cell control (uninfected). Black plain circles: arbidol control duplicates. " width="100%" />
<p class="caption">
Distribution of the viability ratio (left) and log(ratio) (right) per plate. Top virus control (untreated infected cells); middle: treated cells; bottom: cell control (uninfected). Black plain circles: arbidol control duplicates.
</p>
</div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="kw">par</span>(par.ori)</a></code></pre></div>
<p>The barplots of log2-transformed viability measures show another indication for the possible existence of a plate bias: in plates 11 to 19, several molecules are associated to a much smaller viability than in any of the untreated cells. This might reflect a cytotoxic effect of the drug that would enforce the viral infection, but there is a priori no reason to expect such effects to be concentrated on the last plates.</p>
</div>
</div>
<div id="two-points-scaling-defining-a-plate-wise-relative-viability-v_mi" class="section level2">
<h2>Two-points scaling: defining a plate-wise relative viability (<span class="math inline">\(V_{m,i}\)</span>)</h2>
<p>A <strong>plate-wise relative viability</strong> <span class="math inline">\(V_{m,i}\)</span> is defined to indicate the viability of cells treated with a given molecule <span class="math inline">\(m\)</span> relative to the two controls f their plate (<span class="math inline">\(i\)</span>):</p>
<ul>
<li>virus control (<span class="math inline">\(vc\)</span>): infected untreated cells;</li>
<li>cell control (<span class="math inline">\(cc\)</span>): uninfected cells.</li>
</ul>
<p>It is computed as follows.</p>
<p><span class="math display">\[V_{m,i} = 100 \cdot \frac{L_{m,i} - L_{vc}}{L_{cc} - L_{vc}}\]</span></p>
<p>where <span class="math inline">\(L_{cc,i}\)</span> and <span class="math inline">\(L_{vc,i}\)</span> denote the median values of the log2(ratios) respectively obtained in cell controls and virus controls for plate <span class="math inline">\(i\)</span>.</p>
<p>The plate-wise relative viability <span class="math inline">\(V_{m,i}\)</span> is measured on a scale where</p>
<ul>
<li>0 corresponds to the median of infected untreated cells (virus control), and</li>
<li>100 to the median of uninfected cells (cell control).</li>
</ul>
<p>Note that <span class="math inline">\(V_{m,i}\)</span> values lower than 0 denote treatments with a lower viability than the untreated virus infection. This might result from various sources: experimental flucturations, cytotoxic effect of the drug or plate bias.</p>
<p><span class="math inline">\(V_{m,i}\)</span> can also take values higher than 100, denoting a highly efficient treatment.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="co">#### Compute relative viability from ratios ####</span></a>
<a class="sourceLine" id="cb16-2" data-line-number="2">inhibTable<span class="op">$</span>Vrel &lt;-<span class="st"> </span><span class="dv">100</span> <span class="op">*</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-3" data-line-number="3"><span class="st">  </span>(inhibTable<span class="op">$</span>Vratio <span class="op">-</span><span class="st"> </span>plateStat<span class="op">$</span>Rvc[inhibTable<span class="op">$</span>Plate]) <span class="op">/</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-4" data-line-number="4"><span class="st">    </span>(plateStat<span class="op">$</span>Rcc[inhibTable<span class="op">$</span>Plate] <span class="op">-</span><span class="st"> </span>plateStat<span class="op">$</span>Rvc[inhibTable<span class="op">$</span>Plate]) </a>
<a class="sourceLine" id="cb16-5" data-line-number="5"></a>
<a class="sourceLine" id="cb16-6" data-line-number="6"><span class="co">#### Compute relative viability from log-ratios ####</span></a>
<a class="sourceLine" id="cb16-7" data-line-number="7">inhibTable<span class="op">$</span>Vrel &lt;-<span class="st"> </span><span class="dv">100</span> <span class="op">*</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-8" data-line-number="8"><span class="st">  </span>(inhibTable<span class="op">$</span>Vlog2R <span class="op">-</span><span class="st"> </span>plateStat<span class="op">$</span>Lvc[inhibTable<span class="op">$</span>Plate]) <span class="op">/</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-9" data-line-number="9"><span class="st">    </span>(plateStat<span class="op">$</span>Lcc[inhibTable<span class="op">$</span>Plate] <span class="op">-</span><span class="st"> </span>plateStat<span class="op">$</span>Lvc[inhibTable<span class="op">$</span>Plate]) </a>
<a class="sourceLine" id="cb16-10" data-line-number="10"></a>
<a class="sourceLine" id="cb16-11" data-line-number="11"><span class="co"># hist(inhibTable$I, breaks = 100)</span></a>
<a class="sourceLine" id="cb16-12" data-line-number="12"><span class="co"># </span></a></code></pre></div>
<div id="relative-viability-boxplots" class="section level3">
<h3>Relative viability boxplots</h3>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="co">#### Boxplots of relative viability per plate ####</span></a>
<a class="sourceLine" id="cb17-2" data-line-number="2">VrFloor =<span class="st"> </span><span class="kw">floor</span>(<span class="kw">min</span>(inhibTable<span class="op">$</span>Vrel))</a>
<a class="sourceLine" id="cb17-3" data-line-number="3">VrCeiling =<span class="st"> </span><span class="kw">max</span>(inhibTable<span class="op">$</span>Vrel) <span class="op">*</span><span class="st"> </span><span class="fl">1.2</span></a>
<a class="sourceLine" id="cb17-4" data-line-number="4"></a>
<a class="sourceLine" id="cb17-5" data-line-number="5"><span class="co">## Box plot per plate and well type</span></a>
<a class="sourceLine" id="cb17-6" data-line-number="6"><span class="kw">boxplot</span>(Vrel <span class="op">~</span><span class="st"> </span>Plate <span class="op">+</span><span class="st"> </span>wellType, </a>
<a class="sourceLine" id="cb17-7" data-line-number="7">        <span class="dt">main =</span> <span class="st">&quot;Relative viability&quot;</span>,</a>
<a class="sourceLine" id="cb17-8" data-line-number="8">        <span class="dt">data =</span> inhibTable, </a>
<a class="sourceLine" id="cb17-9" data-line-number="9">        <span class="dt">las =</span> <span class="dv">1</span>, <span class="dt">col =</span> plateColor, </a>
<a class="sourceLine" id="cb17-10" data-line-number="10">        <span class="dt">xlab =</span> <span class="st">&quot;Vr = (R - Rvc) / (Rcc - Rvc)&quot;</span>, </a>
<a class="sourceLine" id="cb17-11" data-line-number="11">        <span class="dt">ylim =</span> <span class="kw">c</span>(VrFloor, VrCeiling),</a>
<a class="sourceLine" id="cb17-12" data-line-number="12">        <span class="dt">cex.axis =</span> <span class="fl">0.5</span>, <span class="dt">cex =</span> <span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb17-13" data-line-number="13">        <span class="dt">horizontal =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb17-14" data-line-number="14"><span class="kw">abline</span>(<span class="dt">v =</span> <span class="kw">seq</span>(<span class="dt">from =</span> VrFloor, <span class="dt">to =</span> VrCeiling, <span class="dt">by =</span> <span class="dv">5</span>), <span class="dt">col =</span> <span class="st">&quot;#EEEEEE&quot;</span>, <span class="dt">lty =</span> <span class="st">&quot;dashed&quot;</span>)</a>
<a class="sourceLine" id="cb17-15" data-line-number="15"><span class="kw">abline</span>(<span class="dt">v =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">-100</span>, <span class="dt">to =</span> <span class="dv">150</span>, <span class="dt">by =</span> <span class="dv">25</span>), <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>)</a>
<a class="sourceLine" id="cb17-16" data-line-number="16"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">legend =</span> <span class="kw">names</span>(plateColor), </a>
<a class="sourceLine" id="cb17-17" data-line-number="17">       <span class="dt">title =</span> <span class="st">&quot;Plate&quot;</span>, <span class="dt">fill =</span> plateColor, <span class="dt">cex =</span> <span class="fl">0.6</span>)</a>
<a class="sourceLine" id="cb17-18" data-line-number="18"></a>
<a class="sourceLine" id="cb17-19" data-line-number="19"><span class="co">## Add points to denote the arbidol controls</span></a>
<a class="sourceLine" id="cb17-20" data-line-number="20"><span class="kw">stripchart</span>(Vrel <span class="op">~</span><span class="st"> </span>Plate, <span class="dt">vertical =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb17-21" data-line-number="21">           <span class="dt">data =</span> inhibTable[arbidolWells, ],</a>
<a class="sourceLine" id="cb17-22" data-line-number="22">           <span class="dt">method =</span> <span class="st">&quot;jitter&quot;</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>, <span class="dt">cex =</span> <span class="fl">0.7</span>, </a>
<a class="sourceLine" id="cb17-23" data-line-number="23">           <span class="dt">col =</span> markColor[<span class="st">&quot;Arbidol&quot;</span>], <span class="dt">pch =</span> markPCh[<span class="st">&quot;Arbidol&quot;</span>])</a>
<a class="sourceLine" id="cb17-24" data-line-number="24"></a>
<a class="sourceLine" id="cb17-25" data-line-number="25"><span class="kw">legend</span>(<span class="st">&quot;bottomleft&quot;</span>, </a>
<a class="sourceLine" id="cb17-26" data-line-number="26">       <span class="dt">title =</span> <span class="st">&quot;Markers&quot;</span>, </a>
<a class="sourceLine" id="cb17-27" data-line-number="27">       <span class="dt">legend =</span> <span class="st">&quot;Arbidol&quot;</span>, </a>
<a class="sourceLine" id="cb17-28" data-line-number="28">       <span class="dt">col =</span> markColor[<span class="st">&quot;Arbidol&quot;</span>], </a>
<a class="sourceLine" id="cb17-29" data-line-number="29">       <span class="dt">pch =</span> markPCh[<span class="st">&quot;Arbidol&quot;</span>],</a>
<a class="sourceLine" id="cb17-30" data-line-number="30">       <span class="dt">cex =</span> <span class="fl">0.8</span>)</a></code></pre></div>
<div class="figure" style="text-align: center">
<img src="figures/touret_sars-cov-2_inhibitorsboxplots_per_plate_I-1.png" alt="Distribution of relative viability (I) values per plate. Top virus control (untreated infected cells); middle: treated cells; bottom: cell control (uninfected). Black plain circles: arbidol control duplicates.  " width="80%" />
<p class="caption">
Distribution of relative viability (I) values per plate. Top virus control (untreated infected cells); middle: treated cells; bottom: cell control (uninfected). Black plain circles: arbidol control duplicates.
</p>
</div>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="kw">par</span>(par.ori)</a></code></pre></div>
<p>The box plots show that the relative viability standardises the measures by positioning each treatment relative to two milestones of its own plate:</p>
<ul>
<li>the median virus control (0)</li>
<li>the cell control (100)</li>
</ul>
<p>The virus controls are well regrouped in the range of smaller <span class="math inline">\(v_r\)</span> values, except for plate 17.</p>
<p>The cell controls occupy the high range (their first quartile is higher than 80) and are quite compactly grouped around 100.</p>
<p>However, we still observe a strong difference between plates 11-19 and the other plates:</p>
<ul>
<li>their median is mich higher than for the plates 1 to 10;</li>
<li>they also show a much wider inter-quartile rectangle, denoting a wide dispersion of values on this plate;</li>
<li>for plates 11 and 13-19, this wider dispersion is even visible for the virus controls (untreated infected cells), and it is thus unlikely that it results from the particular molecules sampled on this second half of the plates.</li>
</ul>
<p>We thus need a way to perform a between-plates standardization of the variance.</p>
</div>
<div id="dot-plots-relative-viability" class="section level3">
<h3>Dot plots: relative viability</h3>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="co">#### Dot plots of the relative viability ####</span></a>
<a class="sourceLine" id="cb19-2" data-line-number="2">VrFloor &lt;-<span class="st"> </span><span class="kw">floor</span>(<span class="kw">min</span>(inhibTable<span class="op">$</span>Vrel <span class="op">/</span><span class="st"> </span><span class="dv">10</span>)) <span class="op">*</span><span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb19-3" data-line-number="3">VrCeiling &lt;-<span class="st"> </span><span class="kw">max</span>(inhibTable<span class="op">$</span>Vrel) <span class="op">*</span><span class="st"> </span><span class="fl">1.1</span></a>
<a class="sourceLine" id="cb19-4" data-line-number="4"></a>
<a class="sourceLine" id="cb19-5" data-line-number="5"><span class="co">## Virus control plots</span></a>
<a class="sourceLine" id="cb19-6" data-line-number="6"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb19-7" data-line-number="7"><span class="kw">plot</span>(inhibTable[wellType <span class="op">==</span><span class="st"> &quot;virusCtl&quot;</span>, <span class="st">&quot;Vrel&quot;</span>],</a>
<a class="sourceLine" id="cb19-8" data-line-number="8">     <span class="dt">main =</span> <span class="st">&quot;Virus control (infected, untreated)&quot;</span>,</a>
<a class="sourceLine" id="cb19-9" data-line-number="9">     <span class="dt">xlab =</span> <span class="st">&quot;Replicates, sorted per plate&quot;</span>,</a>
<a class="sourceLine" id="cb19-10" data-line-number="10">     <span class="dt">ylab =</span> <span class="st">&quot;Vr = (R - Rvc) / (Rcc - Rvc)&quot;</span>,</a>
<a class="sourceLine" id="cb19-11" data-line-number="11">     <span class="dt">col =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;virusCtl&quot;</span>, <span class="st">&quot;color&quot;</span>],</a>
<a class="sourceLine" id="cb19-12" data-line-number="12">     <span class="dt">pch =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;virusCtl&quot;</span>, <span class="st">&quot;pch&quot;</span>],</a>
<a class="sourceLine" id="cb19-13" data-line-number="13">     <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, (nbPlates <span class="op">*</span><span class="st"> </span><span class="dv">6</span> <span class="op">*</span><span class="st"> </span><span class="fl">1.05</span>)),</a>
<a class="sourceLine" id="cb19-14" data-line-number="14">     <span class="dt">ylim =</span> <span class="kw">c</span>(VrFloor, VrCeiling),</a>
<a class="sourceLine" id="cb19-15" data-line-number="15">     <span class="dt">panel.first =</span> <span class="kw">c</span>(<span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>), </a>
<a class="sourceLine" id="cb19-16" data-line-number="16">                     <span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">100</span>, <span class="dt">col =</span> <span class="st">&quot;#008800&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>),</a>
<a class="sourceLine" id="cb19-17" data-line-number="17">                     <span class="kw">abline</span>(<span class="dt">h =</span> <span class="kw">seq</span>(VrFloor,VrCeiling, <span class="dv">10</span>), <span class="dt">col =</span> <span class="st">&quot;#DDDDDD&quot;</span>),</a>
<a class="sourceLine" id="cb19-18" data-line-number="18">                     <span class="kw">abline</span>(<span class="dt">v =</span> (<span class="dv">0</span><span class="op">:</span><span class="dv">19</span>) <span class="op">*</span><span class="st"> </span><span class="dv">6</span>, <span class="dt">col =</span> <span class="st">&quot;#999999&quot;</span>)</a>
<a class="sourceLine" id="cb19-19" data-line-number="19">                     ),</a>
<a class="sourceLine" id="cb19-20" data-line-number="20">     <span class="dt">xaxt =</span> <span class="st">&quot;n&quot;</span>,</a>
<a class="sourceLine" id="cb19-21" data-line-number="21">     <span class="dt">las =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb19-22" data-line-number="22">     <span class="dt">cex =</span> <span class="fl">0.5</span></a>
<a class="sourceLine" id="cb19-23" data-line-number="23">     )</a>
<a class="sourceLine" id="cb19-24" data-line-number="24"><span class="kw">mtext</span>(plateNumbers, <span class="dt">at =</span> (<span class="dv">1</span><span class="op">:</span><span class="dv">19</span>) <span class="op">*</span><span class="st"> </span><span class="dv">6</span> <span class="op">-</span><span class="st"> </span><span class="dv">3</span>, <span class="dt">side =</span> <span class="dv">1</span>, <span class="dt">col =</span> plateColor)</a>
<a class="sourceLine" id="cb19-25" data-line-number="25"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, </a>
<a class="sourceLine" id="cb19-26" data-line-number="26">       <span class="dt">legend =</span> <span class="kw">names</span>(plateColor), </a>
<a class="sourceLine" id="cb19-27" data-line-number="27">       <span class="dt">col =</span> plateColor, <span class="dt">pch =</span> <span class="dv">1</span>, </a>
<a class="sourceLine" id="cb19-28" data-line-number="28">       <span class="dt">cex =</span> <span class="fl">0.7</span>)</a>
<a class="sourceLine" id="cb19-29" data-line-number="29"></a>
<a class="sourceLine" id="cb19-30" data-line-number="30"><span class="co">## Treated cells</span></a>
<a class="sourceLine" id="cb19-31" data-line-number="31"><span class="kw">plot</span>(inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;Vrel&quot;</span>],</a>
<a class="sourceLine" id="cb19-32" data-line-number="32">     <span class="dt">main =</span> <span class="st">&quot;Relative viability (Vr)&quot;</span>,</a>
<a class="sourceLine" id="cb19-33" data-line-number="33">     <span class="dt">xlab =</span> <span class="st">&quot;Molecules&quot;</span>,</a>
<a class="sourceLine" id="cb19-34" data-line-number="34">     <span class="dt">ylab =</span> <span class="st">&quot;relative viability&quot;</span>,</a>
<a class="sourceLine" id="cb19-35" data-line-number="35">     <span class="dt">col =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;color&quot;</span>],</a>
<a class="sourceLine" id="cb19-36" data-line-number="36">     <span class="dt">pch =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;pch&quot;</span>],</a>
<a class="sourceLine" id="cb19-37" data-line-number="37">     <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, (nbPlates <span class="op">*</span><span class="st"> </span><span class="dv">80</span> <span class="op">*</span><span class="st"> </span><span class="fl">1.05</span>)),</a>
<a class="sourceLine" id="cb19-38" data-line-number="38">     <span class="dt">ylim =</span> <span class="kw">c</span>(VrFloor, VrCeiling),</a>
<a class="sourceLine" id="cb19-39" data-line-number="39">     <span class="dt">panel.first =</span> <span class="kw">c</span>(<span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>), </a>
<a class="sourceLine" id="cb19-40" data-line-number="40">                     <span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">100</span>, <span class="dt">col =</span> <span class="st">&quot;#008800&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>),</a>
<a class="sourceLine" id="cb19-41" data-line-number="41">                     <span class="kw">abline</span>(<span class="dt">h =</span> <span class="kw">seq</span>(VrFloor,VrCeiling, <span class="dv">10</span>), <span class="dt">col =</span> <span class="st">&quot;#DDDDDD&quot;</span>),</a>
<a class="sourceLine" id="cb19-42" data-line-number="42">                     <span class="kw">abline</span>(<span class="dt">v =</span> (<span class="dv">0</span><span class="op">:</span><span class="dv">19</span>) <span class="op">*</span><span class="st"> </span><span class="dv">80</span>, <span class="dt">col =</span> <span class="st">&quot;#999999&quot;</span>)</a>
<a class="sourceLine" id="cb19-43" data-line-number="43">                     ),</a>
<a class="sourceLine" id="cb19-44" data-line-number="44">     <span class="dt">xaxt =</span> <span class="st">&quot;n&quot;</span>,</a>
<a class="sourceLine" id="cb19-45" data-line-number="45">     <span class="dt">las =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb19-46" data-line-number="46">     <span class="dt">cex =</span> <span class="fl">0.5</span></a>
<a class="sourceLine" id="cb19-47" data-line-number="47">     )</a>
<a class="sourceLine" id="cb19-48" data-line-number="48"><span class="kw">mtext</span>(plateNumbers, <span class="dt">at =</span> (<span class="dv">1</span><span class="op">:</span><span class="dv">19</span>) <span class="op">*</span><span class="st"> </span><span class="dv">80</span> <span class="op">-</span><span class="st"> </span><span class="dv">40</span>, <span class="dt">side =</span> <span class="dv">1</span>, <span class="dt">col =</span> plateColor)</a>
<a class="sourceLine" id="cb19-49" data-line-number="49"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, </a>
<a class="sourceLine" id="cb19-50" data-line-number="50">       <span class="dt">legend =</span> <span class="kw">names</span>(plateColor), </a>
<a class="sourceLine" id="cb19-51" data-line-number="51">       <span class="dt">col =</span> plateColor, <span class="dt">pch =</span> <span class="dv">1</span>, </a>
<a class="sourceLine" id="cb19-52" data-line-number="52">       <span class="dt">cex =</span> <span class="fl">0.6</span>)</a>
<a class="sourceLine" id="cb19-53" data-line-number="53"></a>
<a class="sourceLine" id="cb19-54" data-line-number="54"><span class="co">## Cell control</span></a>
<a class="sourceLine" id="cb19-55" data-line-number="55"><span class="kw">plot</span>(inhibTable[wellType <span class="op">==</span><span class="st"> &quot;cellCtl&quot;</span>, <span class="st">&quot;Vrel&quot;</span>],</a>
<a class="sourceLine" id="cb19-56" data-line-number="56">     <span class="dt">main =</span> <span class="st">&quot;Cell control (uninfected)&quot;</span>,</a>
<a class="sourceLine" id="cb19-57" data-line-number="57">     <span class="dt">xlab =</span> <span class="st">&quot;Replicates, sorted per plate&quot;</span>,</a>
<a class="sourceLine" id="cb19-58" data-line-number="58">     <span class="dt">ylab =</span> <span class="st">&quot;relative viability&quot;</span>,</a>
<a class="sourceLine" id="cb19-59" data-line-number="59">     <span class="dt">col =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;cellCtl&quot;</span>, <span class="st">&quot;color&quot;</span>],</a>
<a class="sourceLine" id="cb19-60" data-line-number="60">     <span class="dt">pch =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;cellCtl&quot;</span>, <span class="st">&quot;pch&quot;</span>],</a>
<a class="sourceLine" id="cb19-61" data-line-number="61">     <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, (nbPlates <span class="op">*</span><span class="st"> </span><span class="dv">8</span> <span class="op">*</span><span class="st"> </span><span class="fl">1.05</span>)),</a>
<a class="sourceLine" id="cb19-62" data-line-number="62">     <span class="dt">ylim =</span> <span class="kw">c</span>(VrFloor, VrCeiling),</a>
<a class="sourceLine" id="cb19-63" data-line-number="63">     <span class="dt">panel.first =</span> <span class="kw">c</span>(<span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>), </a>
<a class="sourceLine" id="cb19-64" data-line-number="64">                     <span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">100</span>, <span class="dt">col =</span> <span class="st">&quot;#008800&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>),</a>
<a class="sourceLine" id="cb19-65" data-line-number="65">                     <span class="kw">abline</span>(<span class="dt">h =</span> <span class="kw">seq</span>(VrFloor,VrCeiling, <span class="dv">10</span>), <span class="dt">col =</span> <span class="st">&quot;#DDDDDD&quot;</span>),</a>
<a class="sourceLine" id="cb19-66" data-line-number="66">                     <span class="kw">abline</span>(<span class="dt">v =</span> (<span class="dv">0</span><span class="op">:</span><span class="dv">19</span>) <span class="op">*</span><span class="st"> </span><span class="dv">8</span>, <span class="dt">col =</span> <span class="st">&quot;#999999&quot;</span>)</a>
<a class="sourceLine" id="cb19-67" data-line-number="67">                     ),</a>
<a class="sourceLine" id="cb19-68" data-line-number="68">     <span class="dt">xaxt =</span> <span class="st">&quot;n&quot;</span>,</a>
<a class="sourceLine" id="cb19-69" data-line-number="69">     <span class="dt">las =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb19-70" data-line-number="70">     <span class="dt">cex =</span> <span class="fl">0.5</span></a>
<a class="sourceLine" id="cb19-71" data-line-number="71">     )</a>
<a class="sourceLine" id="cb19-72" data-line-number="72"><span class="kw">mtext</span>(plateNumbers, <span class="dt">at =</span> (<span class="dv">1</span><span class="op">:</span><span class="dv">19</span>) <span class="op">*</span><span class="st"> </span><span class="dv">8</span> <span class="op">-</span><span class="st"> </span><span class="dv">4</span>, <span class="dt">side =</span> <span class="dv">1</span>, <span class="dt">col =</span> plateColor)</a>
<a class="sourceLine" id="cb19-73" data-line-number="73"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, </a>
<a class="sourceLine" id="cb19-74" data-line-number="74">       <span class="dt">legend =</span> <span class="kw">names</span>(plateColor), </a>
<a class="sourceLine" id="cb19-75" data-line-number="75">       <span class="dt">col =</span> plateColor, <span class="dt">pch =</span> <span class="dv">1</span>, </a>
<a class="sourceLine" id="cb19-76" data-line-number="76">       <span class="dt">cex =</span> <span class="fl">0.7</span>)</a>
<a class="sourceLine" id="cb19-77" data-line-number="77"><span class="co"># names(supTable)</span></a>
<a class="sourceLine" id="cb19-78" data-line-number="78"></a>
<a class="sourceLine" id="cb19-79" data-line-number="79"><span class="co">## Rank plot</span></a>
<a class="sourceLine" id="cb19-80" data-line-number="80">VrRank &lt;-<span class="st"> </span><span class="kw">order</span>(inhibTable<span class="op">$</span>Vrel, <span class="dt">decreasing =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb19-81" data-line-number="81"><span class="kw">plot</span>(inhibTable[VrRank, <span class="st">&quot;Vrel&quot;</span>],</a>
<a class="sourceLine" id="cb19-82" data-line-number="82">     <span class="dt">main =</span> <span class="st">&quot;Ranked relative viability values&quot;</span>,</a>
<a class="sourceLine" id="cb19-83" data-line-number="83">     <span class="dt">xlab =</span> <span class="st">&quot;Molecules (ranked by relative viability)&quot;</span>,</a>
<a class="sourceLine" id="cb19-84" data-line-number="84">     <span class="dt">ylab =</span> <span class="st">&quot;relative viability&quot;</span>,</a>
<a class="sourceLine" id="cb19-85" data-line-number="85">     <span class="dt">col =</span> inhibTable[VrRank, <span class="st">&quot;color&quot;</span>],</a>
<a class="sourceLine" id="cb19-86" data-line-number="86">     <span class="dt">pch =</span> inhibTable[VrRank, <span class="st">&quot;pch&quot;</span>],</a>
<a class="sourceLine" id="cb19-87" data-line-number="87">     <span class="dt">cex =</span> <span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb19-88" data-line-number="88">     <span class="dt">panel.first =</span> <span class="kw">grid</span>(),</a>
<a class="sourceLine" id="cb19-89" data-line-number="89">     <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="kw">length</span>(VrRank) <span class="op">*</span><span class="st"> </span><span class="fl">1.05</span>)</a>
<a class="sourceLine" id="cb19-90" data-line-number="90">     )</a>
<a class="sourceLine" id="cb19-91" data-line-number="91"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb19-92" data-line-number="92"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">100</span>, <span class="dt">col =</span> <span class="st">&quot;#008800&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb19-93" data-line-number="93"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, </a>
<a class="sourceLine" id="cb19-94" data-line-number="94">       <span class="dt">legend =</span> <span class="kw">names</span>(plateColor), </a>
<a class="sourceLine" id="cb19-95" data-line-number="95">       <span class="dt">col =</span> plateColor, <span class="dt">pch =</span> <span class="dv">1</span>, </a>
<a class="sourceLine" id="cb19-96" data-line-number="96">       <span class="dt">cex =</span> <span class="fl">0.4</span>)</a></code></pre></div>
<div class="figure" style="text-align: center">
<img src="figures/touret_sars-cov-2_inhibitorsdotplots_I-1.png" alt="Values of the plate-wise relative viability for all the tested molecules. Molecules are colored according to the plate number. A: virus control (infected untreated); B: treated cells; C: cell control (untreated cells); D: ranked values (all types). Plain triangles: virus control (untreated infected cells). Black plain circles: arbidol control duplicates per plate. Orange square: Hydroxychloroquine sulfate. " width="80%" />
<p class="caption">
Values of the plate-wise relative viability for all the tested molecules. Molecules are colored according to the plate number. A: virus control (infected untreated); B: treated cells; C: cell control (untreated cells); D: ranked values (all types). Plain triangles: virus control (untreated infected cells). Black plain circles: arbidol control duplicates per plate. Orange square: Hydroxychloroquine sulfate.
</p>
</div>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</a></code></pre></div>
</div>
</div>
<div id="iqr-based-standardization" class="section level2">
<h2>IQR-based standardization</h2>
<div id="plate-wise-iqr-standardized-viability" class="section level3">
<h3>Plate-wise IQR-standardized viability</h3>
<p>To take into account the between-plate differences in variance denoted above, we compute a z-scores from the original value.</p>
<ul>
<li>centering: substract an estimator of the plate-wise mean <span class="math inline">\(\hat{\mu}\)</span>;</li>
<li>scaling: divide by an estimator of the plate-wise standard deviation (<span class="math inline">\(\hat{\sigma_i}\)</span>)</li>
</ul>
<p><span class="math display">\[z_{c,i} = \frac{V_c - \hat{\mu_i}}{\hat{\sigma_i}}\]</span></p>
<p>where</p>
<ul>
<li><span class="math inline">\(V_c\)</span> is the viability for molecule <span class="math inline">\(c\)</span>;</li>
<li><span class="math inline">\(\hat{\mu_i}\)</span> is the estimate for the mean viability of all the treated cells in plate <span class="math inline">\(i\)</span>;</li>
<li><span class="math inline">\(\hat{\sigma_i}\)</span> is the estimate for the standard deviation of all the treated cells in plate <span class="math inline">\(i\)</span>;</li>
</ul>
<p>In classical statistics, the estimators of centrality and dispersion are derived from the sample mean and standard deviation, respectively:</p>
<ul>
<li>the population mean is used as maximum likelihood estimator of the population: <span class="math inline">\(\hat{\mu} = \bar{x}\)</span></li>
<li>the population standard deviation (<span class="math inline">\(\sigma\)</span>) is estimated with the sample standard deviation, corrected for the systematic bias: <span class="math inline">\(\hat{\sigma} = \sqrt{n/(n-1)} \cdot s\)</span>)</li>
</ul>
<p>However, we must be careful because each plate supposedly contain a mixture of inactive (no inhibitory effect) and active (inhibitory) molecules. The previous histograms and box plots show that these inhibitory molecules appear as statistiacal outliers (with very high viability values) and would thus strongly bias the estimation of the background variance (the variance due to fluctuations in absence of treatment).</p>
<p>One possibility would be to use the standard deviation of the virus control to this purpose, but this would leat to instable estimators, since they would be based on 6 points per plate. In addition, the boxplots show that the variance among treated cells is higher than the virus control, suggesting some generic effect of the treatments.</p>
<p>Another strategy is to consider that the variance (and standard deviation) can be estimated from the bulk of treated cell viability measures themselves, and to use <strong>robust estimators</strong> of the central tendency (i.e. the plate-wise median) and dispersion (i.e. the plate-wise interquartile range).</p>
<p>This approach relies on the assumption that, <em>in each plate</em>, the number of active molecule (statistical outliers). Since teach plate contains tests of 80 molecules, there are 19 molecules above the third quartile (<span class="math inline">\(Q3\)</span>). However, it has to be noted that the plates were manufactured with some grouping of molecules of the same structural family. It might thus happen that some plates contain more than 19 molecules having an inhibitory effect. Such a situation would result in a loss of sensitivity, since the presence of active molecules in the inter-quartile range would lead to over-estimate the dispersion.</p>
<p>An alternative is to estimate the dispersion based on the range between the first quartile (<span class="math inline">\(Q1\)</span>) and the median (<span class="math inline">\(\tilde{x}\)</span>) of each plate.</p>
<p>In summary, we compute robust estimators, in order to avoid the effect of outliers (in this case, the suspected outliers are the molecules having an actual inhibitory effect). To this purpose, we use:</p>
<ul>
<li>the median plate-wise relative viability for all the molecules (<span class="math inline">\(\tilde{I_i}\)</span>) to estimate the mean</li>
<li>the plate-wise standardized inter-quantile range; (<span class="math inline">\(IQR_i\)</span>) standardized by the normal <span class="math inline">\(IQR\)</span> to estimate the standard deviation.</li>
</ul>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="co">#### Compute plate-wise statistics ####</span></a>
<a class="sourceLine" id="cb21-2" data-line-number="2">statPerPlate &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb21-3" data-line-number="3">  <span class="dt">Plate =</span> plateNumbers,</a>
<a class="sourceLine" id="cb21-4" data-line-number="4">  <span class="dt">TrMean =</span> <span class="kw">as.vector</span>(<span class="kw">by</span>(</a>
<a class="sourceLine" id="cb21-5" data-line-number="5">    <span class="dt">data =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;Vrel&quot;</span>], </a>
<a class="sourceLine" id="cb21-6" data-line-number="6">    <span class="dt">INDICES =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;Plate&quot;</span>], </a>
<a class="sourceLine" id="cb21-7" data-line-number="7">    <span class="dt">FUN =</span> mean)),</a>
<a class="sourceLine" id="cb21-8" data-line-number="8">  <span class="dt">TrSD =</span> <span class="kw">as.vector</span>(<span class="kw">by</span>(</a>
<a class="sourceLine" id="cb21-9" data-line-number="9">    <span class="dt">data =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;Vrel&quot;</span>], </a>
<a class="sourceLine" id="cb21-10" data-line-number="10">    <span class="dt">INDICES =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;Plate&quot;</span>], </a>
<a class="sourceLine" id="cb21-11" data-line-number="11">    <span class="dt">FUN =</span> sd)),</a>
<a class="sourceLine" id="cb21-12" data-line-number="12">  <span class="dt">TrMedian =</span> <span class="kw">as.vector</span>(<span class="kw">by</span>(</a>
<a class="sourceLine" id="cb21-13" data-line-number="13">    <span class="dt">data =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;Vrel&quot;</span>], </a>
<a class="sourceLine" id="cb21-14" data-line-number="14">    <span class="dt">INDICES =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;Plate&quot;</span>], </a>
<a class="sourceLine" id="cb21-15" data-line-number="15">    <span class="dt">FUN =</span> median)),</a>
<a class="sourceLine" id="cb21-16" data-line-number="16">  <span class="dt">vcMedian =</span> <span class="kw">as.vector</span>(<span class="kw">by</span>(</a>
<a class="sourceLine" id="cb21-17" data-line-number="17">    <span class="dt">data =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;virusCtl&quot;</span>, <span class="st">&quot;Vrel&quot;</span>], </a>
<a class="sourceLine" id="cb21-18" data-line-number="18">    <span class="dt">INDICES =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;virusCtl&quot;</span>, <span class="st">&quot;Plate&quot;</span>], </a>
<a class="sourceLine" id="cb21-19" data-line-number="19">    <span class="dt">FUN =</span> median)),</a>
<a class="sourceLine" id="cb21-20" data-line-number="20">  <span class="dt">ccMedian =</span> <span class="kw">as.vector</span>(<span class="kw">by</span>(</a>
<a class="sourceLine" id="cb21-21" data-line-number="21">    <span class="dt">data =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;cellCtl&quot;</span>, <span class="st">&quot;Vrel&quot;</span>], </a>
<a class="sourceLine" id="cb21-22" data-line-number="22">    <span class="dt">INDICES =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;cellCtl&quot;</span>, <span class="st">&quot;Plate&quot;</span>], </a>
<a class="sourceLine" id="cb21-23" data-line-number="23">    <span class="dt">FUN =</span> median)),</a>
<a class="sourceLine" id="cb21-24" data-line-number="24">  <span class="dt">arbidolMean =</span> <span class="kw">as.vector</span>(<span class="kw">by</span>(</a>
<a class="sourceLine" id="cb21-25" data-line-number="25">    <span class="dt">data =</span> inhibTable[arbidolWells, <span class="st">&quot;Vrel&quot;</span>], </a>
<a class="sourceLine" id="cb21-26" data-line-number="26">    <span class="dt">INDICES =</span> inhibTable[arbidolWells, <span class="st">&quot;Plate&quot;</span>], </a>
<a class="sourceLine" id="cb21-27" data-line-number="27">    <span class="dt">FUN =</span> mean)),</a>
<a class="sourceLine" id="cb21-28" data-line-number="28">  <span class="dt">TrMin =</span> <span class="kw">as.vector</span>(<span class="kw">by</span>(    </a>
<a class="sourceLine" id="cb21-29" data-line-number="29">    <span class="dt">data =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;Vrel&quot;</span>], </a>
<a class="sourceLine" id="cb21-30" data-line-number="30">    <span class="dt">INDICES =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;Plate&quot;</span>], </a>
<a class="sourceLine" id="cb21-31" data-line-number="31">    <span class="dt">FUN =</span> min)),</a>
<a class="sourceLine" id="cb21-32" data-line-number="32">  <span class="dt">TrMax =</span> <span class="kw">as.vector</span>(<span class="kw">by</span>(</a>
<a class="sourceLine" id="cb21-33" data-line-number="33">    <span class="dt">data =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;Vrel&quot;</span>], </a>
<a class="sourceLine" id="cb21-34" data-line-number="34">    <span class="dt">INDICES =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;Plate&quot;</span>], </a>
<a class="sourceLine" id="cb21-35" data-line-number="35">    <span class="dt">FUN =</span> max)),</a>
<a class="sourceLine" id="cb21-36" data-line-number="36">  <span class="dt">TrQ1 =</span> <span class="kw">as.vector</span>(<span class="kw">by</span>(</a>
<a class="sourceLine" id="cb21-37" data-line-number="37">    <span class="dt">data =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;Vrel&quot;</span>], </a>
<a class="sourceLine" id="cb21-38" data-line-number="38">    <span class="dt">INDICES =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;Plate&quot;</span>], </a>
<a class="sourceLine" id="cb21-39" data-line-number="39">    <span class="dt">FUN =</span> quantile, <span class="dt">probs =</span> <span class="fl">0.25</span>)),</a>
<a class="sourceLine" id="cb21-40" data-line-number="40">  <span class="dt">TrQ3 =</span> <span class="kw">as.vector</span>(<span class="kw">by</span>(</a>
<a class="sourceLine" id="cb21-41" data-line-number="41">    <span class="dt">data =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;Vrel&quot;</span>], </a>
<a class="sourceLine" id="cb21-42" data-line-number="42">    <span class="dt">INDICES =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;Plate&quot;</span>], </a>
<a class="sourceLine" id="cb21-43" data-line-number="43">    <span class="dt">FUN =</span> quantile, <span class="dt">probs =</span> <span class="fl">0.75</span>)),</a>
<a class="sourceLine" id="cb21-44" data-line-number="44">  <span class="dt">TrIQR =</span> <span class="kw">as.vector</span>(<span class="kw">by</span>(    <span class="dt">data =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;Vrel&quot;</span>], </a>
<a class="sourceLine" id="cb21-45" data-line-number="45">    <span class="dt">INDICES =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;Plate&quot;</span>], </a>
<a class="sourceLine" id="cb21-46" data-line-number="46">    <span class="dt">FUN =</span> IQR))</a>
<a class="sourceLine" id="cb21-47" data-line-number="47">)</a>
<a class="sourceLine" id="cb21-48" data-line-number="48"><span class="kw">rownames</span>(statPerPlate) &lt;-<span class="st"> </span>statPerPlate<span class="op">$</span>Plate</a></code></pre></div>
<p>We define a plate-wise scaling factor from the interquantile range, standardized by the inter-quartile range of a Gaussian distribution.</p>
<p><span class="math display">\[S_i = \frac{Q3_N - Q1_N}{Q3_i - Q3_i} = \frac{1.349}{Q3_i - Q3_i}\]</span></p>
<p>Where <span class="math inline">\(Q1\)</span> and <span class="math inline">\(Q3\)</span> denote the first and third quartile, <span class="math inline">\(N\)</span> the Normal distribution, and <span class="math inline">\(i\)</span> is the plate number.</p>
<p>The relative viabilities of each plate are then multiplied by the corresponding scaling factor to obtain plate-wise standardized values (<span class="math inline">\(z\)</span>), which will have the same inter-quartile range as the normal distribution.</p>
<p><span class="math display">\[z_{c,i} = \frac{I_{m,i} - \hat{\mu_i}}{\hat{\sigma_i}} = (I_{m,i} - \tilde{I_i}) \frac{Q3_N - Q1_N}{Q3_i - Q3_i} = (v_c - \tilde{v_i}) \cdot S_i\]</span></p>
<p>where</p>
<ul>
<li><span class="math inline">\(Q1_N\)</span> and <span class="math inline">\(Q3_N\)</span> are the first and third quartiles of the normal distribution,</li>
<li><span class="math inline">\(Q1_i\)</span> and <span class="math inline">\(Q3_i\)</span> are the first and third quartiles of the relative viability for all the molecules tested on plate <span class="math inline">\(i\)</span>,</li>
</ul>
<p>The table below indicates the plate-wise statistics and scaling factor.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="co">#### Scaling factor per plate ####</span></a>
<a class="sourceLine" id="cb22-2" data-line-number="2"></a>
<a class="sourceLine" id="cb22-3" data-line-number="3"><span class="co">## Compute scaling factor based on the standardized inter-quartile range.</span></a>
<a class="sourceLine" id="cb22-4" data-line-number="4">statPerPlate<span class="op">$</span>scaling &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb22-5" data-line-number="5"><span class="st">  </span>(<span class="kw">qnorm</span>(<span class="dt">p =</span> <span class="fl">0.75</span>) <span class="op">-</span><span class="st"> </span><span class="kw">qnorm</span>(<span class="dt">p =</span> <span class="fl">0.25</span>)) <span class="op">/</span></a>
<a class="sourceLine" id="cb22-6" data-line-number="6"><span class="st">  </span>(statPerPlate<span class="op">$</span>TrQ3 <span class="op">-</span><span class="st"> </span>statPerPlate<span class="op">$</span>TrQ1) </a>
<a class="sourceLine" id="cb22-7" data-line-number="7"></a>
<a class="sourceLine" id="cb22-8" data-line-number="8"><span class="kw">kable</span>(statPerPlate, <span class="dt">caption =</span> <span class="st">&quot;Plate-wise statistics of treated cells. Column prefixes: Tr = treated cells; cc = cell control (uninfected cells); vc = virus control (infected, untreated cells). &quot;</span>)</a></code></pre></div>
<table>
<caption>Plate-wise statistics of treated cells. Column prefixes: Tr = treated cells; cc = cell control (uninfected cells); vc = virus control (infected, untreated cells).</caption>
<thead>
<tr class="header">
<th align="right">Plate</th>
<th align="right">TrMean</th>
<th align="right">TrSD</th>
<th align="right">TrMedian</th>
<th align="right">vcMedian</th>
<th align="right">ccMedian</th>
<th align="right">arbidolMean</th>
<th align="right">TrMin</th>
<th align="right">TrMax</th>
<th align="right">TrQ1</th>
<th align="right">TrQ3</th>
<th align="right">TrIQR</th>
<th align="right">scaling</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">12.90684</td>
<td align="right">28.85439</td>
<td align="right">2.589052</td>
<td align="right">0</td>
<td align="right">100</td>
<td align="right">86.95038</td>
<td align="right">-25.59828</td>
<td align="right">96.51344</td>
<td align="right">-1.7821824</td>
<td align="right">13.16103</td>
<td align="right">14.94322</td>
<td align="right">0.0902737</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">17.39446</td>
<td align="right">27.93057</td>
<td align="right">16.069910</td>
<td align="right">0</td>
<td align="right">100</td>
<td align="right">83.09473</td>
<td align="right">-25.25135</td>
<td align="right">85.57929</td>
<td align="right">-0.5736503</td>
<td align="right">26.71207</td>
<td align="right">27.28572</td>
<td align="right">0.0494390</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">16.83370</td>
<td align="right">18.63510</td>
<td align="right">11.395323</td>
<td align="right">0</td>
<td align="right">100</td>
<td align="right">75.08391</td>
<td align="right">-19.15266</td>
<td align="right">79.09630</td>
<td align="right">6.5846565</td>
<td align="right">21.89036</td>
<td align="right">15.30570</td>
<td align="right">0.0881358</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">24.81053</td>
<td align="right">34.66755</td>
<td align="right">18.942453</td>
<td align="right">0</td>
<td align="right">100</td>
<td align="right">74.97339</td>
<td align="right">-26.98529</td>
<td align="right">95.77630</td>
<td align="right">3.5136062</td>
<td align="right">51.96317</td>
<td align="right">48.44957</td>
<td align="right">0.0278430</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">23.26384</td>
<td align="right">29.05021</td>
<td align="right">21.490158</td>
<td align="right">0</td>
<td align="right">100</td>
<td align="right">77.77693</td>
<td align="right">-22.65224</td>
<td align="right">95.78776</td>
<td align="right">6.7390393</td>
<td align="right">37.13402</td>
<td align="right">30.39498</td>
<td align="right">0.0443816</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">17.43508</td>
<td align="right">30.30878</td>
<td align="right">8.006709</td>
<td align="right">0</td>
<td align="right">100</td>
<td align="right">90.14721</td>
<td align="right">-21.90392</td>
<td align="right">93.95942</td>
<td align="right">-0.8851005</td>
<td align="right">33.63426</td>
<td align="right">34.51936</td>
<td align="right">0.0390789</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="right">21.08448</td>
<td align="right">30.61298</td>
<td align="right">11.384151</td>
<td align="right">0</td>
<td align="right">100</td>
<td align="right">79.78517</td>
<td align="right">-21.27708</td>
<td align="right">107.11582</td>
<td align="right">3.6549605</td>
<td align="right">28.72765</td>
<td align="right">25.07269</td>
<td align="right">0.0538027</td>
</tr>
<tr class="even">
<td align="right">8</td>
<td align="right">16.67873</td>
<td align="right">30.63601</td>
<td align="right">5.283791</td>
<td align="right">0</td>
<td align="right">100</td>
<td align="right">89.77955</td>
<td align="right">-26.97461</td>
<td align="right">110.48853</td>
<td align="right">-2.4830636</td>
<td align="right">27.03439</td>
<td align="right">29.51745</td>
<td align="right">0.0457011</td>
</tr>
<tr class="odd">
<td align="right">9</td>
<td align="right">16.31472</td>
<td align="right">25.35433</td>
<td align="right">7.863786</td>
<td align="right">0</td>
<td align="right">100</td>
<td align="right">85.92780</td>
<td align="right">-25.29322</td>
<td align="right">94.09538</td>
<td align="right">2.5641306</td>
<td align="right">19.27661</td>
<td align="right">16.71248</td>
<td align="right">0.0807169</td>
</tr>
<tr class="even">
<td align="right">10</td>
<td align="right">19.42648</td>
<td align="right">25.89632</td>
<td align="right">14.943992</td>
<td align="right">0</td>
<td align="right">100</td>
<td align="right">87.83983</td>
<td align="right">-25.54365</td>
<td align="right">94.03011</td>
<td align="right">2.5522727</td>
<td align="right">25.38238</td>
<td align="right">22.83011</td>
<td align="right">0.0590877</td>
</tr>
<tr class="odd">
<td align="right">11</td>
<td align="right">35.61332</td>
<td align="right">39.56404</td>
<td align="right">35.389084</td>
<td align="right">0</td>
<td align="right">100</td>
<td align="right">95.99690</td>
<td align="right">-76.49642</td>
<td align="right">111.03708</td>
<td align="right">14.4378585</td>
<td align="right">62.68187</td>
<td align="right">48.24401</td>
<td align="right">0.0279616</td>
</tr>
<tr class="even">
<td align="right">12</td>
<td align="right">43.11607</td>
<td align="right">30.50020</td>
<td align="right">44.454842</td>
<td align="right">0</td>
<td align="right">100</td>
<td align="right">94.35243</td>
<td align="right">-54.72326</td>
<td align="right">102.67258</td>
<td align="right">22.5882232</td>
<td align="right">63.03681</td>
<td align="right">40.44858</td>
<td align="right">0.0333505</td>
</tr>
<tr class="odd">
<td align="right">13</td>
<td align="right">45.02793</td>
<td align="right">47.46814</td>
<td align="right">55.760669</td>
<td align="right">0</td>
<td align="right">100</td>
<td align="right">92.00095</td>
<td align="right">-71.05808</td>
<td align="right">110.34226</td>
<td align="right">27.3510609</td>
<td align="right">78.39580</td>
<td align="right">51.04474</td>
<td align="right">0.0264274</td>
</tr>
<tr class="even">
<td align="right">14</td>
<td align="right">48.84468</td>
<td align="right">46.17014</td>
<td align="right">58.970068</td>
<td align="right">0</td>
<td align="right">100</td>
<td align="right">82.41156</td>
<td align="right">-93.22169</td>
<td align="right">112.33839</td>
<td align="right">35.9895577</td>
<td align="right">76.01952</td>
<td align="right">40.02996</td>
<td align="right">0.0336992</td>
</tr>
<tr class="odd">
<td align="right">15</td>
<td align="right">49.12716</td>
<td align="right">41.55740</td>
<td align="right">57.064352</td>
<td align="right">0</td>
<td align="right">100</td>
<td align="right">85.30208</td>
<td align="right">-75.32854</td>
<td align="right">112.66365</td>
<td align="right">28.9231837</td>
<td align="right">83.82389</td>
<td align="right">54.90071</td>
<td align="right">0.0245713</td>
</tr>
<tr class="even">
<td align="right">16</td>
<td align="right">43.91908</td>
<td align="right">38.84888</td>
<td align="right">53.967685</td>
<td align="right">0</td>
<td align="right">100</td>
<td align="right">79.82340</td>
<td align="right">-65.94913</td>
<td align="right">122.55003</td>
<td align="right">18.4567483</td>
<td align="right">71.31749</td>
<td align="right">52.86074</td>
<td align="right">0.0255195</td>
</tr>
<tr class="odd">
<td align="right">17</td>
<td align="right">26.21813</td>
<td align="right">40.33094</td>
<td align="right">28.927309</td>
<td align="right">0</td>
<td align="right">100</td>
<td align="right">81.93965</td>
<td align="right">-82.28630</td>
<td align="right">98.15012</td>
<td align="right">5.1396817</td>
<td align="right">53.96415</td>
<td align="right">48.82447</td>
<td align="right">0.0276292</td>
</tr>
<tr class="even">
<td align="right">18</td>
<td align="right">35.81653</td>
<td align="right">36.11849</td>
<td align="right">34.146657</td>
<td align="right">0</td>
<td align="right">100</td>
<td align="right">94.46603</td>
<td align="right">-75.77164</td>
<td align="right">107.65872</td>
<td align="right">17.4846896</td>
<td align="right">58.06189</td>
<td align="right">40.57720</td>
<td align="right">0.0332448</td>
</tr>
<tr class="odd">
<td align="right">19</td>
<td align="right">35.74937</td>
<td align="right">37.27653</td>
<td align="right">28.621896</td>
<td align="right">0</td>
<td align="right">100</td>
<td align="right">87.94144</td>
<td align="right">-65.45262</td>
<td align="right">112.37523</td>
<td align="right">15.1202507</td>
<td align="right">62.11723</td>
<td align="right">46.99698</td>
<td align="right">0.0287035</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="co">#### Compute plate-wise IQR-standardized viability ####</span></a>
<a class="sourceLine" id="cb23-2" data-line-number="2"></a>
<a class="sourceLine" id="cb23-3" data-line-number="3"><span class="co">## Centering: substract the median</span></a>
<a class="sourceLine" id="cb23-4" data-line-number="4"><span class="co">## Scaling: divide by IQR</span></a>
<a class="sourceLine" id="cb23-5" data-line-number="5"><span class="co">## Standardize: multiply by IQR of the normal distribution</span></a>
<a class="sourceLine" id="cb23-6" data-line-number="6">plate &lt;-<span class="st"> </span><span class="kw">as.vector</span>(inhibTable<span class="op">$</span>Plate)</a>
<a class="sourceLine" id="cb23-7" data-line-number="7">inhibTable<span class="op">$</span>z &lt;-<span class="st"> </span>(inhibTable<span class="op">$</span>Vrel</a>
<a class="sourceLine" id="cb23-8" data-line-number="8">      <span class="op">-</span><span class="st"> </span>statPerPlate[plate, <span class="st">&quot;TrMedian&quot;</span>]) <span class="op">*</span><span class="st"> </span>statPerPlate[plate, <span class="st">&quot;scaling&quot;</span>]</a>
<a class="sourceLine" id="cb23-9" data-line-number="9"><span class="co"># IQR(inhibTable$z)</span></a>
<a class="sourceLine" id="cb23-10" data-line-number="10"><span class="co"># IQR(rnorm(n = 1000000))</span></a>
<a class="sourceLine" id="cb23-11" data-line-number="11"><span class="co"># as.vector(by(data = inhibTable$z[wellType == &quot;treated&quot;], INDICES = inhibTable$Plate[wellType == &quot;treated&quot;], FUN = IQR))</span></a>
<a class="sourceLine" id="cb23-12" data-line-number="12"><span class="co"># as.vector(by(data = inhibTable$z[wellType == &quot;treated&quot;], INDICES = inhibTable$Plate[wellType == &quot;treated&quot;], FUN = median))</span></a></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="co">### Descriptive statistics on the IQR-standardized viability ####</span></a>
<a class="sourceLine" id="cb24-2" data-line-number="2">zstat &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb24-3" data-line-number="3">  <span class="dt">mean =</span> <span class="kw">mean</span>(inhibTable<span class="op">$</span>z[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>]),</a>
<a class="sourceLine" id="cb24-4" data-line-number="4">  <span class="dt">sd =</span> <span class="kw">sd</span>(inhibTable<span class="op">$</span>z[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>]),</a>
<a class="sourceLine" id="cb24-5" data-line-number="5">  <span class="dt">IQR =</span> <span class="kw">IQR</span>(inhibTable<span class="op">$</span>z[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>]),</a>
<a class="sourceLine" id="cb24-6" data-line-number="6">  <span class="dt">var =</span> <span class="kw">var</span>(inhibTable<span class="op">$</span>z[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>]),</a>
<a class="sourceLine" id="cb24-7" data-line-number="7">  <span class="dt">min =</span> <span class="kw">min</span>(inhibTable<span class="op">$</span>z[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>]),</a>
<a class="sourceLine" id="cb24-8" data-line-number="8">  <span class="dt">Q1 =</span> <span class="kw">as.vector</span>(<span class="kw">quantile</span>(inhibTable<span class="op">$</span>z[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>], <span class="dt">probs =</span> <span class="fl">0.25</span>)),</a>
<a class="sourceLine" id="cb24-9" data-line-number="9">  <span class="dt">median =</span> <span class="kw">median</span>(inhibTable<span class="op">$</span>z[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>]),</a>
<a class="sourceLine" id="cb24-10" data-line-number="10">  <span class="dt">Q3 =</span> <span class="kw">as.vector</span>(<span class="kw">quantile</span>(inhibTable<span class="op">$</span>z[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>], <span class="dt">probs =</span> <span class="fl">0.75</span>)),</a>
<a class="sourceLine" id="cb24-11" data-line-number="11">  <span class="dt">max =</span> <span class="kw">max</span>(inhibTable<span class="op">$</span>z[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>])</a>
<a class="sourceLine" id="cb24-12" data-line-number="12">)</a>
<a class="sourceLine" id="cb24-13" data-line-number="13"></a>
<a class="sourceLine" id="cb24-14" data-line-number="14"><span class="kw">kable</span>(<span class="kw">t</span>(zstat), </a>
<a class="sourceLine" id="cb24-15" data-line-number="15">      <span class="dt">col.names =</span> <span class="st">&quot;Stat&quot;</span>, </a>
<a class="sourceLine" id="cb24-16" data-line-number="16">      <span class="dt">caption =</span> <span class="st">&quot;Statistics of the plate-wise IQR-standardized viability&quot;</span>)</a></code></pre></div>
<table>
<caption>Statistics of the plate-wise IQR-standardized viability</caption>
<thead>
<tr class="header">
<th></th>
<th align="right">Stat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>mean</td>
<td align="right">0.1656308</td>
</tr>
<tr class="even">
<td>sd</td>
<td align="right">1.4587500</td>
</tr>
<tr class="odd">
<td>IQR</td>
<td align="right">1.2842621</td>
</tr>
<tr class="even">
<td>var</td>
<td align="right">2.1279515</td>
</tr>
<tr class="odd">
<td>min</td>
<td align="right">-5.1287479</td>
</tr>
<tr class="even">
<td>Q1</td>
<td align="right">-0.5507888</td>
</tr>
<tr class="odd">
<td>median</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td>Q3</td>
<td align="right">0.7334733</td>
</tr>
<tr class="odd">
<td>max</td>
<td align="right">8.4789023</td>
</tr>
</tbody>
</table>
</div>
<div id="histograms-of-inter-quartile-standardized-viability" class="section level3">
<h3>Histograms of inter-quartile standardized viability</h3>
<p>The histogram of plate-wise IQR-standardized viability shows a clear improvement: the median is much closer to the mode than with the raw or log-transformed II values.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1"><span class="co">#### Histograms of IQR-standardized viability ####</span></a>
<a class="sourceLine" id="cb25-2" data-line-number="2">histBreaks =<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from =</span> <span class="kw">floor</span>(<span class="kw">min</span>(inhibTable<span class="op">$</span>z)), </a>
<a class="sourceLine" id="cb25-3" data-line-number="3">                 <span class="dt">to =</span> <span class="kw">ceiling</span>(<span class="kw">max</span>(inhibTable<span class="op">$</span>z)), <span class="dt">by =</span> <span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb25-4" data-line-number="4"></a>
<a class="sourceLine" id="cb25-5" data-line-number="5"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb25-6" data-line-number="6"></a>
<a class="sourceLine" id="cb25-7" data-line-number="7"><span class="co">## Virus controls</span></a>
<a class="sourceLine" id="cb25-8" data-line-number="8"><span class="kw">hist</span>(inhibTable[wellType <span class="op">==</span><span class="st"> &quot;virusCtl&quot;</span>, <span class="st">&quot;z&quot;</span>], </a>
<a class="sourceLine" id="cb25-9" data-line-number="9">     <span class="dt">main =</span> <span class="st">&quot;Virus control – IQR standardized viability&quot;</span>,</a>
<a class="sourceLine" id="cb25-10" data-line-number="10">     <span class="dt">breaks =</span> histBreaks, </a>
<a class="sourceLine" id="cb25-11" data-line-number="11">     <span class="dt">xlab =</span> <span class="st">&quot;Plate-wise z-score&quot;</span>, </a>
<a class="sourceLine" id="cb25-12" data-line-number="12">     <span class="dt">col =</span> <span class="st">&quot;orange&quot;</span>, <span class="dt">border =</span> <span class="st">&quot;orange&quot;</span>)</a>
<a class="sourceLine" id="cb25-13" data-line-number="13"><span class="kw">abline</span>(<span class="dt">v =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb25-14" data-line-number="14"><span class="kw">abline</span>(<span class="dt">v =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">lty =</span> <span class="st">&quot;dotted&quot;</span>)</a>
<a class="sourceLine" id="cb25-15" data-line-number="15"></a>
<a class="sourceLine" id="cb25-16" data-line-number="16"><span class="co">## Treated cells</span></a>
<a class="sourceLine" id="cb25-17" data-line-number="17"><span class="kw">hist</span>(inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;z&quot;</span>], </a>
<a class="sourceLine" id="cb25-18" data-line-number="18">     <span class="dt">main =</span> <span class="st">&quot;Treated cells – IQR standardized viability&quot;</span>,</a>
<a class="sourceLine" id="cb25-19" data-line-number="19">     <span class="dt">breaks =</span> histBreaks, </a>
<a class="sourceLine" id="cb25-20" data-line-number="20">     <span class="dt">xlab =</span> <span class="st">&quot;Plate-wise z-score&quot;</span>, </a>
<a class="sourceLine" id="cb25-21" data-line-number="21">     <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">border =</span> <span class="st">&quot;grey&quot;</span>)</a>
<a class="sourceLine" id="cb25-22" data-line-number="22"><span class="kw">abline</span>(<span class="dt">v =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb25-23" data-line-number="23"><span class="kw">abline</span>(<span class="dt">v =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">lty =</span> <span class="st">&quot;dotted&quot;</span>)</a>
<a class="sourceLine" id="cb25-24" data-line-number="24"><span class="kw">abline</span>(<span class="dt">v =</span> <span class="kw">mean</span>(inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;z&quot;</span>]), <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</a>
<a class="sourceLine" id="cb25-25" data-line-number="25"><span class="kw">abline</span>(<span class="dt">v =</span> <span class="kw">median</span>(inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;z&quot;</span>]), <span class="dt">col =</span> <span class="st">&quot;darkgreen&quot;</span>)</a>
<a class="sourceLine" id="cb25-26" data-line-number="26"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;mean&quot;</span>, <span class="st">&quot;median&quot;</span>),</a>
<a class="sourceLine" id="cb25-27" data-line-number="27">       <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;darkgreen&quot;</span>),</a>
<a class="sourceLine" id="cb25-28" data-line-number="28">       <span class="dt">lwd =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb25-29" data-line-number="29"></a>
<a class="sourceLine" id="cb25-30" data-line-number="30"><span class="co">## Cell controls</span></a>
<a class="sourceLine" id="cb25-31" data-line-number="31"><span class="kw">hist</span>(inhibTable[wellType <span class="op">==</span><span class="st"> &quot;cellCtl&quot;</span>, <span class="st">&quot;z&quot;</span>], </a>
<a class="sourceLine" id="cb25-32" data-line-number="32">     <span class="dt">main =</span> <span class="st">&quot;Cell control (untreated) – IQR standardized viability&quot;</span>,</a>
<a class="sourceLine" id="cb25-33" data-line-number="33">     <span class="dt">breaks =</span> histBreaks, </a>
<a class="sourceLine" id="cb25-34" data-line-number="34">     <span class="dt">xlab =</span> <span class="st">&quot;Plate-wise z-score&quot;</span>, </a>
<a class="sourceLine" id="cb25-35" data-line-number="35">     <span class="dt">col =</span> <span class="st">&quot;palegreen&quot;</span>, <span class="dt">border =</span> <span class="st">&quot;palegreen&quot;</span>)</a>
<a class="sourceLine" id="cb25-36" data-line-number="36"><span class="kw">abline</span>(<span class="dt">v =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb25-37" data-line-number="37"><span class="kw">abline</span>(<span class="dt">v =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">lty =</span> <span class="st">&quot;dotted&quot;</span>)</a></code></pre></div>
<div class="figure" style="text-align: center">
<img src="figures/touret_sars-cov-2_inhibitorsz_distrib-1.png" alt="Distribution of the plate-wise IQR-standardized viability (z-scores) Top: virus control (infected, untreated); middle: treated; bottom: cell control (untreated)" width="100%" />
<p class="caption">
Distribution of the plate-wise IQR-standardized viability (z-scores) Top: virus control (infected, untreated); middle: treated; bottom: cell control (untreated)
</p>
</div>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1"><span class="kw">par</span>(par.ori)</a></code></pre></div>
</div>
<div id="boxplots-inter-quartile-standardized-viability" class="section level3">
<h3>Boxplots: inter-quartile standardized viability</h3>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1"><span class="co">#### Boxplots of IQR-standardized viability per plate ####</span></a>
<a class="sourceLine" id="cb27-2" data-line-number="2"></a>
<a class="sourceLine" id="cb27-3" data-line-number="3">zfloor &lt;-<span class="st"> </span><span class="kw">floor</span>(<span class="kw">min</span>(inhibTable<span class="op">$</span>z))</a>
<a class="sourceLine" id="cb27-4" data-line-number="4">zceiling &lt;-<span class="st"> </span><span class="kw">max</span>(inhibTable<span class="op">$</span>z) <span class="op">*</span><span class="st"> </span><span class="fl">1.1</span></a>
<a class="sourceLine" id="cb27-5" data-line-number="5"></a>
<a class="sourceLine" id="cb27-6" data-line-number="6"><span class="co">## Box plot per plate and well type</span></a>
<a class="sourceLine" id="cb27-7" data-line-number="7"><span class="kw">boxplot</span>(z <span class="op">~</span><span class="st"> </span>Plate <span class="op">+</span><span class="st"> </span>wellType, </a>
<a class="sourceLine" id="cb27-8" data-line-number="8">        <span class="dt">main =</span> <span class="st">&quot;Inter-quartile standardized viability&quot;</span>,</a>
<a class="sourceLine" id="cb27-9" data-line-number="9">        <span class="dt">data =</span> inhibTable, </a>
<a class="sourceLine" id="cb27-10" data-line-number="10">        <span class="dt">las =</span> <span class="dv">1</span>, <span class="dt">col =</span> plateColor, </a>
<a class="sourceLine" id="cb27-11" data-line-number="11">        <span class="dt">xlab =</span> <span class="st">&quot;z&quot;</span>, </a>
<a class="sourceLine" id="cb27-12" data-line-number="12">        <span class="dt">ylim =</span> <span class="kw">c</span>(zfloor, zceiling),</a>
<a class="sourceLine" id="cb27-13" data-line-number="13">        <span class="dt">cex.axis =</span> <span class="fl">0.5</span>, </a>
<a class="sourceLine" id="cb27-14" data-line-number="14">        <span class="dt">cex =</span> <span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb27-15" data-line-number="15">        <span class="dt">horizontal =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb27-16" data-line-number="16"><span class="kw">abline</span>(<span class="dt">v =</span> <span class="kw">seq</span>(<span class="dt">from =</span> zfloor, <span class="dt">to =</span> zceiling, <span class="dt">by =</span> <span class="dv">1</span>), <span class="dt">col =</span> <span class="st">&quot;#EEEEEE&quot;</span>)</a>
<a class="sourceLine" id="cb27-17" data-line-number="17"><span class="kw">abline</span>(<span class="dt">v =</span> <span class="kw">seq</span>(<span class="dt">from =</span> zfloor, <span class="dt">to =</span> zceiling, <span class="dt">by =</span> <span class="dv">5</span>), <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>)</a>
<a class="sourceLine" id="cb27-18" data-line-number="18"><span class="kw">abline</span>(<span class="dt">v =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb27-19" data-line-number="19"><span class="kw">abline</span>(<span class="dt">v =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">lty =</span> <span class="st">&quot;dotted&quot;</span>)</a>
<a class="sourceLine" id="cb27-20" data-line-number="20"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">legend =</span> <span class="kw">names</span>(plateColor), </a>
<a class="sourceLine" id="cb27-21" data-line-number="21">       <span class="dt">title =</span> <span class="st">&quot;Plate&quot;</span>, <span class="dt">fill =</span> plateColor, <span class="dt">cex =</span> <span class="fl">0.6</span>)</a>
<a class="sourceLine" id="cb27-22" data-line-number="22"></a>
<a class="sourceLine" id="cb27-23" data-line-number="23"><span class="co">## Add points to denote the arbidol controls</span></a>
<a class="sourceLine" id="cb27-24" data-line-number="24"><span class="kw">stripchart</span>(z <span class="op">~</span><span class="st"> </span>Plate, <span class="dt">vertical =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb27-25" data-line-number="25">           <span class="dt">data =</span> inhibTable[arbidolWells, ],</a>
<a class="sourceLine" id="cb27-26" data-line-number="26">           <span class="dt">method =</span> <span class="st">&quot;jitter&quot;</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>, <span class="dt">cex =</span> <span class="fl">0.7</span>, </a>
<a class="sourceLine" id="cb27-27" data-line-number="27">           <span class="dt">col =</span> markColor[<span class="st">&quot;Arbidol&quot;</span>], <span class="dt">pch =</span> markPCh[<span class="st">&quot;Arbidol&quot;</span>])</a>
<a class="sourceLine" id="cb27-28" data-line-number="28"><span class="kw">legend</span>(<span class="st">&quot;bottomleft&quot;</span>, </a>
<a class="sourceLine" id="cb27-29" data-line-number="29">       <span class="dt">title =</span> <span class="st">&quot;Markers&quot;</span>, </a>
<a class="sourceLine" id="cb27-30" data-line-number="30">       <span class="dt">legend =</span> <span class="st">&quot;Arbidol&quot;</span>, </a>
<a class="sourceLine" id="cb27-31" data-line-number="31">       <span class="dt">col =</span> markColor[<span class="st">&quot;Arbidol&quot;</span>], </a>
<a class="sourceLine" id="cb27-32" data-line-number="32">       <span class="dt">pch =</span> markPCh[<span class="st">&quot;Arbidol&quot;</span>],</a>
<a class="sourceLine" id="cb27-33" data-line-number="33">       <span class="dt">cex =</span> <span class="fl">0.8</span>)</a></code></pre></div>
<div class="figure" style="text-align: center">
<img src="figures/touret_sars-cov-2_inhibitorsboxplots_per_plate_z-1.png" alt="Distribution of inter-quartile standardized viability (z) values per plate. Top virus control (untreated infected cells); middle: treated cells; bottom: cell control (uninfected). Black plain circles: arbidol control duplicates.  " width="80%" />
<p class="caption">
Distribution of inter-quartile standardized viability (z) values per plate. Top virus control (untreated infected cells); middle: treated cells; bottom: cell control (uninfected). Black plain circles: arbidol control duplicates.
</p>
</div>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1"><span class="kw">par</span>(par.ori)</a></code></pre></div>
<p>The above boxplots show that the inter-quartile standardization efficiently corrects for the over-dispersion of the plates 11 to 19. However we may expect a lot of sensitivity for these plates. There are however still some weaknesses.</p>
<ul>
<li><p>The virus control show good properties: in absence of treatment, infected cells have sligtly negative values, except for 2 outliers in plate 17.</p></li>
<li><p>The cell control box plots show wide variation in their medians and dispersion:</p>
<ul>
<li><p>Uninfected cells (cell control) have much lower values in some plates (plates 4 and 11-19) than in other ones. This is not expected, since these cells should by definition have the same inhibition values.</p></li>
<li><p>Even for the plates where the cell controls have a high relative viability after IQR-based standardization, there are strong between-plates variations.</p></li>
</ul></li>
</ul>
<p>This standardization seems thus efficient to correct the apparent over-dispersion of plates 11 to 19, and thereby reduce the rate of likely false positives, but the wide between-plate variability of the untreated cells suggest that the resulting z-scores should not be interpreted as indicators of inhibition.</p>
</div>
<div id="dot-plots-inter-quartile-standardized-viability" class="section level3">
<h3>Dot plots: inter-quartile standardized viability</h3>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1">zceiling &lt;-<span class="st"> </span><span class="kw">max</span>(inhibTable<span class="op">$</span>z) <span class="op">*</span><span class="st"> </span><span class="fl">1.1</span></a>
<a class="sourceLine" id="cb29-2" data-line-number="2">zRange &lt;-<span class="st"> </span><span class="kw">c</span>(zfloor, zceiling)</a>
<a class="sourceLine" id="cb29-3" data-line-number="3"></a>
<a class="sourceLine" id="cb29-4" data-line-number="4"><span class="co">## Virus control</span></a>
<a class="sourceLine" id="cb29-5" data-line-number="5"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb29-6" data-line-number="6"><span class="kw">plot</span>(inhibTable[wellType <span class="op">==</span><span class="st"> &quot;virusCtl&quot;</span>, <span class="st">&quot;z&quot;</span>],</a>
<a class="sourceLine" id="cb29-7" data-line-number="7">     <span class="dt">main =</span> <span class="st">&quot;Virus control (infected, untreated)&quot;</span>,</a>
<a class="sourceLine" id="cb29-8" data-line-number="8">     <span class="dt">xlab =</span> <span class="st">&quot;Replicates, sorted per plate&quot;</span>,</a>
<a class="sourceLine" id="cb29-9" data-line-number="9">     <span class="dt">ylab =</span> <span class="st">&quot;z&quot;</span>,</a>
<a class="sourceLine" id="cb29-10" data-line-number="10">     <span class="dt">ylim =</span> zRange,</a>
<a class="sourceLine" id="cb29-11" data-line-number="11">     <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, (<span class="dv">19</span><span class="op">*</span><span class="dv">6</span><span class="op">*</span><span class="fl">1.1</span>)),</a>
<a class="sourceLine" id="cb29-12" data-line-number="12">     <span class="dt">col =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;virusCtl&quot;</span>, <span class="st">&quot;color&quot;</span>],</a>
<a class="sourceLine" id="cb29-13" data-line-number="13">     <span class="dt">pch =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;virusCtl&quot;</span>, <span class="st">&quot;pch&quot;</span>],</a>
<a class="sourceLine" id="cb29-14" data-line-number="14">     <span class="dt">panel.first =</span> <span class="kw">c</span>(</a>
<a class="sourceLine" id="cb29-15" data-line-number="15">       <span class="kw">abline</span>(<span class="dt">h =</span> <span class="kw">seq</span>(<span class="dt">from =</span> zfloor, <span class="dt">to =</span> zceiling, <span class="dt">by =</span> <span class="dv">1</span>), <span class="dt">col =</span> <span class="st">&quot;#EEEEEE&quot;</span>),</a>
<a class="sourceLine" id="cb29-16" data-line-number="16">       <span class="kw">abline</span>(<span class="dt">h =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">-5</span>, <span class="dt">to =</span> zceiling, <span class="dt">by =</span> <span class="dv">5</span>), <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>),</a>
<a class="sourceLine" id="cb29-17" data-line-number="17">       <span class="kw">abline</span>(<span class="dt">v =</span> (<span class="dv">0</span><span class="op">:</span><span class="dv">19</span>) <span class="op">*</span><span class="st"> </span><span class="dv">6</span>, <span class="dt">col =</span> <span class="st">&quot;#999999&quot;</span>)</a>
<a class="sourceLine" id="cb29-18" data-line-number="18">     ),</a>
<a class="sourceLine" id="cb29-19" data-line-number="19">     <span class="dt">xaxt =</span> <span class="st">&quot;n&quot;</span>,</a>
<a class="sourceLine" id="cb29-20" data-line-number="20">     <span class="dt">cex =</span> <span class="fl">0.5</span>, </a>
<a class="sourceLine" id="cb29-21" data-line-number="21">     <span class="dt">las =</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb29-22" data-line-number="22">     )</a>
<a class="sourceLine" id="cb29-23" data-line-number="23"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb29-24" data-line-number="24"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">lty =</span> <span class="st">&quot;dotted&quot;</span>)</a>
<a class="sourceLine" id="cb29-25" data-line-number="25"><span class="kw">mtext</span>(plateNumbers, <span class="dt">at =</span> (<span class="dv">1</span><span class="op">:</span><span class="dv">19</span>) <span class="op">*</span><span class="st"> </span><span class="dv">6</span> <span class="op">-</span><span class="st"> </span><span class="dv">3</span>, <span class="dt">side =</span> <span class="dv">1</span>, <span class="dt">col =</span> plateColor)</a>
<a class="sourceLine" id="cb29-26" data-line-number="26"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, </a>
<a class="sourceLine" id="cb29-27" data-line-number="27">       <span class="dt">legend =</span> <span class="kw">names</span>(plateColor), </a>
<a class="sourceLine" id="cb29-28" data-line-number="28">       <span class="dt">col =</span> plateColor, <span class="dt">pch =</span> <span class="dv">1</span>, </a>
<a class="sourceLine" id="cb29-29" data-line-number="29">       <span class="dt">cex =</span> <span class="fl">0.7</span>)</a>
<a class="sourceLine" id="cb29-30" data-line-number="30"></a>
<a class="sourceLine" id="cb29-31" data-line-number="31"><span class="co">## Treated cells</span></a>
<a class="sourceLine" id="cb29-32" data-line-number="32"><span class="kw">plot</span>(inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;z&quot;</span>],</a>
<a class="sourceLine" id="cb29-33" data-line-number="33">     <span class="dt">main =</span> <span class="st">&quot;IQR-standardized viability (z)&quot;</span>,</a>
<a class="sourceLine" id="cb29-34" data-line-number="34">     <span class="dt">xlab =</span> <span class="st">&quot;Molecules&quot;</span>,</a>
<a class="sourceLine" id="cb29-35" data-line-number="35">     <span class="dt">ylab =</span> <span class="st">&quot;z&quot;</span>,</a>
<a class="sourceLine" id="cb29-36" data-line-number="36">     <span class="dt">ylim =</span> zRange,</a>
<a class="sourceLine" id="cb29-37" data-line-number="37">     <span class="dt">col =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;color&quot;</span>],</a>
<a class="sourceLine" id="cb29-38" data-line-number="38">     <span class="dt">pch =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;pch&quot;</span>],</a>
<a class="sourceLine" id="cb29-39" data-line-number="39">     <span class="dt">xaxt =</span> <span class="st">&quot;n&quot;</span>,</a>
<a class="sourceLine" id="cb29-40" data-line-number="40">     <span class="dt">cex =</span> <span class="fl">0.5</span>, </a>
<a class="sourceLine" id="cb29-41" data-line-number="41">     <span class="dt">las =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb29-42" data-line-number="42">     <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="kw">length</span>(inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;z&quot;</span>])<span class="op">*</span><span class="fl">1.1</span>)</a>
<a class="sourceLine" id="cb29-43" data-line-number="43">     )</a>
<a class="sourceLine" id="cb29-44" data-line-number="44"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="kw">seq</span>(<span class="dt">from =</span> zfloor, <span class="dt">to =</span> zceiling, <span class="dt">by =</span> <span class="dv">1</span>), <span class="dt">col =</span> <span class="st">&quot;#EEEEEE&quot;</span>)</a>
<a class="sourceLine" id="cb29-45" data-line-number="45"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="kw">seq</span>(<span class="dt">from =</span> zfloor, <span class="dt">to =</span> zceiling, <span class="dt">by =</span> <span class="dv">5</span>), <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>)</a>
<a class="sourceLine" id="cb29-46" data-line-number="46"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb29-47" data-line-number="47"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">lty =</span> <span class="st">&quot;dotted&quot;</span>)</a>
<a class="sourceLine" id="cb29-48" data-line-number="48"><span class="kw">abline</span>(<span class="dt">v =</span> (<span class="dv">0</span><span class="op">:</span><span class="dv">19</span>) <span class="op">*</span><span class="st"> </span><span class="dv">82</span>, <span class="dt">col =</span> <span class="st">&quot;#999999&quot;</span>)</a>
<a class="sourceLine" id="cb29-49" data-line-number="49"><span class="kw">mtext</span>(plateNumbers, <span class="dt">at =</span> (<span class="dv">1</span><span class="op">:</span><span class="dv">19</span>) <span class="op">*</span><span class="st"> </span><span class="dv">82</span> <span class="op">-</span><span class="st"> </span><span class="dv">41</span>, <span class="dt">side =</span> <span class="dv">1</span>, <span class="dt">col =</span> plateColor)</a>
<a class="sourceLine" id="cb29-50" data-line-number="50"><span class="kw">legend</span>(<span class="st">&quot;right&quot;</span>, </a>
<a class="sourceLine" id="cb29-51" data-line-number="51">       <span class="dt">legend =</span> <span class="kw">names</span>(plateColor), </a>
<a class="sourceLine" id="cb29-52" data-line-number="52">       <span class="dt">col =</span> plateColor, <span class="dt">pch =</span> <span class="dv">1</span>, </a>
<a class="sourceLine" id="cb29-53" data-line-number="53">       <span class="dt">cex =</span> <span class="fl">0.6</span>)</a>
<a class="sourceLine" id="cb29-54" data-line-number="54"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, </a>
<a class="sourceLine" id="cb29-55" data-line-number="55">       <span class="dt">title =</span> <span class="st">&quot;Markers&quot;</span>, </a>
<a class="sourceLine" id="cb29-56" data-line-number="56">       <span class="dt">legend =</span> <span class="kw">names</span>(markColor), </a>
<a class="sourceLine" id="cb29-57" data-line-number="57">       <span class="dt">col =</span> markColor, </a>
<a class="sourceLine" id="cb29-58" data-line-number="58">       <span class="dt">pch =</span> markPCh,</a>
<a class="sourceLine" id="cb29-59" data-line-number="59">       <span class="dt">cex =</span> <span class="fl">0.6</span>)</a>
<a class="sourceLine" id="cb29-60" data-line-number="60"></a>
<a class="sourceLine" id="cb29-61" data-line-number="61"><span class="co">## Cell control</span></a>
<a class="sourceLine" id="cb29-62" data-line-number="62"><span class="kw">plot</span>(inhibTable[wellType <span class="op">==</span><span class="st"> &quot;cellCtl&quot;</span>, <span class="st">&quot;z&quot;</span>],</a>
<a class="sourceLine" id="cb29-63" data-line-number="63">     <span class="dt">panel.first =</span> <span class="kw">grid</span>(),</a>
<a class="sourceLine" id="cb29-64" data-line-number="64">     <span class="dt">main =</span> <span class="st">&quot;Cell control (uninfected)&quot;</span>,</a>
<a class="sourceLine" id="cb29-65" data-line-number="65">     <span class="dt">xlab =</span> <span class="st">&quot;Replicates, sorted per plate&quot;</span>,</a>
<a class="sourceLine" id="cb29-66" data-line-number="66">     <span class="dt">ylab =</span> <span class="st">&quot;z&quot;</span>,</a>
<a class="sourceLine" id="cb29-67" data-line-number="67">     <span class="dt">ylim =</span> zRange,</a>
<a class="sourceLine" id="cb29-68" data-line-number="68">     <span class="dt">col =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;cellCtl&quot;</span>, <span class="st">&quot;color&quot;</span>],</a>
<a class="sourceLine" id="cb29-69" data-line-number="69">     <span class="dt">pch =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;cellCtl&quot;</span>, <span class="st">&quot;pch&quot;</span>],</a>
<a class="sourceLine" id="cb29-70" data-line-number="70">     <span class="dt">xaxt =</span> <span class="st">&quot;n&quot;</span>,</a>
<a class="sourceLine" id="cb29-71" data-line-number="71">     <span class="dt">cex =</span> <span class="fl">0.5</span>, </a>
<a class="sourceLine" id="cb29-72" data-line-number="72">     <span class="dt">las =</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb29-73" data-line-number="73">     )</a>
<a class="sourceLine" id="cb29-74" data-line-number="74"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="kw">seq</span>(<span class="dt">from =</span> zfloor, <span class="dt">to =</span> zceiling, <span class="dt">by =</span> <span class="dv">1</span>), <span class="dt">col =</span> <span class="st">&quot;#EEEEEE&quot;</span>)</a>
<a class="sourceLine" id="cb29-75" data-line-number="75"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="kw">seq</span>(<span class="dt">from =</span> zfloor, <span class="dt">to =</span> zceiling, <span class="dt">by =</span> <span class="dv">5</span>), <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>)</a>
<a class="sourceLine" id="cb29-76" data-line-number="76"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb29-77" data-line-number="77"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">lty =</span> <span class="st">&quot;dotted&quot;</span>)</a>
<a class="sourceLine" id="cb29-78" data-line-number="78"><span class="kw">abline</span>(<span class="dt">v =</span> (<span class="dv">0</span><span class="op">:</span><span class="dv">19</span>) <span class="op">*</span><span class="st"> </span><span class="dv">8</span>, <span class="dt">col =</span> <span class="st">&quot;#999999&quot;</span>)</a>
<a class="sourceLine" id="cb29-79" data-line-number="79"><span class="kw">mtext</span>(plateNumbers, <span class="dt">at =</span> (<span class="dv">1</span><span class="op">:</span><span class="dv">19</span>) <span class="op">*</span><span class="st"> </span><span class="dv">8</span> <span class="op">-</span><span class="st"> </span><span class="dv">4</span>, <span class="dt">side =</span> <span class="dv">1</span>, <span class="dt">col =</span> plateColor)</a>
<a class="sourceLine" id="cb29-80" data-line-number="80"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, </a>
<a class="sourceLine" id="cb29-81" data-line-number="81">       <span class="dt">legend =</span> <span class="kw">names</span>(plateColor), </a>
<a class="sourceLine" id="cb29-82" data-line-number="82">       <span class="dt">col =</span> plateColor, <span class="dt">pch =</span> <span class="dv">1</span>, </a>
<a class="sourceLine" id="cb29-83" data-line-number="83">       <span class="dt">cex =</span> <span class="fl">0.7</span>)</a>
<a class="sourceLine" id="cb29-84" data-line-number="84"><span class="co"># names(supTable)</span></a>
<a class="sourceLine" id="cb29-85" data-line-number="85"></a>
<a class="sourceLine" id="cb29-86" data-line-number="86"><span class="co">## Rank plot</span></a>
<a class="sourceLine" id="cb29-87" data-line-number="87">zrank &lt;-<span class="st"> </span><span class="kw">order</span>(inhibTable<span class="op">$</span>z, <span class="dt">decreasing =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb29-88" data-line-number="88"><span class="kw">plot</span>(inhibTable[zrank, <span class="st">&quot;z&quot;</span>],</a>
<a class="sourceLine" id="cb29-89" data-line-number="89">     <span class="dt">main =</span> <span class="st">&quot;Ranked IQR-standardized viability values&quot;</span>,</a>
<a class="sourceLine" id="cb29-90" data-line-number="90">     <span class="dt">xlab =</span> <span class="st">&quot;Molecules (ranked by z index)&quot;</span>,</a>
<a class="sourceLine" id="cb29-91" data-line-number="91">     <span class="dt">ylab =</span> <span class="st">&quot;z&quot;</span>,</a>
<a class="sourceLine" id="cb29-92" data-line-number="92">     <span class="dt">col =</span> inhibTable[zrank, <span class="st">&quot;color&quot;</span>],</a>
<a class="sourceLine" id="cb29-93" data-line-number="93">     <span class="dt">pch =</span> inhibTable[zrank, <span class="st">&quot;pch&quot;</span>],</a>
<a class="sourceLine" id="cb29-94" data-line-number="94">     <span class="dt">cex =</span> <span class="fl">0.5</span>, <span class="dt">las =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb29-95" data-line-number="95">     <span class="dt">panel.first =</span> <span class="kw">grid</span>(),</a>
<a class="sourceLine" id="cb29-96" data-line-number="96">     <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="kw">length</span>(zrank) <span class="op">*</span><span class="st"> </span><span class="fl">1.05</span>)</a>
<a class="sourceLine" id="cb29-97" data-line-number="97">     )</a>
<a class="sourceLine" id="cb29-98" data-line-number="98"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="kw">seq</span>(<span class="dt">from =</span> zfloor, <span class="dt">to =</span> zceiling, <span class="dt">by =</span> <span class="dv">1</span>), <span class="dt">col =</span> <span class="st">&quot;#EEEEEE&quot;</span>)</a>
<a class="sourceLine" id="cb29-99" data-line-number="99"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="kw">seq</span>(<span class="dt">from =</span> zfloor, <span class="dt">to =</span> zceiling, <span class="dt">by =</span> <span class="dv">5</span>), <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>)</a>
<a class="sourceLine" id="cb29-100" data-line-number="100"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb29-101" data-line-number="101"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">lty =</span> <span class="st">&quot;dotted&quot;</span>)</a>
<a class="sourceLine" id="cb29-102" data-line-number="102"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, </a>
<a class="sourceLine" id="cb29-103" data-line-number="103">       <span class="dt">legend =</span> <span class="kw">names</span>(plateColor), </a>
<a class="sourceLine" id="cb29-104" data-line-number="104">       <span class="dt">col =</span> plateColor, <span class="dt">pch =</span> <span class="dv">1</span>, </a>
<a class="sourceLine" id="cb29-105" data-line-number="105">       <span class="dt">cex =</span> <span class="fl">0.4</span>)</a></code></pre></div>
<div class="figure" style="text-align: center">
<img src="figures/touret_sars-cov-2_inhibitorsz_ranked-1.png" alt="Values of the plate-wise IQR-standardized relative viability ($z$) for all the tested molecules. Molecules are colored according to the plate number. A: virus control (infected untreated); B: treated cells; C: cell control (untreated cells); D: ranked values (all types). Plain triangles: virus control (untreated infected cells). Black plain circles: arbidol control duplicates per plate. Orange square: Hydroxychloroquine sulfate. " width="80%" />
<p class="caption">
Values of the plate-wise IQR-standardized relative viability (<span class="math inline">\(z\)</span>) for all the tested molecules. Molecules are colored according to the plate number. A: virus control (infected untreated); B: treated cells; C: cell control (untreated cells); D: ranked values (all types). Plain triangles: virus control (untreated infected cells). Black plain circles: arbidol control duplicates per plate. Orange square: Hydroxychloroquine sulfate.
</p>
</div>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</a></code></pre></div>
<p>The plot of IQR-standardized viability values (top panel) clearly shows that the plate-wise normalization suppressed the background bias. However it denotes a new problem: the cell controls show striking differences depending on the plates. Noticeably,they show very high values in plates 1 and 3, and very low values in plates 11 to 19, as well as in plate 4.</p>
</div>
<div id="p-value-computation" class="section level3">
<h3>P-value computation</h3>
<p>We compute the p-value as the upper tail of the normal distribution (rigth-side test) in order to detect significantly high values of the plate-wise IQR-standardized viability.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" data-line-number="1"><span class="co">#### Compute P-value from the IQR-standardized viability ####</span></a>
<a class="sourceLine" id="cb31-2" data-line-number="2">inhibTable<span class="op">$</span>p.value &lt;-<span class="st"> </span><span class="kw">pnorm</span>(inhibTable<span class="op">$</span>z, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb31-3" data-line-number="3">inhibTable<span class="op">$</span>log10Pval &lt;-<span class="st"> </span><span class="kw">log10</span>(inhibTable<span class="op">$</span>p.value)</a>
<a class="sourceLine" id="cb31-4" data-line-number="4">inhibTable<span class="op">$</span>e.value &lt;-<span class="st"> </span>inhibTable<span class="op">$</span>p.value <span class="op">*</span><span class="st"> </span><span class="kw">sum</span>(wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>)</a>
<a class="sourceLine" id="cb31-5" data-line-number="5">inhibTable<span class="op">$</span>FDR &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb31-6" data-line-number="6">inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;FDR&quot;</span>] &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb31-7" data-line-number="7"><span class="st">  </span><span class="kw">p.adjust</span>(inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;p.value&quot;</span>], <span class="dt">method =</span> <span class="st">&quot;fdr&quot;</span>)</a>
<a class="sourceLine" id="cb31-8" data-line-number="8">inhibTable<span class="op">$</span>log10FDR &lt;-<span class="st"> </span><span class="kw">log10</span>(inhibTable<span class="op">$</span>FDR)</a>
<a class="sourceLine" id="cb31-9" data-line-number="9">inhibTable<span class="op">$</span>sig &lt;-<span class="st"> </span><span class="op">-</span>inhibTable<span class="op">$</span>log10FDR</a></code></pre></div>
</div>
<div id="p-value-histogram" class="section level3">
<h3>P-value histogram</h3>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1"><span class="kw">hist</span>(inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;p.value&quot;</span>], </a>
<a class="sourceLine" id="cb32-2" data-line-number="2">     <span class="dt">breaks =</span> <span class="dv">20</span>, </a>
<a class="sourceLine" id="cb32-3" data-line-number="3">     <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>,</a>
<a class="sourceLine" id="cb32-4" data-line-number="4">     <span class="dt">main =</span> <span class="st">&quot;P-value histogram after plate-wise normalization&quot;</span>,</a>
<a class="sourceLine" id="cb32-5" data-line-number="5">     <span class="dt">xlab =</span> <span class="st">&quot;Nominal P-value (unadjusted)&quot;</span>,</a>
<a class="sourceLine" id="cb32-6" data-line-number="6">     <span class="dt">ylab =</span> <span class="st">&quot;Frequency&quot;</span>)</a></code></pre></div>
<div class="figure" style="text-align: center">
<img src="figures/touret_sars-cov-2_inhibitorszpval_histogram-1.png" alt="Histogram of the nominal (unadjusted) p-values derived from the plate-wise IQR-standardized relative viability. " width="60%" />
<p class="caption">
Histogram of the nominal (unadjusted) p-values derived from the plate-wise IQR-standardized relative viability.
</p>
</div>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" data-line-number="1"><span class="co">## Estimate the proportion of tests under H0 and H1 </span></a>
<a class="sourceLine" id="cb33-2" data-line-number="2"><span class="co">## following the method proposed by Storey-Tibshirani (2003)</span></a>
<a class="sourceLine" id="cb33-3" data-line-number="3"><span class="co"># lambda &lt;- 0.40</span></a>
<a class="sourceLine" id="cb33-4" data-line-number="4"><span class="co"># table(inhibTable[wellType == &quot;treated&quot;, &quot;p.value&quot;] &gt; lambda)</span></a>
<a class="sourceLine" id="cb33-5" data-line-number="5"><span class="co"># m0 &lt;- sum(inhibTable[wellType == &quot;treated&quot;, &quot;p.value&quot;] &gt; lambda) / (1 - lambda)</span></a>
<a class="sourceLine" id="cb33-6" data-line-number="6"><span class="co"># m1 &lt;- sum(wellType == &quot;treated&quot;) - m0</span></a>
<a class="sourceLine" id="cb33-7" data-line-number="7"><span class="co"># print(m0)</span></a>
<a class="sourceLine" id="cb33-8" data-line-number="8"><span class="co"># print(m1)</span></a>
<a class="sourceLine" id="cb33-9" data-line-number="9"><span class="co"># </span></a></code></pre></div>
</div>
<div id="significance-plot" class="section level3">
<h3>Significance plot</h3>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1"><span class="co">#### Manhattan plot ####</span></a>
<a class="sourceLine" id="cb34-2" data-line-number="2">sigFloor &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb34-3" data-line-number="3">sigCeiling &lt;-<span class="st"> </span><span class="kw">ceiling</span>(<span class="kw">max</span>(inhibTable<span class="op">$</span>sig, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb34-4" data-line-number="4"></a>
<a class="sourceLine" id="cb34-5" data-line-number="5"><span class="kw">plot</span>(<span class="dt">x =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;sig&quot;</span>], </a>
<a class="sourceLine" id="cb34-6" data-line-number="6">     <span class="dt">col =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;color&quot;</span>],</a>
<a class="sourceLine" id="cb34-7" data-line-number="7">     <span class="dt">pch =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;pch&quot;</span>],</a>
<a class="sourceLine" id="cb34-8" data-line-number="8">     <span class="dt">main =</span> <span class="st">&quot;Significance plot&quot;</span>,</a>
<a class="sourceLine" id="cb34-9" data-line-number="9">     <span class="dt">xlab =</span> <span class="st">&quot;Molecules sorted per plate&quot;</span>,</a>
<a class="sourceLine" id="cb34-10" data-line-number="10">     <span class="dt">ylab =</span> <span class="st">&quot;Significance = -log10(FDR)&quot;</span>,</a>
<a class="sourceLine" id="cb34-11" data-line-number="11">     <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="kw">sum</span>(wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>) <span class="op">*</span><span class="st"> </span><span class="fl">1.1</span>),</a>
<a class="sourceLine" id="cb34-12" data-line-number="12">     <span class="dt">las =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb34-13" data-line-number="13">     <span class="dt">xaxt =</span> <span class="st">&quot;n&quot;</span>,</a>
<a class="sourceLine" id="cb34-14" data-line-number="14">     <span class="dt">cex =</span> <span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb34-15" data-line-number="15"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb34-16" data-line-number="16"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="kw">seq</span>(<span class="dv">0</span>, sigCeiling, <span class="dv">1</span>), <span class="dt">lty =</span> <span class="st">&quot;dotted&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>)</a>
<a class="sourceLine" id="cb34-17" data-line-number="17"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="op">-</span><span class="kw">log10</span>(alpha), <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb34-18" data-line-number="18"><span class="kw">abline</span>(<span class="dt">v =</span> (<span class="dv">0</span><span class="op">:</span><span class="dv">19</span>) <span class="op">*</span><span class="st"> </span><span class="dv">82</span>, <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>)</a>
<a class="sourceLine" id="cb34-19" data-line-number="19"><span class="kw">mtext</span>(plateNumbers, <span class="dt">at =</span> (<span class="dv">1</span><span class="op">:</span><span class="dv">19</span>) <span class="op">*</span><span class="st"> </span><span class="dv">82</span> <span class="op">-</span><span class="st"> </span><span class="dv">41</span>, <span class="dt">side =</span> <span class="dv">1</span>, <span class="dt">col =</span> plateColor)</a>
<a class="sourceLine" id="cb34-20" data-line-number="20"></a>
<a class="sourceLine" id="cb34-21" data-line-number="21"><span class="co">## Legends</span></a>
<a class="sourceLine" id="cb34-22" data-line-number="22"><span class="kw">legend</span>(<span class="st">&quot;bottomright&quot;</span>, </a>
<a class="sourceLine" id="cb34-23" data-line-number="23">       <span class="dt">legend =</span> <span class="kw">names</span>(plateColor), </a>
<a class="sourceLine" id="cb34-24" data-line-number="24">       <span class="dt">col =</span> plateColor, <span class="dt">pch =</span> <span class="dv">1</span>, </a>
<a class="sourceLine" id="cb34-25" data-line-number="25">       <span class="dt">cex =</span> <span class="fl">0.6</span>)</a>
<a class="sourceLine" id="cb34-26" data-line-number="26"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">legend =</span> <span class="kw">names</span>(markColor), </a>
<a class="sourceLine" id="cb34-27" data-line-number="27">       <span class="dt">title =</span> <span class="st">&quot;Markers&quot;</span>, </a>
<a class="sourceLine" id="cb34-28" data-line-number="28">       <span class="dt">col =</span> markColor, </a>
<a class="sourceLine" id="cb34-29" data-line-number="29">       <span class="dt">pch =</span> markPCh,</a>
<a class="sourceLine" id="cb34-30" data-line-number="30">       <span class="dt">cex =</span> <span class="fl">0.6</span>)</a></code></pre></div>
<div class="figure" style="text-align: center">
<img src="figures/touret_sars-cov-2_inhibitorsz_manhattan_plot-1.png" alt="Volcano plot. " width="80%" />
<p class="caption">
Volcano plot.
</p>
</div>
</div>
<div id="volcano-plot" class="section level3">
<h3>Volcano plot</h3>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" data-line-number="1"><span class="co">#### Volcano plot ####</span></a>
<a class="sourceLine" id="cb35-2" data-line-number="2"></a>
<a class="sourceLine" id="cb35-3" data-line-number="3"><span class="kw">plot</span>(<span class="dt">x =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;Vrel&quot;</span>],</a>
<a class="sourceLine" id="cb35-4" data-line-number="4">     <span class="dt">y =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;sig&quot;</span>], </a>
<a class="sourceLine" id="cb35-5" data-line-number="5">     <span class="dt">col =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;color&quot;</span>],</a>
<a class="sourceLine" id="cb35-6" data-line-number="6">     <span class="dt">pch =</span> inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;pch&quot;</span>],</a>
<a class="sourceLine" id="cb35-7" data-line-number="7">     <span class="dt">main =</span> <span class="st">&quot;Volcano plot&quot;</span>,</a>
<a class="sourceLine" id="cb35-8" data-line-number="8">     <span class="dt">xlab =</span> <span class="st">&quot;Relative viability&quot;</span>,</a>
<a class="sourceLine" id="cb35-9" data-line-number="9">     <span class="dt">ylab =</span> <span class="st">&quot;Significance = -log10(FDR)&quot;</span>,</a>
<a class="sourceLine" id="cb35-10" data-line-number="10">     <span class="dt">xlim =</span> <span class="kw">c</span>(VrFloor, VrCeiling), </a>
<a class="sourceLine" id="cb35-11" data-line-number="11">     <span class="dt">panel.first =</span> <span class="kw">c</span>(</a>
<a class="sourceLine" id="cb35-12" data-line-number="12">       <span class="kw">abline</span>(<span class="dt">h =</span> <span class="kw">seq</span>(sigFloor, sigCeiling, <span class="dv">1</span>), <span class="dt">col =</span> <span class="st">&quot;#DDDDDD&quot;</span>),</a>
<a class="sourceLine" id="cb35-13" data-line-number="13">       <span class="kw">abline</span>(<span class="dt">v =</span> <span class="kw">seq</span>(VrFloor, VrCeiling, <span class="dv">10</span>), <span class="dt">col =</span> <span class="st">&quot;#DDDDDD&quot;</span>),</a>
<a class="sourceLine" id="cb35-14" data-line-number="14">       <span class="kw">abline</span>(<span class="dt">v =</span> <span class="kw">seq</span>(VrFloor, VrCeiling, <span class="dv">50</span>), <span class="dt">col =</span> <span class="st">&quot;#BBBBBB&quot;</span>)</a>
<a class="sourceLine" id="cb35-15" data-line-number="15">     ),</a>
<a class="sourceLine" id="cb35-16" data-line-number="16">     <span class="dt">las =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb35-17" data-line-number="17">     <span class="dt">cex =</span> <span class="fl">0.7</span>)</a>
<a class="sourceLine" id="cb35-18" data-line-number="18"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb35-19" data-line-number="19"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="op">-</span><span class="kw">log10</span>(alpha), <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</a>
<a class="sourceLine" id="cb35-20" data-line-number="20"><span class="kw">abline</span>(<span class="dt">v =</span> <span class="dv">0</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb35-21" data-line-number="21"><span class="kw">abline</span>(<span class="dt">v =</span> <span class="dv">100</span>, <span class="dt">col =</span> <span class="st">&quot;#00BB00&quot;</span>)</a>
<a class="sourceLine" id="cb35-22" data-line-number="22"><span class="co">## Mark arbidol</span></a>
<a class="sourceLine" id="cb35-23" data-line-number="23"><span class="kw">points</span>(<span class="dt">x =</span> inhibTable[arbidolWells, <span class="st">&quot;Vrel&quot;</span>],</a>
<a class="sourceLine" id="cb35-24" data-line-number="24">     <span class="dt">y =</span> inhibTable[arbidolWells, <span class="st">&quot;sig&quot;</span>], </a>
<a class="sourceLine" id="cb35-25" data-line-number="25">     <span class="dt">col =</span> inhibTable[arbidolWells, <span class="st">&quot;color&quot;</span>],</a>
<a class="sourceLine" id="cb35-26" data-line-number="26">     <span class="dt">pch =</span> inhibTable[arbidolWells, <span class="st">&quot;pch&quot;</span>], <span class="dt">cex =</span> <span class="fl">0.7</span>)</a>
<a class="sourceLine" id="cb35-27" data-line-number="27"><span class="co">## Mark hydroxychloroquine</span></a>
<a class="sourceLine" id="cb35-28" data-line-number="28"><span class="kw">points</span>(<span class="dt">x =</span> inhibTable[HOClSindex, <span class="st">&quot;Vrel&quot;</span>],</a>
<a class="sourceLine" id="cb35-29" data-line-number="29">     <span class="dt">y =</span> inhibTable[HOClSindex, <span class="st">&quot;sig&quot;</span>], </a>
<a class="sourceLine" id="cb35-30" data-line-number="30">     <span class="dt">col =</span> inhibTable[HOClSindex, <span class="st">&quot;color&quot;</span>],</a>
<a class="sourceLine" id="cb35-31" data-line-number="31">     <span class="dt">pch =</span> inhibTable[HOClSindex, <span class="st">&quot;pch&quot;</span>], <span class="dt">cex =</span> <span class="fl">0.7</span>)</a>
<a class="sourceLine" id="cb35-32" data-line-number="32"></a>
<a class="sourceLine" id="cb35-33" data-line-number="33"><span class="co">## Legends</span></a>
<a class="sourceLine" id="cb35-34" data-line-number="34"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, </a>
<a class="sourceLine" id="cb35-35" data-line-number="35">       <span class="dt">legend =</span> <span class="kw">names</span>(plateColor), </a>
<a class="sourceLine" id="cb35-36" data-line-number="36">       <span class="dt">col =</span> plateColor, <span class="dt">pch =</span> <span class="dv">1</span>, </a>
<a class="sourceLine" id="cb35-37" data-line-number="37">       <span class="dt">cex =</span> <span class="fl">0.7</span>)</a>
<a class="sourceLine" id="cb35-38" data-line-number="38"><span class="kw">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="dt">legend =</span> <span class="kw">names</span>(markColor), </a>
<a class="sourceLine" id="cb35-39" data-line-number="39">       <span class="dt">title =</span> <span class="st">&quot;Markers&quot;</span>, </a>
<a class="sourceLine" id="cb35-40" data-line-number="40">       <span class="dt">col =</span> markColor, </a>
<a class="sourceLine" id="cb35-41" data-line-number="41">       <span class="dt">pch =</span> markPCh,</a>
<a class="sourceLine" id="cb35-42" data-line-number="42">       <span class="dt">cex =</span> <span class="fl">0.7</span>)</a></code></pre></div>
<div class="figure" style="text-align: center">
<img src="figures/touret_sars-cov-2_inhibitorsz_volcano_plot-1.png" alt="Volcano plot. " width="60%" />
<p class="caption">
Volcano plot.
</p>
</div>
</div>
</div>
<div id="significance-of-arbidol-after-iqr-based-standardisation" class="section level2">
<h2>Significance of Arbidol after IQR-based standardisation</h2>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" data-line-number="1"><span class="co">#### Relative viabilities for the arbidol contron ####</span></a>
<a class="sourceLine" id="cb36-2" data-line-number="2"><span class="co"># names(inhibTable)</span></a>
<a class="sourceLine" id="cb36-3" data-line-number="3"><span class="kw">kable</span>(inhibTable[arbidolWells, <span class="kw">c</span>(<span class="st">&quot;Plate&quot;</span>, <span class="st">&quot;CTB&quot;</span>, <span class="st">&quot;Vratio&quot;</span>, <span class="st">&quot;Vrel&quot;</span>, <span class="st">&quot;z&quot;</span>, <span class="st">&quot;FDR&quot;</span>, <span class="st">&quot;sig&quot;</span>)], <span class="dt">caption =</span> <span class="st">&quot;relative viabilities for the arbidol controls (2 replicates per plate) &quot;</span>)</a></code></pre></div>
<table>
<caption>relative viabilities for the arbidol controls (2 replicates per plate)</caption>
<thead>
<tr class="header">
<th></th>
<th align="right">Plate</th>
<th align="right">CTB</th>
<th align="right">Vratio</th>
<th align="right">Vrel</th>
<th align="right">z</th>
<th align="right">FDR</th>
<th align="right">sig</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>01A12</td>
<td align="right">1</td>
<td align="right">30140</td>
<td align="right">0.8102695</td>
<td align="right">83.73696</td>
<td align="right">7.3255223</td>
<td align="right">0.0000000</td>
<td align="right">10.2090616</td>
</tr>
<tr class="even">
<td>01B12</td>
<td align="right">1</td>
<td align="right">32753</td>
<td align="right">0.8805162</td>
<td align="right">90.16381</td>
<td align="right">7.9056975</td>
<td align="right">0.0000000</td>
<td align="right">11.9838973</td>
</tr>
<tr class="odd">
<td>02A12</td>
<td align="right">2</td>
<td align="right">43022</td>
<td align="right">0.8278078</td>
<td align="right">85.57929</td>
<td align="right">3.4364768</td>
<td align="right">0.0095644</td>
<td align="right">2.0193432</td>
</tr>
<tr class="even">
<td>02B12</td>
<td align="right">2</td>
<td align="right">40310</td>
<td align="right">0.7756249</td>
<td align="right">80.61017</td>
<td align="right">3.1908082</td>
<td align="right">0.0179826</td>
<td align="right">1.7451485</td>
</tr>
<tr class="odd">
<td>03A12</td>
<td align="right">3</td>
<td align="right">27158</td>
<td align="right">0.6786785</td>
<td align="right">71.07152</td>
<td align="right">5.2596065</td>
<td align="right">0.0000056</td>
<td align="right">5.2500335</td>
</tr>
<tr class="even">
<td>03B12</td>
<td align="right">3</td>
<td align="right">30240</td>
<td align="right">0.7556977</td>
<td align="right">79.09630</td>
<td align="right">5.9668772</td>
<td align="right">0.0000002</td>
<td align="right">6.8041204</td>
</tr>
<tr class="odd">
<td>04A12</td>
<td align="right">4</td>
<td align="right">28768</td>
<td align="right">0.6487754</td>
<td align="right">66.39001</td>
<td align="right">1.3210805</td>
<td align="right">0.6399280</td>
<td align="right">0.1938689</td>
</tr>
<tr class="even">
<td>04B12</td>
<td align="right">4</td>
<td align="right">35882</td>
<td align="right">0.8092102</td>
<td align="right">83.55677</td>
<td align="right">1.7990539</td>
<td align="right">0.3966139</td>
<td align="right">0.4016321</td>
</tr>
<tr class="odd">
<td>05A12</td>
<td align="right">5</td>
<td align="right">29898</td>
<td align="right">0.7116538</td>
<td align="right">76.50695</td>
<td align="right">2.4417358</td>
<td align="right">0.1279384</td>
<td align="right">0.8929990</td>
</tr>
<tr class="even">
<td>05B12</td>
<td align="right">5</td>
<td align="right">31018</td>
<td align="right">0.7383129</td>
<td align="right">79.04691</td>
<td align="right">2.5544633</td>
<td align="right">0.1022814</td>
<td align="right">0.9902034</td>
</tr>
<tr class="odd">
<td>06A12</td>
<td align="right">6</td>
<td align="right">32760</td>
<td align="right">0.8518273</td>
<td align="right">88.15047</td>
<td align="right">3.1319317</td>
<td align="right">0.0214732</td>
<td align="right">1.6681026</td>
</tr>
<tr class="even">
<td>06B12</td>
<td align="right">6</td>
<td align="right">34579</td>
<td align="right">0.8991250</td>
<td align="right">92.14395</td>
<td align="right">3.2879925</td>
<td align="right">0.0140365</td>
<td align="right">1.8527400</td>
</tr>
<tr class="odd">
<td>07A12</td>
<td align="right">7</td>
<td align="right">31481</td>
<td align="right">0.7995175</td>
<td align="right">82.92103</td>
<td align="right">3.8488803</td>
<td align="right">0.0023701</td>
<td align="right">2.6252267</td>
</tr>
<tr class="even">
<td>07B12</td>
<td align="right">7</td>
<td align="right">28998</td>
<td align="right">0.7364571</td>
<td align="right">76.64930</td>
<td align="right">3.5114438</td>
<td align="right">0.0076324</td>
<td align="right">2.1173377</td>
</tr>
<tr class="odd">
<td>08A12</td>
<td align="right">8</td>
<td align="right">32999</td>
<td align="right">0.8647310</td>
<td align="right">88.15897</td>
<td align="right">3.7874855</td>
<td align="right">0.0029637</td>
<td align="right">2.5281661</td>
</tr>
<tr class="even">
<td>08B12</td>
<td align="right">8</td>
<td align="right">34338</td>
<td align="right">0.8998192</td>
<td align="right">91.40012</td>
<td align="right">3.9356094</td>
<td align="right">0.0017472</td>
<td align="right">2.7576602</td>
</tr>
<tr class="odd">
<td>09A12</td>
<td align="right">9</td>
<td align="right">34990</td>
<td align="right">0.7969570</td>
<td align="right">81.53001</td>
<td align="right">5.9461083</td>
<td align="right">0.0000002</td>
<td align="right">6.7837172</td>
</tr>
<tr class="even">
<td>09B12</td>
<td align="right">9</td>
<td align="right">38983</td>
<td align="right">0.8879044</td>
<td align="right">90.32560</td>
<td align="right">6.6560607</td>
<td align="right">0.0000000</td>
<td align="right">8.5044463</td>
</tr>
<tr class="odd">
<td>10A12</td>
<td align="right">10</td>
<td align="right">36991</td>
<td align="right">0.8742747</td>
<td align="right">89.35443</td>
<td align="right">4.3967436</td>
<td align="right">0.0002952</td>
<td align="right">3.5299142</td>
</tr>
<tr class="even">
<td>10B12</td>
<td align="right">10</td>
<td align="right">35605</td>
<td align="right">0.8415169</td>
<td align="right">86.32523</td>
<td align="right">4.2177554</td>
<td align="right">0.0005825</td>
<td align="right">3.2347260</td>
</tr>
<tr class="odd">
<td>11A12</td>
<td align="right">11</td>
<td align="right">40557</td>
<td align="right">0.9954470</td>
<td align="right">99.62165</td>
<td align="right">1.7960449</td>
<td align="right">0.3966139</td>
<td align="right">0.4016321</td>
</tr>
<tr class="even">
<td>11B12</td>
<td align="right">11</td>
<td align="right">37285</td>
<td align="right">0.9151378</td>
<td align="right">92.37214</td>
<td align="right">1.5933371</td>
<td align="right">0.4843136</td>
<td align="right">0.3148733</td>
</tr>
<tr class="odd">
<td>12A12</td>
<td align="right">12</td>
<td align="right">38378</td>
<td align="right">0.9549736</td>
<td align="right">96.50145</td>
<td align="right">1.7357792</td>
<td align="right">0.4170330</td>
<td align="right">0.3798296</td>
</tr>
<tr class="even">
<td>12B12</td>
<td align="right">12</td>
<td align="right">36268</td>
<td align="right">0.9024697</td>
<td align="right">92.20341</td>
<td align="right">1.5924375</td>
<td align="right">0.4843136</td>
<td align="right">0.3148733</td>
</tr>
<tr class="odd">
<td>13A12</td>
<td align="right">13</td>
<td align="right">37554</td>
<td align="right">0.9484172</td>
<td align="right">95.58200</td>
<td align="right">1.0523741</td>
<td align="right">0.8170508</td>
<td align="right">0.0877510</td>
</tr>
<tr class="even">
<td>13B12</td>
<td align="right">13</td>
<td align="right">34465</td>
<td align="right">0.8704052</td>
<td align="right">88.41989</td>
<td align="right">0.8630982</td>
<td align="right">0.8917906</td>
<td align="right">0.0497371</td>
</tr>
<tr class="odd">
<td>14A12</td>
<td align="right">14</td>
<td align="right">29114</td>
<td align="right">0.7881003</td>
<td align="right">78.69880</td>
<td align="right">0.6648434</td>
<td align="right">0.9330662</td>
<td align="right">0.0300875</td>
</tr>
<tr class="even">
<td>14B12</td>
<td align="right">14</td>
<td align="right">31633</td>
<td align="right">0.8562882</td>
<td align="right">86.12432</td>
<td align="right">0.9150780</td>
<td align="right">0.8732382</td>
<td align="right">0.0588673</td>
</tr>
<tr class="odd">
<td>15A12</td>
<td align="right">15</td>
<td align="right">33124</td>
<td align="right">0.8494313</td>
<td align="right">86.49818</td>
<td align="right">0.7232261</td>
<td align="right">0.9199074</td>
<td align="right">0.0362559</td>
</tr>
<tr class="even">
<td>15B12</td>
<td align="right">15</td>
<td align="right">32180</td>
<td align="right">0.8252234</td>
<td align="right">84.10597</td>
<td align="right">0.6644467</td>
<td align="right">0.9330662</td>
<td align="right">0.0300875</td>
</tr>
<tr class="odd">
<td>16A12</td>
<td align="right">16</td>
<td align="right">28576</td>
<td align="right">0.8277740</td>
<td align="right">84.63658</td>
<td align="right">0.7826548</td>
<td align="right">0.9060414</td>
<td align="right">0.0428520</td>
</tr>
<tr class="even">
<td>16B12</td>
<td align="right">16</td>
<td align="right">25385</td>
<td align="right">0.7353388</td>
<td align="right">75.01022</td>
<td align="right">0.5369949</td>
<td align="right">0.9330662</td>
<td align="right">0.0300875</td>
</tr>
<tr class="odd">
<td>17A12</td>
<td align="right">17</td>
<td align="right">30476</td>
<td align="right">0.8362190</td>
<td align="right">83.61734</td>
<td align="right">1.5110402</td>
<td align="right">0.5361907</td>
<td align="right">0.2706807</td>
</tr>
<tr class="even">
<td>17B12</td>
<td align="right">17</td>
<td align="right">29380</td>
<td align="right">0.8061462</td>
<td align="right">80.26197</td>
<td align="right">1.4183340</td>
<td align="right">0.5798132</td>
<td align="right">0.2367119</td>
</tr>
<tr class="odd">
<td>18A12</td>
<td align="right">18</td>
<td align="right">37191</td>
<td align="right">0.9128754</td>
<td align="right">92.23756</td>
<td align="right">1.9312183</td>
<td align="right">0.3203252</td>
<td align="right">0.4944090</td>
</tr>
<tr class="even">
<td>18B12</td>
<td align="right">18</td>
<td align="right">39189</td>
<td align="right">0.9619175</td>
<td align="right">96.69449</td>
<td align="right">2.0793879</td>
<td align="right">0.2549801</td>
<td align="right">0.5934937</td>
</tr>
<tr class="odd">
<td>19A12</td>
<td align="right">19</td>
<td align="right">32305</td>
<td align="right">0.8646833</td>
<td align="right">88.54249</td>
<td align="right">1.7199327</td>
<td align="right">0.4239580</td>
<td align="right">0.3726772</td>
</tr>
<tr class="even">
<td>19B12</td>
<td align="right">19</td>
<td align="right">31816</td>
<td align="right">0.8515946</td>
<td align="right">87.34039</td>
<td align="right">1.6854284</td>
<td align="right">0.4339075</td>
<td align="right">0.3626029</td>
</tr>
</tbody>
</table>
<hr />
</div>
</div>
<div id="comparison-between-viability-scores" class="section level1">
<h1>Comparison between viability scores</h1>
<div id="ctb-versus-viability" class="section level2">
<h2>CTB versus viability</h2>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1"><span class="co">#### Dot plots to compare viability scores ####</span></a>
<a class="sourceLine" id="cb37-2" data-line-number="2"></a>
<a class="sourceLine" id="cb37-3" data-line-number="3"></a>
<a class="sourceLine" id="cb37-4" data-line-number="4"><span class="co"># names(inhibTable)</span></a>
<a class="sourceLine" id="cb37-5" data-line-number="5"><span class="co"># par(mfrow = c(2,2))</span></a>
<a class="sourceLine" id="cb37-6" data-line-number="6"></a>
<a class="sourceLine" id="cb37-7" data-line-number="7"><span class="co">#### Dot plot: viability ratio versus relative viability ####</span></a>
<a class="sourceLine" id="cb37-8" data-line-number="8"><span class="kw">plot</span>(inhibTable[, <span class="kw">c</span>(<span class="st">&quot;CTB&quot;</span>, <span class="st">&quot;Vrel&quot;</span>)],</a>
<a class="sourceLine" id="cb37-9" data-line-number="9">     <span class="dt">main =</span> <span class="st">&quot;CTB vs relative viability&quot;</span>,</a>
<a class="sourceLine" id="cb37-10" data-line-number="10">     <span class="dt">xlab =</span> <span class="st">&quot;Cell Titer Blue intensity (CTB)&quot;</span>, </a>
<a class="sourceLine" id="cb37-11" data-line-number="11">     <span class="dt">ylab =</span> <span class="st">&quot;Relative viability (I)&quot;</span>, </a>
<a class="sourceLine" id="cb37-12" data-line-number="12">     <span class="dt">col =</span> inhibTable[, <span class="st">&quot;color&quot;</span>],</a>
<a class="sourceLine" id="cb37-13" data-line-number="13">     <span class="dt">pch =</span> inhibTable[, <span class="st">&quot;pch&quot;</span>],</a>
<a class="sourceLine" id="cb37-14" data-line-number="14"><span class="co">#     xlim = c(0, max(inhibTable$R)*1.1),</span></a>
<a class="sourceLine" id="cb37-15" data-line-number="15">     <span class="dt">cex =</span> <span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb37-16" data-line-number="16">     <span class="dt">las =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb37-17" data-line-number="17"></a>
<a class="sourceLine" id="cb37-18" data-line-number="18"><span class="co">## Mark cell controls</span></a>
<a class="sourceLine" id="cb37-19" data-line-number="19"><span class="kw">points</span>(inhibTable[wellType <span class="op">==</span><span class="st"> &quot;cellCtl&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;CTB&quot;</span>, <span class="st">&quot;Vrel&quot;</span>)], </a>
<a class="sourceLine" id="cb37-20" data-line-number="20">       <span class="dt">col =</span> markColor[<span class="st">&quot;cellCtl&quot;</span>], <span class="dt">pch =</span> markPCh[<span class="st">&quot;cellCtl&quot;</span>], <span class="dt">cex =</span> <span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb37-21" data-line-number="21"><span class="co">## Mark virus controls</span></a>
<a class="sourceLine" id="cb37-22" data-line-number="22"><span class="kw">points</span>(inhibTable[wellType <span class="op">==</span><span class="st"> &quot;virusCtl&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;CTB&quot;</span>, <span class="st">&quot;Vrel&quot;</span>)], </a>
<a class="sourceLine" id="cb37-23" data-line-number="23">       <span class="dt">col =</span> markColor[<span class="st">&quot;virusCtl&quot;</span>], <span class="dt">pch =</span> markPCh[<span class="st">&quot;virusCtl&quot;</span>], <span class="dt">cex =</span> <span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb37-24" data-line-number="24"><span class="co">## Mark arbidol controls</span></a>
<a class="sourceLine" id="cb37-25" data-line-number="25"><span class="kw">points</span>(inhibTable[arbidolWells, <span class="kw">c</span>(<span class="st">&quot;CTB&quot;</span>, <span class="st">&quot;Vrel&quot;</span>)], </a>
<a class="sourceLine" id="cb37-26" data-line-number="26">       <span class="dt">col =</span> markColor[<span class="st">&quot;Arbidol&quot;</span>], <span class="dt">pch =</span> markPCh[<span class="st">&quot;Arbidol&quot;</span>], <span class="dt">cex =</span> <span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb37-27" data-line-number="27"><span class="co">## Mark Hydroxychloroquine</span></a>
<a class="sourceLine" id="cb37-28" data-line-number="28"><span class="kw">points</span>(inhibTable[HOClSindex, <span class="kw">c</span>(<span class="st">&quot;CTB&quot;</span>, <span class="st">&quot;Vrel&quot;</span>)], </a>
<a class="sourceLine" id="cb37-29" data-line-number="29">       <span class="dt">col =</span> markColor[<span class="st">&quot;Hydroxychloroquine&quot;</span>], <span class="dt">pch =</span> markPCh[<span class="st">&quot;Hydroxychloroquine&quot;</span>], <span class="dt">cex =</span> <span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb37-30" data-line-number="30"></a>
<a class="sourceLine" id="cb37-31" data-line-number="31"><span class="co">## Grid + specific values for the selected metrics</span></a>
<a class="sourceLine" id="cb37-32" data-line-number="32"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">-100</span>, <span class="dt">to =</span> <span class="dv">150</span>, <span class="dt">by =</span> <span class="dv">10</span>), <span class="dt">col =</span> <span class="st">&quot;#DDDDDD&quot;</span>)</a>
<a class="sourceLine" id="cb37-33" data-line-number="33"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb37-34" data-line-number="34"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">100</span>, <span class="dt">col =</span> <span class="st">&quot;#00BB00&quot;</span>)</a>
<a class="sourceLine" id="cb37-35" data-line-number="35"><span class="kw">abline</span>(<span class="dt">v =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="kw">max</span>(inhibTable<span class="op">$</span>CTB), <span class="dt">by =</span> <span class="dv">2000</span>), <span class="dt">col =</span> <span class="st">&quot;#DDDDDD&quot;</span>)</a>
<a class="sourceLine" id="cb37-36" data-line-number="36"><span class="kw">abline</span>(<span class="dt">v =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="kw">max</span>(inhibTable<span class="op">$</span>CTB), <span class="dt">by =</span> <span class="dv">10000</span>), <span class="dt">col =</span> <span class="st">&quot;#BBBBBB&quot;</span>)</a>
<a class="sourceLine" id="cb37-37" data-line-number="37"><span class="kw">abline</span>(<span class="dt">v =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb37-38" data-line-number="38"></a>
<a class="sourceLine" id="cb37-39" data-line-number="39"><span class="co">## Legends</span></a>
<a class="sourceLine" id="cb37-40" data-line-number="40"><span class="kw">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="dt">legend =</span> <span class="kw">names</span>(plateColor), </a>
<a class="sourceLine" id="cb37-41" data-line-number="41">       <span class="dt">title =</span> <span class="st">&quot;Plate&quot;</span>, <span class="dt">fill =</span> plateColor, <span class="dt">cex =</span> <span class="fl">0.6</span>)</a>
<a class="sourceLine" id="cb37-42" data-line-number="42"><span class="kw">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="dt">legend =</span> <span class="kw">names</span>(markColor), </a>
<a class="sourceLine" id="cb37-43" data-line-number="43">       <span class="dt">title =</span> <span class="st">&quot;Markers&quot;</span>, </a>
<a class="sourceLine" id="cb37-44" data-line-number="44">       <span class="dt">col =</span> markColor, </a>
<a class="sourceLine" id="cb37-45" data-line-number="45">       <span class="dt">pch =</span> markPCh,</a>
<a class="sourceLine" id="cb37-46" data-line-number="46">       <span class="dt">cex =</span> <span class="fl">0.6</span>)</a></code></pre></div>
<div class="figure" style="text-align: center">
<img src="figures/touret_sars-cov-2_inhibitorscompa_dotplot_CTB_vs_I-1.png" alt="Comparison between viability scores. CTB versus relative viability ($V_{r}$). Diamonds: cell control (uninfected cells). Plain triangles: virus control (untreated infected cells). Black plain circles: arbidol control duplicates per plate. Orange square: Hydroxychloroquine sulfate. " width="100%" />
<p class="caption">
Comparison between viability scores. CTB versus relative viability (<span class="math inline">\(V_{r}\)</span>). Diamonds: cell control (uninfected cells). Plain triangles: virus control (untreated infected cells). Black plain circles: arbidol control duplicates per plate. Orange square: Hydroxychloroquine sulfate.
</p>
</div>
</div>
<div id="relative-versus-iqr-standardised-viability" class="section level2">
<h2>Relative versus IQR-standardised viability</h2>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" data-line-number="1"><span class="co">#### Dot plot: IQR-standardized versus relative viability ####</span></a>
<a class="sourceLine" id="cb38-2" data-line-number="2"><span class="kw">plot</span>(inhibTable[, <span class="kw">c</span>(<span class="st">&quot;Vrel&quot;</span>, <span class="st">&quot;z&quot;</span>)],</a>
<a class="sourceLine" id="cb38-3" data-line-number="3">     <span class="dt">main =</span> <span class="st">&quot;Relative viability vs IQR-standardized viability&quot;</span>,</a>
<a class="sourceLine" id="cb38-4" data-line-number="4">     <span class="dt">xlab =</span> <span class="st">&quot;Relative viability (I)&quot;</span>,</a>
<a class="sourceLine" id="cb38-5" data-line-number="5">     <span class="dt">ylab =</span> <span class="st">&quot;IQR-standardized viability (z-score)&quot;</span>,</a>
<a class="sourceLine" id="cb38-6" data-line-number="6">     <span class="dt">col =</span> inhibTable[, <span class="st">&quot;color&quot;</span>],</a>
<a class="sourceLine" id="cb38-7" data-line-number="7">     <span class="dt">pch =</span> inhibTable[, <span class="st">&quot;pch&quot;</span>],</a>
<a class="sourceLine" id="cb38-8" data-line-number="8">     <span class="dt">cex =</span> <span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb38-9" data-line-number="9">     <span class="dt">xlim =</span> <span class="kw">c</span>(VrFloor, VrCeiling),</a>
<a class="sourceLine" id="cb38-10" data-line-number="10">     <span class="dt">panel.first =</span> <span class="kw">grid</span>(),</a>
<a class="sourceLine" id="cb38-11" data-line-number="11">     <span class="dt">las =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb38-12" data-line-number="12"></a>
<a class="sourceLine" id="cb38-13" data-line-number="13"><span class="co">## Mark cell controls</span></a>
<a class="sourceLine" id="cb38-14" data-line-number="14"><span class="kw">points</span>(inhibTable[wellType <span class="op">==</span><span class="st"> &quot;cellCtl&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;Vrel&quot;</span>, <span class="st">&quot;z&quot;</span>)], </a>
<a class="sourceLine" id="cb38-15" data-line-number="15">       <span class="dt">col =</span> markColor[<span class="st">&quot;cellCtl&quot;</span>], <span class="dt">pch =</span> markPCh[<span class="st">&quot;cellCtl&quot;</span>], <span class="dt">cex =</span> <span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb38-16" data-line-number="16"><span class="co">## Mark virus controls</span></a>
<a class="sourceLine" id="cb38-17" data-line-number="17"><span class="kw">points</span>(inhibTable[wellType <span class="op">==</span><span class="st"> &quot;virusCtl&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;Vrel&quot;</span>, <span class="st">&quot;z&quot;</span>)], </a>
<a class="sourceLine" id="cb38-18" data-line-number="18">       <span class="dt">col =</span> markColor[<span class="st">&quot;virusCtl&quot;</span>], <span class="dt">pch =</span> markPCh[<span class="st">&quot;virusCtl&quot;</span>], <span class="dt">cex =</span> <span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb38-19" data-line-number="19"><span class="co">## Mark arbidol controls</span></a>
<a class="sourceLine" id="cb38-20" data-line-number="20"><span class="kw">points</span>(inhibTable[arbidolWells, <span class="kw">c</span>(<span class="st">&quot;Vrel&quot;</span>, <span class="st">&quot;z&quot;</span>)], </a>
<a class="sourceLine" id="cb38-21" data-line-number="21">       <span class="dt">col =</span> markColor[<span class="st">&quot;Arbidol&quot;</span>], <span class="dt">pch =</span> markPCh[<span class="st">&quot;Arbidol&quot;</span>], <span class="dt">cex =</span> <span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb38-22" data-line-number="22"><span class="co">## Mark Hydroxychloroquine</span></a>
<a class="sourceLine" id="cb38-23" data-line-number="23"><span class="kw">points</span>(inhibTable[HOClSindex, <span class="kw">c</span>(<span class="st">&quot;Vrel&quot;</span>, <span class="st">&quot;z&quot;</span>)], </a>
<a class="sourceLine" id="cb38-24" data-line-number="24">       <span class="dt">col =</span> markColor[<span class="st">&quot;Hydroxychloroquine&quot;</span>], <span class="dt">pch =</span> markPCh[<span class="st">&quot;Hydroxychloroquine&quot;</span>], <span class="dt">cex =</span> <span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb38-25" data-line-number="25"></a>
<a class="sourceLine" id="cb38-26" data-line-number="26"><span class="co">## Mark milestones for the selected metrics</span></a>
<a class="sourceLine" id="cb38-27" data-line-number="27"><span class="kw">abline</span>(<span class="dt">v =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">100</span>, <span class="dv">150</span>, <span class="dv">10</span>), <span class="dt">col =</span> <span class="st">&quot;#EEEEEE&quot;</span>)</a>
<a class="sourceLine" id="cb38-28" data-line-number="28"><span class="kw">abline</span>(<span class="dt">v =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">100</span>, <span class="dv">150</span>, <span class="dv">50</span>), <span class="dt">col =</span> <span class="st">&quot;#BBBBBB&quot;</span>)</a>
<a class="sourceLine" id="cb38-29" data-line-number="29"><span class="kw">abline</span>(<span class="dt">v =</span> <span class="dv">0</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb38-30" data-line-number="30"><span class="kw">abline</span>(<span class="dt">v =</span> <span class="dv">100</span>, <span class="dt">col =</span> <span class="st">&quot;#00BB00&quot;</span>)</a>
<a class="sourceLine" id="cb38-31" data-line-number="31"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">1</span>), <span class="dt">col =</span> <span class="st">&quot;#EEEEEE&quot;</span>)</a>
<a class="sourceLine" id="cb38-32" data-line-number="32"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">5</span>), <span class="dt">col =</span> <span class="st">&quot;#BBBBBB&quot;</span>)</a>
<a class="sourceLine" id="cb38-33" data-line-number="33"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb38-34" data-line-number="34"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">lty =</span> <span class="st">&quot;dashed&quot;</span>)</a>
<a class="sourceLine" id="cb38-35" data-line-number="35"></a>
<a class="sourceLine" id="cb38-36" data-line-number="36"><span class="co">## Legends</span></a>
<a class="sourceLine" id="cb38-37" data-line-number="37"><span class="kw">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="dt">legend =</span> <span class="kw">names</span>(plateColor), </a>
<a class="sourceLine" id="cb38-38" data-line-number="38">       <span class="dt">title =</span> <span class="st">&quot;Plate&quot;</span>, <span class="dt">fill =</span> plateColor, <span class="dt">cex =</span> <span class="fl">0.7</span>)</a>
<a class="sourceLine" id="cb38-39" data-line-number="39"><span class="kw">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="dt">legend =</span> <span class="kw">names</span>(markColor), </a>
<a class="sourceLine" id="cb38-40" data-line-number="40">       <span class="dt">title =</span> <span class="st">&quot;Markers&quot;</span>, </a>
<a class="sourceLine" id="cb38-41" data-line-number="41">       <span class="dt">col =</span> markColor, </a>
<a class="sourceLine" id="cb38-42" data-line-number="42">       <span class="dt">pch =</span> markPCh,</a>
<a class="sourceLine" id="cb38-43" data-line-number="43">       <span class="dt">cex =</span> <span class="fl">0.7</span>)</a></code></pre></div>
<div class="figure" style="text-align: center">
<img src="figures/touret_sars-cov-2_inhibitorscompa_dotplot_I_vs_z-1.png" alt="Comparison between viability scores. Relative viability versus IQR-standardized viability (z-score). Diamonds: cell control (uninfected cells). Plain triangles: virus control (untreated infected cells). Black plain circles: arbidol control duplicates per plate. Orange square: Hydroxychloroquine sulfate. " width="100%" />
<p class="caption">
Comparison between viability scores. Relative viability versus IQR-standardized viability (z-score). Diamonds: cell control (uninfected cells). Plain triangles: virus control (untreated infected cells). Black plain circles: arbidol control duplicates per plate. Orange square: Hydroxychloroquine sulfate.
</p>
</div>
</div>
<div id="fdr-versus-relative-viability" class="section level2">
<h2>FDR versus relative viability</h2>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1"><span class="co">#### Dot plot: FDR versus relative viability ####</span></a>
<a class="sourceLine" id="cb39-2" data-line-number="2"><span class="kw">plot</span>(<span class="dt">x =</span> inhibTable[, <span class="st">&quot;Vrel&quot;</span>],</a>
<a class="sourceLine" id="cb39-3" data-line-number="3">     <span class="dt">y =</span> <span class="op">-</span>inhibTable[, <span class="st">&quot;log10FDR&quot;</span>],</a>
<a class="sourceLine" id="cb39-4" data-line-number="4">     <span class="dt">main =</span> <span class="st">&quot;relative viability vs FDR&quot;</span>,</a>
<a class="sourceLine" id="cb39-5" data-line-number="5">     <span class="dt">xlab =</span> <span class="st">&quot;relative viability&quot;</span>,</a>
<a class="sourceLine" id="cb39-6" data-line-number="6">     <span class="dt">ylab =</span> <span class="st">&quot;-log10(FDR)&quot;</span>,</a>
<a class="sourceLine" id="cb39-7" data-line-number="7">     <span class="dt">col =</span> inhibTable[, <span class="st">&quot;color&quot;</span>],</a>
<a class="sourceLine" id="cb39-8" data-line-number="8">     <span class="dt">pch =</span> inhibTable[, <span class="st">&quot;pch&quot;</span>],</a>
<a class="sourceLine" id="cb39-9" data-line-number="9">     <span class="dt">cex =</span> <span class="fl">0.7</span>,</a>
<a class="sourceLine" id="cb39-10" data-line-number="10">     <span class="dt">xlim =</span> <span class="kw">c</span>(VrFloor, VrCeiling),</a>
<a class="sourceLine" id="cb39-11" data-line-number="11">     <span class="dt">panel.first =</span> <span class="kw">grid</span>(),</a>
<a class="sourceLine" id="cb39-12" data-line-number="12">     <span class="dt">las =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb39-13" data-line-number="13"><span class="co">## Mark arbidol controls</span></a>
<a class="sourceLine" id="cb39-14" data-line-number="14"><span class="kw">points</span>(<span class="dt">x =</span> inhibTable[arbidolWells, <span class="st">&quot;Vrel&quot;</span>],</a>
<a class="sourceLine" id="cb39-15" data-line-number="15">       <span class="dt">y =</span> <span class="op">-</span>inhibTable[arbidolWells, <span class="st">&quot;log10FDR&quot;</span>], </a>
<a class="sourceLine" id="cb39-16" data-line-number="16">       <span class="dt">col =</span> markColor[<span class="st">&quot;Arbidol&quot;</span>], </a>
<a class="sourceLine" id="cb39-17" data-line-number="17">       <span class="dt">pch =</span> markPCh[<span class="st">&quot;Arbidol&quot;</span>], <span class="dt">cex =</span> <span class="fl">0.7</span>)</a>
<a class="sourceLine" id="cb39-18" data-line-number="18"><span class="co">## Mark Hydroxychloroquine</span></a>
<a class="sourceLine" id="cb39-19" data-line-number="19"><span class="kw">points</span>(<span class="dt">x =</span> inhibTable[HOClSindex, <span class="st">&quot;Vrel&quot;</span>],</a>
<a class="sourceLine" id="cb39-20" data-line-number="20">       <span class="dt">y =</span> <span class="op">-</span>inhibTable[HOClSindex, <span class="st">&quot;log10FDR&quot;</span>], </a>
<a class="sourceLine" id="cb39-21" data-line-number="21">       <span class="dt">col =</span> markColor[<span class="st">&quot;Hydroxychloroquine&quot;</span>], </a>
<a class="sourceLine" id="cb39-22" data-line-number="22">       <span class="dt">pch =</span> markPCh[<span class="st">&quot;Hydroxychloroquine&quot;</span>], <span class="dt">cex =</span> <span class="fl">0.7</span>)</a>
<a class="sourceLine" id="cb39-23" data-line-number="23"></a>
<a class="sourceLine" id="cb39-24" data-line-number="24"><span class="co">## Grid + specific values for the selected metrics</span></a>
<a class="sourceLine" id="cb39-25" data-line-number="25"><span class="kw">abline</span>(<span class="dt">v =</span> <span class="kw">seq</span>(VrFloor, VrCeiling, <span class="dv">10</span>), <span class="dt">col =</span> <span class="st">&quot;#EEEEEE&quot;</span>)</a>
<a class="sourceLine" id="cb39-26" data-line-number="26"><span class="kw">abline</span>(<span class="dt">v =</span> <span class="kw">seq</span>(VrFloor, VrCeiling, <span class="dv">50</span>), <span class="dt">col =</span> <span class="st">&quot;#BBBBBB&quot;</span>)</a>
<a class="sourceLine" id="cb39-27" data-line-number="27"><span class="kw">abline</span>(<span class="dt">v =</span> <span class="dv">0</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb39-28" data-line-number="28"><span class="kw">abline</span>(<span class="dt">v =</span> <span class="dv">100</span>, <span class="dt">col =</span> <span class="st">&quot;#00BB00&quot;</span>)</a>
<a class="sourceLine" id="cb39-29" data-line-number="29"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="kw">seq</span>(<span class="dv">0</span>, sigCeiling, <span class="dv">1</span>), <span class="dt">col =</span> <span class="st">&quot;#EEEEEE&quot;</span>)</a>
<a class="sourceLine" id="cb39-30" data-line-number="30"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="kw">seq</span>(<span class="dv">0</span>, sigCeiling, <span class="dv">5</span>), <span class="dt">col =</span> <span class="st">&quot;#BBBBBB&quot;</span>)</a>
<a class="sourceLine" id="cb39-31" data-line-number="31"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb39-32" data-line-number="32"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="op">-</span><span class="kw">log10</span>(alpha), <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb39-33" data-line-number="33"></a>
<a class="sourceLine" id="cb39-34" data-line-number="34"><span class="co">## Legends</span></a>
<a class="sourceLine" id="cb39-35" data-line-number="35"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">legend =</span> <span class="kw">names</span>(plateColor), </a>
<a class="sourceLine" id="cb39-36" data-line-number="36">       <span class="dt">title =</span> <span class="st">&quot;Plate&quot;</span>, <span class="dt">fill =</span> plateColor, <span class="dt">cex =</span> <span class="fl">0.7</span>)</a>
<a class="sourceLine" id="cb39-37" data-line-number="37"><span class="kw">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="dt">legend =</span> <span class="kw">names</span>(markColor), </a>
<a class="sourceLine" id="cb39-38" data-line-number="38">       <span class="dt">title =</span> <span class="st">&quot;Markers&quot;</span>, </a>
<a class="sourceLine" id="cb39-39" data-line-number="39">       <span class="dt">col =</span> markColor, </a>
<a class="sourceLine" id="cb39-40" data-line-number="40">       <span class="dt">pch =</span> markPCh,</a>
<a class="sourceLine" id="cb39-41" data-line-number="41">       <span class="dt">cex =</span> <span class="fl">0.7</span>)</a></code></pre></div>
<div class="figure" style="text-align: center">
<img src="figures/touret_sars-cov-2_inhibitorscompa_dotplot_Vr_vs_FDR-1.png" alt="Comparison between viability scores. Diamonds: cell control (uninfected cells). Plain triangles: virus control (untreated infected cells). Black plain circles: arbidol control duplicates per plate. Orange square: Hydroxychloroquine sulfate. " width="100%" />
<p class="caption">
Comparison between viability scores. Diamonds: cell control (uninfected cells). Plain triangles: virus control (untreated infected cells). Black plain circles: arbidol control duplicates per plate. Orange square: Hydroxychloroquine sulfate.
</p>
</div>
</div>
<div id="relative-viability-versus-inhibition-index" class="section level2">
<h2>Relative viability versus inhibition index</h2>
<p>. We compare hereafter the values of the relative variability with the inhibition index defined in the bioRxiv publication (<a href="https://doi.org/10.1101/2020.04.03.023846">DOI 10.1101/2020.04.03.023846</a>).</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" data-line-number="1">iiFloor &lt;-<span class="st"> </span><span class="kw">floor</span>(<span class="kw">min</span>(inhibTable<span class="op">$</span>Inhibition.Index, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb40-2" data-line-number="2">iiCeiling &lt;-<span class="st"> </span><span class="kw">ceiling</span>(<span class="kw">max</span>(inhibTable<span class="op">$</span>Inhibition.Index, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb40-3" data-line-number="3"></a>
<a class="sourceLine" id="cb40-4" data-line-number="4"><span class="co">#### Dot plot: Relative viability versus inhibition index ####</span></a>
<a class="sourceLine" id="cb40-5" data-line-number="5"><span class="kw">plot</span>(<span class="dt">x =</span> inhibTable[, <span class="st">&quot;Inhibition.Index&quot;</span>],</a>
<a class="sourceLine" id="cb40-6" data-line-number="6">     <span class="dt">y =</span> inhibTable[, <span class="st">&quot;Vrel&quot;</span>],</a>
<a class="sourceLine" id="cb40-7" data-line-number="7">     <span class="dt">main =</span> <span class="st">&quot;Relative viability vs inhibition index&quot;</span>,</a>
<a class="sourceLine" id="cb40-8" data-line-number="8">     <span class="dt">xlab =</span> <span class="st">&quot;Inhibition index&quot;</span>,</a>
<a class="sourceLine" id="cb40-9" data-line-number="9">     <span class="dt">ylab =</span> <span class="st">&quot;Vr = (R - Lvc) / (Lcc - Lvc)&quot;</span>,</a>
<a class="sourceLine" id="cb40-10" data-line-number="10">     <span class="dt">col =</span> inhibTable[, <span class="st">&quot;color&quot;</span>],</a>
<a class="sourceLine" id="cb40-11" data-line-number="11">     <span class="dt">pch =</span> inhibTable[, <span class="st">&quot;pch&quot;</span>],</a>
<a class="sourceLine" id="cb40-12" data-line-number="12">     <span class="dt">cex =</span> <span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb40-13" data-line-number="13">     <span class="dt">xlim =</span> <span class="kw">c</span>(iiFloor, iiCeiling),</a>
<a class="sourceLine" id="cb40-14" data-line-number="14">     <span class="dt">panel.first =</span> <span class="kw">c</span>(</a>
<a class="sourceLine" id="cb40-15" data-line-number="15">       <span class="kw">abline</span>(<span class="dt">v =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="fl">0.5</span>, <span class="dv">2</span>, <span class="fl">0.5</span>), <span class="dt">col =</span> <span class="st">&quot;#BBBBBB&quot;</span>),</a>
<a class="sourceLine" id="cb40-16" data-line-number="16">       <span class="kw">abline</span>(<span class="dt">h =</span> <span class="kw">seq</span>(VrFloor, VrCeiling, <span class="dv">10</span>), <span class="dt">col =</span> <span class="st">&quot;#EEEEEE&quot;</span>),</a>
<a class="sourceLine" id="cb40-17" data-line-number="17">       <span class="kw">abline</span>(<span class="dt">h =</span> <span class="kw">seq</span>(VrFloor, VrCeiling, <span class="dv">50</span>), <span class="dt">col =</span> <span class="st">&quot;#BBBBBB&quot;</span>),</a>
<a class="sourceLine" id="cb40-18" data-line-number="18">       <span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">1</span>)), </a>
<a class="sourceLine" id="cb40-19" data-line-number="19">     <span class="dt">las =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb40-20" data-line-number="20"><span class="kw">abline</span>(<span class="dt">v =</span> <span class="dv">1</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb40-21" data-line-number="21"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb40-22" data-line-number="22"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">100</span>, <span class="dt">col =</span> <span class="st">&quot;#00BB00&quot;</span>)</a>
<a class="sourceLine" id="cb40-23" data-line-number="23"></a>
<a class="sourceLine" id="cb40-24" data-line-number="24"><span class="co">## Mark Hydroxychloroquine</span></a>
<a class="sourceLine" id="cb40-25" data-line-number="25"><span class="kw">points</span>(<span class="dt">x =</span> inhibTable[HOClSindex, <span class="st">&quot;Inhibition.Index&quot;</span>],</a>
<a class="sourceLine" id="cb40-26" data-line-number="26">       <span class="dt">y =</span> inhibTable[HOClSindex, <span class="st">&quot;Vrel&quot;</span>], </a>
<a class="sourceLine" id="cb40-27" data-line-number="27">       <span class="dt">col =</span> markColor[<span class="st">&quot;Hydroxychloroquine&quot;</span>], </a>
<a class="sourceLine" id="cb40-28" data-line-number="28">       <span class="dt">pch =</span> markPCh[<span class="st">&quot;Hydroxychloroquine&quot;</span>], <span class="dt">cex =</span> <span class="fl">0.7</span>)</a>
<a class="sourceLine" id="cb40-29" data-line-number="29"></a>
<a class="sourceLine" id="cb40-30" data-line-number="30"><span class="co">## Legends</span></a>
<a class="sourceLine" id="cb40-31" data-line-number="31"><span class="kw">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="dt">legend =</span> <span class="kw">names</span>(plateColor), </a>
<a class="sourceLine" id="cb40-32" data-line-number="32">       <span class="dt">title =</span> <span class="st">&quot;Plate&quot;</span>, <span class="dt">fill =</span> plateColor, <span class="dt">cex =</span> <span class="fl">0.7</span>)</a>
<a class="sourceLine" id="cb40-33" data-line-number="33"><span class="kw">legend</span>(<span class="st">&quot;topleft&quot;</span>, </a>
<a class="sourceLine" id="cb40-34" data-line-number="34">       <span class="dt">title =</span> <span class="st">&quot;Markers&quot;</span>, </a>
<a class="sourceLine" id="cb40-35" data-line-number="35">       <span class="dt">legend =</span> <span class="st">&quot;Hydroxychloroquine&quot;</span>, </a>
<a class="sourceLine" id="cb40-36" data-line-number="36">       <span class="dt">col =</span> markColor[<span class="st">&quot;Hydroxychloroquine&quot;</span>], </a>
<a class="sourceLine" id="cb40-37" data-line-number="37">       <span class="dt">pch =</span> markPCh[<span class="st">&quot;Hydroxychloroquine&quot;</span>],</a>
<a class="sourceLine" id="cb40-38" data-line-number="38">       <span class="dt">cex =</span> <span class="fl">0.7</span>)</a></code></pre></div>
<div class="figure" style="text-align: center">
<img src="figures/touret_sars-cov-2_inhibitorscompa_dotplot_ii_vs_I-1.png" alt="Comparison between viability scores. Diamonds: cell control (uninfected cells). Plain triangles: virus control (untreated infected cells). Black plain circles: arbidol control duplicates per plate. Orange square: Hydroxychloroquine sulfate. " width="100%" />
<p class="caption">
Comparison between viability scores. Diamonds: cell control (uninfected cells). Plain triangles: virus control (untreated infected cells). Black plain circles: arbidol control duplicates per plate. Orange square: Hydroxychloroquine sulfate.
</p>
</div>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" data-line-number="1"><span class="kw">par</span>(par.ori)</a></code></pre></div>
</div>
<div id="hit-molecules-selected-by-the-different-criteria" class="section level2">
<h2>Hit molecules selected by the different criteria</h2>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" data-line-number="1"><span class="co">#### Select candidate molecules accordint to different criteria ####</span></a>
<a class="sourceLine" id="cb42-2" data-line-number="2"></a>
<a class="sourceLine" id="cb42-3" data-line-number="3"><span class="co">## False Discovery Rate computed from the IQR-standardized viabilities</span></a>
<a class="sourceLine" id="cb42-4" data-line-number="4">inhibTable<span class="op">$</span>selected.FDR &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(inhibTable<span class="op">$</span>FDR <span class="op">&lt;</span><span class="st"> </span>alpha)</a>
<a class="sourceLine" id="cb42-5" data-line-number="5"><span class="co"># `table(inhibTable$selected.FDR)</span></a>
<a class="sourceLine" id="cb42-6" data-line-number="6"><span class="co"># sum(inhibTable$selected.FDR, na.rm = TRUE)</span></a>
<a class="sourceLine" id="cb42-7" data-line-number="7"></a>
<a class="sourceLine" id="cb42-8" data-line-number="8"><span class="co">## Previous inhibition index above 1 (Arbidol)</span></a>
<a class="sourceLine" id="cb42-9" data-line-number="9">inhibTable<span class="op">$</span>selected.ii &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(inhibTable<span class="op">$</span>Inhibition.Index <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb42-10" data-line-number="10"><span class="co"># table(inhibTable$selected.ii)</span></a>
<a class="sourceLine" id="cb42-11" data-line-number="11"><span class="co"># sum(inhibTable$selected.ii, na.rm = TRUE)</span></a>
<a class="sourceLine" id="cb42-12" data-line-number="12"></a>
<a class="sourceLine" id="cb42-13" data-line-number="13"><span class="co">## Relative viability higher than the mean of arbidol values on the same plate</span></a>
<a class="sourceLine" id="cb42-14" data-line-number="14">inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;selected.arbidolMean&quot;</span>] &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(</a>
<a class="sourceLine" id="cb42-15" data-line-number="15">  inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;Vrel&quot;</span>] <span class="op">&gt;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb42-16" data-line-number="16"><span class="st">    </span>statPerPlate[inhibTable[wellType <span class="op">==</span><span class="st"> &quot;treated&quot;</span>, <span class="st">&quot;Plate&quot;</span>], <span class="st">&quot;arbidolMean&quot;</span>])</a>
<a class="sourceLine" id="cb42-17" data-line-number="17"></a>
<a class="sourceLine" id="cb42-18" data-line-number="18"><span class="co"># table(inhibTable[arbidolWells, &quot;selected.arbidolMean&quot;] )</span></a>
<a class="sourceLine" id="cb42-19" data-line-number="19"><span class="co"># table(inhibTable[, &quot;selected.arbidolMean&quot;] )</span></a>
<a class="sourceLine" id="cb42-20" data-line-number="20"><span class="co"># table(inhibTable[, c(&quot;selected.ii&quot;, &quot;selected.arbidolMean&quot;)] )</span></a>
<a class="sourceLine" id="cb42-21" data-line-number="21"></a>
<a class="sourceLine" id="cb42-22" data-line-number="22"><span class="co"># diff &lt;- !is.na(inhibTable$selected.ii) &amp; (inhibTable$selected.ii != inhibTable$selected.arbidolMean)</span></a>
<a class="sourceLine" id="cb42-23" data-line-number="23"><span class="co"># View(inhibTable[diff, ])</span></a>
<a class="sourceLine" id="cb42-24" data-line-number="24"></a>
<a class="sourceLine" id="cb42-25" data-line-number="25"></a>
<a class="sourceLine" id="cb42-26" data-line-number="26"><span class="kw">kable</span>(<span class="kw">table</span>(inhibTable[, <span class="kw">c</span>(<span class="st">&quot;selected.FDR&quot;</span>, <span class="st">&quot;selected.arbidolMean&quot;</span>)]), </a>
<a class="sourceLine" id="cb42-27" data-line-number="27">      <span class="dt">caption =</span> <span class="st">&quot;Contingency table of the molecules selected by different criteria. Columns: inhibition index &gt;= 1. Rows: Vrel &gt; arbidol mean. &quot;</span>)</a></code></pre></div>
<table>
<caption>Contingency table of the molecules selected by different criteria. Columns: inhibition index &gt;= 1. Rows: Vrel &gt; arbidol mean.</caption>
<thead>
<tr class="header">
<th></th>
<th align="right">0</th>
<th align="right">1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td align="right">1397</td>
<td align="right">89</td>
</tr>
<tr class="even">
<td>1</td>
<td align="right">50</td>
<td align="right">22</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" data-line-number="1"><span class="co">## Compute some combinations between criteria</span></a>
<a class="sourceLine" id="cb43-2" data-line-number="2">inhibTable<span class="op">$</span>selected.FDRandArbidol &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb43-3" data-line-number="3"><span class="st">  </span><span class="kw">as.numeric</span>(inhibTable<span class="op">$</span>selected.FDR <span class="op">&amp;</span><span class="st"> </span>inhibTable<span class="op">$</span>selected.arbidolMean)</a>
<a class="sourceLine" id="cb43-4" data-line-number="4">inhibTable<span class="op">$</span>selected.FDRorArbidol &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb43-5" data-line-number="5"><span class="st">  </span><span class="kw">as.numeric</span>(inhibTable<span class="op">$</span>selected.FDR <span class="op">|</span><span class="st"> </span>inhibTable<span class="op">$</span>selected.arbidolMean)</a>
<a class="sourceLine" id="cb43-6" data-line-number="6">inhibTable<span class="op">$</span>selected.FDRonly &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb43-7" data-line-number="7"><span class="st">  </span><span class="kw">as.numeric</span>(inhibTable<span class="op">$</span>selected.FDR <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span>inhibTable<span class="op">$</span>selected.arbidolMean)</a>
<a class="sourceLine" id="cb43-8" data-line-number="8">inhibTable<span class="op">$</span>selected.ArbidolOnly &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb43-9" data-line-number="9"><span class="st">  </span><span class="kw">as.numeric</span>(<span class="op">!</span>inhibTable<span class="op">$</span>selected.FDR <span class="op">&amp;</span><span class="st"> </span>inhibTable<span class="op">$</span>selected.arbidolMean)</a>
<a class="sourceLine" id="cb43-10" data-line-number="10"></a>
<a class="sourceLine" id="cb43-11" data-line-number="11"></a>
<a class="sourceLine" id="cb43-12" data-line-number="12"></a>
<a class="sourceLine" id="cb43-13" data-line-number="13"><span class="kw">par</span>(par.ori)</a></code></pre></div>
<hr />
</div>
</div>
<div id="selected-hits" class="section level1">
<h1>Selected hits</h1>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" data-line-number="1"><span class="co">#### Select significant normalized II values ####</span></a>
<a class="sourceLine" id="cb44-2" data-line-number="2"></a>
<a class="sourceLine" id="cb44-3" data-line-number="3"><span class="kw">kable</span>(<span class="kw">t</span>(<span class="kw">table</span>(inhibTable<span class="op">$</span>FDR <span class="op">&lt;</span><span class="st"> </span>alpha)), <span class="dt">caption =</span> <span class="kw">paste</span>(<span class="st">&quot;Number of tests declared positive with FDR &lt;&quot;</span>, alpha))</a></code></pre></div>
<table>
<caption>Number of tests declared positive with FDR &lt; 0.05</caption>
<thead>
<tr class="header">
<th align="right">FALSE</th>
<th align="right">TRUE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1486</td>
<td align="right">72</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" data-line-number="1"><span class="co"># table(inhibTable$FDR &lt; alpha)</span></a>
<a class="sourceLine" id="cb45-2" data-line-number="2">selected &lt;-<span class="st"> </span><span class="kw">subset</span>(inhibTable, inhibTable<span class="op">$</span>FDR <span class="op">&lt;</span><span class="st"> </span>alpha)</a>
<a class="sourceLine" id="cb45-3" data-line-number="3"><span class="co"># names(selected)</span></a>
<a class="sourceLine" id="cb45-4" data-line-number="4"></a>
<a class="sourceLine" id="cb45-5" data-line-number="5"><span class="co">## Sort by decreasing adjusted p-value</span></a>
<a class="sourceLine" id="cb45-6" data-line-number="6">selected &lt;-<span class="st"> </span>selected[<span class="kw">order</span>(selected<span class="op">$</span>FDR, <span class="dt">decreasing =</span> <span class="ot">FALSE</span>), ]</a>
<a class="sourceLine" id="cb45-7" data-line-number="7"><span class="co"># kable(names(selected), row.names=TRUE)</span></a>
<a class="sourceLine" id="cb45-8" data-line-number="8"><span class="kw">names</span>(selected) &lt;-<span class="st"> </span><span class="kw">sub</span>(<span class="dt">pattern =</span> <span class="st">&quot;selected.&quot;</span>, </a>
<a class="sourceLine" id="cb45-9" data-line-number="9">                       <span class="dt">replacement =</span> <span class="st">&quot;+&quot;</span>, </a>
<a class="sourceLine" id="cb45-10" data-line-number="10">                       <span class="dt">x =</span> <span class="kw">names</span>(selected))</a>
<a class="sourceLine" id="cb45-11" data-line-number="11"></a>
<a class="sourceLine" id="cb45-12" data-line-number="12">selectedFields &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;ID&quot;</span>,</a>
<a class="sourceLine" id="cb45-13" data-line-number="13">                    <span class="co"># &quot;CTB&quot;,</span></a>
<a class="sourceLine" id="cb45-14" data-line-number="14">                    <span class="co"># &quot;cellControl&quot;,</span></a>
<a class="sourceLine" id="cb45-15" data-line-number="15">                    <span class="co"># &quot;virusControl&quot;,</span></a>
<a class="sourceLine" id="cb45-16" data-line-number="16">                    <span class="st">&quot;Chemical.name&quot;</span>,</a>
<a class="sourceLine" id="cb45-17" data-line-number="17">                    <span class="co"># &quot;Broad.Therapeutic.class&quot;,</span></a>
<a class="sourceLine" id="cb45-18" data-line-number="18">                    <span class="st">&quot;Reported.therapeutic.effect&quot;</span>,</a>
<a class="sourceLine" id="cb45-19" data-line-number="19">                    <span class="st">&quot;Inhibition.Index&quot;</span>,</a>
<a class="sourceLine" id="cb45-20" data-line-number="20">                    <span class="st">&quot;Vratio&quot;</span>,</a>
<a class="sourceLine" id="cb45-21" data-line-number="21">                    <span class="st">&quot;Vrel&quot;</span>,</a>
<a class="sourceLine" id="cb45-22" data-line-number="22">                    <span class="st">&quot;z&quot;</span>,</a>
<a class="sourceLine" id="cb45-23" data-line-number="23">                    <span class="co"># &quot;p.value&quot;,</span></a>
<a class="sourceLine" id="cb45-24" data-line-number="24">                    <span class="co"># &quot;FDR&quot;,</span></a>
<a class="sourceLine" id="cb45-25" data-line-number="25">                    <span class="st">&quot;sig&quot;</span>, </a>
<a class="sourceLine" id="cb45-26" data-line-number="26">                    <span class="st">&quot;+FDR&quot;</span>,</a>
<a class="sourceLine" id="cb45-27" data-line-number="27">                    <span class="st">&quot;+ii&quot;</span>,</a>
<a class="sourceLine" id="cb45-28" data-line-number="28">                    <span class="st">&quot;+arbidolMean&quot;</span>,</a>
<a class="sourceLine" id="cb45-29" data-line-number="29">                    <span class="st">&quot;+FDRandArbidol&quot;</span>,</a>
<a class="sourceLine" id="cb45-30" data-line-number="30">                    <span class="st">&quot;+FDRorArbidol&quot;</span>,</a>
<a class="sourceLine" id="cb45-31" data-line-number="31">                    <span class="st">&quot;+FDRonly&quot;</span>,</a>
<a class="sourceLine" id="cb45-32" data-line-number="32">                    <span class="st">&quot;+ArbidolOnly&quot;</span>)</a>
<a class="sourceLine" id="cb45-33" data-line-number="33"><span class="co"># kable(selectedFields)</span></a>
<a class="sourceLine" id="cb45-34" data-line-number="34"><span class="co"># View(selected[ , selectedFields])</span></a>
<a class="sourceLine" id="cb45-35" data-line-number="35"></a>
<a class="sourceLine" id="cb45-36" data-line-number="36"><span class="co">## Print selected molecules</span></a>
<a class="sourceLine" id="cb45-37" data-line-number="37"><span class="kw">kable</span>(selected[ , selectedFields], </a>
<a class="sourceLine" id="cb45-38" data-line-number="38">      <span class="dt">row.names =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb45-39" data-line-number="39">      <span class="dt">digits =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb45-40" data-line-number="40">      <span class="dt">caption =</span> <span class="st">&quot;Candidate moecules sorted by significance after plate-wise normalization. &quot;</span>)</a></code></pre></div>
<table>
<caption>Candidate moecules sorted by significance after plate-wise normalization.</caption>
<thead>
<tr class="header">
<th align="left">ID</th>
<th align="left">Chemical.name</th>
<th align="left">Reported.therapeutic.effect</th>
<th align="right">Inhibition.Index</th>
<th align="right">Vratio</th>
<th align="right">Vrel</th>
<th align="right">z</th>
<th align="right">sig</th>
<th align="right">+FDR</th>
<th align="right">+ii</th>
<th align="right">+arbidolMean</th>
<th align="right">+FDRandArbidol</th>
<th align="right">+FDRorArbidol</th>
<th align="right">+FDRonly</th>
<th align="right">+ArbidolOnly</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">01F08</td>
<td align="left">Benoxinate hydrochloride</td>
<td align="left">Local anesthetic</td>
<td align="right">1.1929</td>
<td align="right">0.9559</td>
<td align="right">96.5134</td>
<td align="right">8.4789</td>
<td align="right">13.7518</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">01B12</td>
<td align="left">Arbidol</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">0.8805</td>
<td align="right">90.1638</td>
<td align="right">7.9057</td>
<td align="right">11.9839</td>
<td align="right">1</td>
<td align="right">NA</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">01A12</td>
<td align="left">Arbidol</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">0.8103</td>
<td align="right">83.7370</td>
<td align="right">7.3255</td>
<td align="right">10.2091</td>
<td align="right">1</td>
<td align="right">NA</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">01H07</td>
<td align="left">Dibucaine</td>
<td align="left">Local anesthetic</td>
<td align="right">0.9095</td>
<td align="right">0.7935</td>
<td align="right">82.1224</td>
<td align="right">7.1798</td>
<td align="right">9.8665</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">01A06</td>
<td align="left">Atracurium besylate</td>
<td align="left">Curarizing</td>
<td align="right">0.8693</td>
<td align="right">0.7705</td>
<td align="right">79.8475</td>
<td align="right">6.9744</td>
<td align="right">9.3559</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">09F04</td>
<td align="left">Promazine hydrochloride</td>
<td align="left">Antipsychotic</td>
<td align="right">1.1610</td>
<td align="right">0.9300</td>
<td align="right">94.0954</td>
<td align="right">6.9603</td>
<td align="right">9.3559</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">09B12</td>
<td align="left">Arbidol</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">0.8879</td>
<td align="right">90.3256</td>
<td align="right">6.6561</td>
<td align="right">8.5044</td>
<td align="right">1</td>
<td align="right">NA</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">09D04</td>
<td align="left">Opipramol dihydrochloride</td>
<td align="left">Antidepressant ’Antipsychotic</td>
<td align="right">1.0521</td>
<td align="right">0.8708</td>
<td align="right">88.7401</td>
<td align="right">6.5281</td>
<td align="right">8.1880</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">01D05</td>
<td align="left">Triamterene</td>
<td align="left">Antihypertensive ’Diuretic</td>
<td align="right">0.7586</td>
<td align="right">0.7071</td>
<td align="right">73.2080</td>
<td align="right">6.3750</td>
<td align="right">7.8004</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">01D08</td>
<td align="left">Pyrimethamine</td>
<td align="left">Antimalarial ’Antiprotozoal ’Antineoplastic</td>
<td align="right">0.7421</td>
<td align="right">0.6977</td>
<td align="right">72.1695</td>
<td align="right">6.2813</td>
<td align="right">7.5824</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">01H05</td>
<td align="left">Amitryptiline hydrochloride</td>
<td align="left">Antidepressant</td>
<td align="right">0.7185</td>
<td align="right">0.6841</td>
<td align="right">70.6535</td>
<td align="right">6.1444</td>
<td align="right">7.2454</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">03B12</td>
<td align="left">Arbidol</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">0.7557</td>
<td align="right">79.0963</td>
<td align="right">5.9669</td>
<td align="right">6.8041</td>
<td align="right">1</td>
<td align="right">NA</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">09A12</td>
<td align="left">Arbidol</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">0.7970</td>
<td align="right">81.5300</td>
<td align="right">5.9461</td>
<td align="right">6.7837</td>
<td align="right">1</td>
<td align="right">NA</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">01H03</td>
<td align="left">Imipramine hydrochloride</td>
<td align="left">Antidepressant</td>
<td align="right">0.6546</td>
<td align="right">0.6475</td>
<td align="right">66.4013</td>
<td align="right">5.7606</td>
<td align="right">6.3312</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">09G07</td>
<td align="left">Chlorcyclizine hydrochloride</td>
<td align="left">Antiemetic ’Antihistaminic ’Sedative</td>
<td align="right">0.8573</td>
<td align="right">0.7648</td>
<td align="right">78.1773</td>
<td align="right">5.6755</td>
<td align="right">6.1438</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">03G08</td>
<td align="left">Clemizole hydrochloride</td>
<td align="left">Antibacterial ’Antifungal ’Antihistaminic ’Antipruritic</td>
<td align="right">1.0073</td>
<td align="right">0.7205</td>
<td align="right">75.5343</td>
<td align="right">5.6529</td>
<td align="right">6.1147</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">03H10</td>
<td align="left">Orphenadrine hydrochloride</td>
<td align="left">Antihistaminic ’Antiparkinsonian</td>
<td align="right">0.9732</td>
<td align="right">0.7051</td>
<td align="right">73.9193</td>
<td align="right">5.5106</td>
<td align="right">5.7855</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">09G08</td>
<td align="left">Diphenylpyraline hydrochloride</td>
<td align="left">Antihistaminic ’Antipruritic ’Sedative</td>
<td align="right">0.8198</td>
<td align="right">0.7444</td>
<td align="right">75.9759</td>
<td align="right">5.4978</td>
<td align="right">5.7788</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">01G11</td>
<td align="left">Tolnaftate</td>
<td align="left">Antifungal ’Antifungal</td>
<td align="right">0.5943</td>
<td align="right">0.6129</td>
<td align="right">62.1630</td>
<td align="right">5.3780</td>
<td align="right">5.5102</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">03A12</td>
<td align="left">Arbidol</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">0.6787</td>
<td align="right">71.0715</td>
<td align="right">5.2596</td>
<td align="right">5.2500</td>
<td align="right">1</td>
<td align="right">NA</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">07G07</td>
<td align="left">Pregnenolone</td>
<td align="left">Anabolic ’Anti-inflammatory</td>
<td align="right">1.6589</td>
<td align="right">1.0977</td>
<td align="right">107.1158</td>
<td align="right">5.1506</td>
<td align="right">5.0163</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">01H04</td>
<td align="left">Sulindac</td>
<td align="left">Analgesic ’Anti-inflammatory ’Antipyretic</td>
<td align="right">0.5382</td>
<td align="right">0.5808</td>
<td align="right">58.0051</td>
<td align="right">5.0026</td>
<td align="right">4.6984</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">08E11</td>
<td align="left">Hydroxychloroquine sulfate</td>
<td align="left">Antimalarial</td>
<td align="right">1.4327</td>
<td align="right">1.1373</td>
<td align="right">110.4885</td>
<td align="right">4.8080</td>
<td align="right">4.2870</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">01C05</td>
<td align="left">Norethynodrel</td>
<td align="left">Contraceptive</td>
<td align="right">0.5082</td>
<td align="right">0.5636</td>
<td align="right">55.6771</td>
<td align="right">4.7925</td>
<td align="right">4.2718</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">10G08</td>
<td align="left">Merbromin disodium salt</td>
<td align="left">Antibacterial ’Antineoplastic</td>
<td align="right">1.1210</td>
<td align="right">0.9274</td>
<td align="right">94.0301</td>
<td align="right">4.6730</td>
<td align="right">4.0339</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">03B05</td>
<td align="left">Alverine citrate salt</td>
<td align="left">Antispastic</td>
<td align="right">0.7629</td>
<td align="right">0.6101</td>
<td align="right">63.1168</td>
<td align="right">4.5585</td>
<td align="right">3.8115</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">07G09</td>
<td align="left">Chloroquine diphosphate</td>
<td align="left">Anti-inflammatory ’Antimalarial ’Antiprotozoal</td>
<td align="right">1.3510</td>
<td align="right">0.9436</td>
<td align="right">95.5713</td>
<td align="right">4.5295</td>
<td align="right">3.7681</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">01E08</td>
<td align="left">Ticlopidine hydrochloride</td>
<td align="left">Anticoagulant ’Antiplatelet</td>
<td align="right">0.4552</td>
<td align="right">0.5333</td>
<td align="right">51.4019</td>
<td align="right">4.4065</td>
<td align="right">3.5342</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">10A12</td>
<td align="left">Arbidol</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">0.8743</td>
<td align="right">89.3544</td>
<td align="right">4.3967</td>
<td align="right">3.5299</td>
<td align="right">1</td>
<td align="right">NA</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">09G09</td>
<td align="left">Benzethonium chloride</td>
<td align="left">Antibacterial ’Antiseptic ’Antineoplastic</td>
<td align="right">0.6042</td>
<td align="right">0.6272</td>
<td align="right">62.0279</td>
<td align="right">4.3720</td>
<td align="right">3.4952</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">07B04</td>
<td align="left">Omeprazole</td>
<td align="left">Antiulcer</td>
<td align="right">1.2487</td>
<td align="right">0.8924</td>
<td align="right">91.3149</td>
<td align="right">4.3005</td>
<td align="right">3.3683</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">01G06</td>
<td align="left">Diphenhydramine hydrochloride</td>
<td align="left">Antiemetic ’Antihistaminic ’Antitussive ’Sedative</td>
<td align="right">0.4338</td>
<td align="right">0.5210</td>
<td align="right">49.6043</td>
<td align="right">4.2442</td>
<td align="right">3.2725</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">10B12</td>
<td align="left">Arbidol</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">0.8415</td>
<td align="right">86.3252</td>
<td align="right">4.2178</td>
<td align="right">3.2347</td>
<td align="right">1</td>
<td align="right">NA</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">08D06</td>
<td align="left">Exemestane</td>
<td align="left">Antineoplastic</td>
<td align="right">1.0965</td>
<td align="right">0.9392</td>
<td align="right">94.8887</td>
<td align="right">4.0950</td>
<td align="right">3.0145</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">10D08</td>
<td align="left">Chlorotrianisene</td>
<td align="left">Antineoplastic</td>
<td align="right">0.9163</td>
<td align="right">0.8098</td>
<td align="right">83.2823</td>
<td align="right">4.0380</td>
<td align="right">2.9208</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">09D02</td>
<td align="left">Dydrogesterone</td>
<td align="left">Progestogen</td>
<td align="right">0.5447</td>
<td align="right">0.5947</td>
<td align="right">57.7090</td>
<td align="right">4.0233</td>
<td align="right">2.9060</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">08B12</td>
<td align="left">Arbidol</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">0.8998</td>
<td align="right">91.4001</td>
<td align="right">3.9356</td>
<td align="right">2.7577</td>
<td align="right">1</td>
<td align="right">NA</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">08H03</td>
<td align="left">Dipivefrin hydrochloride</td>
<td align="left">Antiglaucoma</td>
<td align="right">1.0095</td>
<td align="right">0.8879</td>
<td align="right">90.3132</td>
<td align="right">3.8859</td>
<td align="right">2.6799</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">07A12</td>
<td align="left">Arbidol</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">0.7995</td>
<td align="right">82.9210</td>
<td align="right">3.8489</td>
<td align="right">2.6252</td>
<td align="right">1</td>
<td align="right">NA</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">08A12</td>
<td align="left">Arbidol</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">0.8647</td>
<td align="right">88.1590</td>
<td align="right">3.7875</td>
<td align="right">2.5282</td>
<td align="right">1</td>
<td align="right">NA</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">07H07</td>
<td align="left">Mirtazapine</td>
<td align="left">Antidepressant</td>
<td align="right">1.0320</td>
<td align="right">0.7840</td>
<td align="right">81.4249</td>
<td align="right">3.7684</td>
<td align="right">2.5056</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">10H10</td>
<td align="left">Pridinol methanesulfonate salt</td>
<td align="left">Antiparkinsonian</td>
<td align="right">0.8315</td>
<td align="right">0.7612</td>
<td align="right">78.3641</td>
<td align="right">3.7474</td>
<td align="right">2.4796</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">03F02</td>
<td align="left">Piroxicam</td>
<td align="left">Analgesic ’Anticoagulant ’Anti-inflammatory ’Antiplatelet ’Antipyretic ’Uricosuric</td>
<td align="right">0.5726</td>
<td align="right">0.5241</td>
<td align="right">51.7713</td>
<td align="right">3.5586</td>
<td align="right">2.1704</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">09G04</td>
<td align="left">Famprofazone</td>
<td align="left">Analgesic ’Antipyretic</td>
<td align="right">0.4661</td>
<td align="right">0.5520</td>
<td align="right">51.6373</td>
<td align="right">3.5333</td>
<td align="right">2.1386</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">07B03</td>
<td align="left">Nitrofural</td>
<td align="left">Antibacterial ’Antidotes</td>
<td align="right">0.9359</td>
<td align="right">0.7359</td>
<td align="right">76.5940</td>
<td align="right">3.5085</td>
<td align="right">2.1173</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">07B12</td>
<td align="left">Arbidol</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">0.7365</td>
<td align="right">76.6493</td>
<td align="right">3.5114</td>
<td align="right">2.1173</td>
<td align="right">1</td>
<td align="right">NA</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">07F02</td>
<td align="left">Pirenperone</td>
<td align="left">Anxiolytic</td>
<td align="right">0.9157</td>
<td align="right">0.7258</td>
<td align="right">75.5356</td>
<td align="right">3.4515</td>
<td align="right">2.0344</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">02A12</td>
<td align="left">Arbidol</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">0.8278</td>
<td align="right">85.5793</td>
<td align="right">3.4365</td>
<td align="right">2.0193</td>
<td align="right">1</td>
<td align="right">NA</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">07H10</td>
<td align="left">Tazarotene</td>
<td align="left">Antipsoriatic ’Antiacneic</td>
<td align="right">0.9001</td>
<td align="right">0.7180</td>
<td align="right">74.7110</td>
<td align="right">3.4072</td>
<td align="right">1.9815</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">07C10</td>
<td align="left">Bromperidol</td>
<td align="left">Antipsychotic</td>
<td align="right">0.8959</td>
<td align="right">0.7159</td>
<td align="right">74.4893</td>
<td align="right">3.3952</td>
<td align="right">1.9715</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">09F10</td>
<td align="left">Hexestrol</td>
<td align="left">Antineoplastic</td>
<td align="right">0.4442</td>
<td align="right">0.5401</td>
<td align="right">49.8616</td>
<td align="right">3.3899</td>
<td align="right">1.9715</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">08H02</td>
<td align="left">Alendronate sodium</td>
<td align="left">Antiosteoporetic</td>
<td align="right">0.8169</td>
<td align="right">0.7743</td>
<td align="right">79.1607</td>
<td align="right">3.3763</td>
<td align="right">1.9583</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">06D11</td>
<td align="left">Epiandrosterone</td>
<td align="left">Anabolic</td>
<td align="right">1.0748</td>
<td align="right">0.9215</td>
<td align="right">93.9594</td>
<td align="right">3.3589</td>
<td align="right">1.9393</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">09A09</td>
<td align="left">Nilvadipine</td>
<td align="left">Antianginal ’Antihypertensive</td>
<td align="right">0.4331</td>
<td align="right">0.5341</td>
<td align="right">48.9538</td>
<td align="right">3.3167</td>
<td align="right">1.8813</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">05A10</td>
<td align="left">Tacrine hydrochloride</td>
<td align="left">CNS Stimulant</td>
<td align="right">1.4422</td>
<td align="right">0.9408</td>
<td align="right">95.7878</td>
<td align="right">3.2975</td>
<td align="right">1.8595</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">06B12</td>
<td align="left">Arbidol</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">0.8991</td>
<td align="right">92.1439</td>
<td align="right">3.2880</td>
<td align="right">1.8527</td>
<td align="right">1</td>
<td align="right">NA</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">07C03</td>
<td align="left">Biperiden hydrochloride</td>
<td align="left">Antiparkinsonian ’Antineoplastic</td>
<td align="right">0.8495</td>
<td align="right">0.6927</td>
<td align="right">71.9731</td>
<td align="right">3.2599</td>
<td align="right">1.8172</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">09G02</td>
<td align="left">Trihexyphenidyl-D,L hydrochloride</td>
<td align="left">Antiparkinsonian</td>
<td align="right">0.4224</td>
<td align="right">0.5282</td>
<td align="right">48.0568</td>
<td align="right">3.2443</td>
<td align="right">1.8009</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">06H02</td>
<td align="left">Vatalanib</td>
<td align="left">Antineoplastic</td>
<td align="right">0.9984</td>
<td align="right">0.8745</td>
<td align="right">90.0896</td>
<td align="right">3.2077</td>
<td align="right">1.7578</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">10A08</td>
<td align="left">Liranaftate</td>
<td align="left">Antifungal</td>
<td align="right">0.6869</td>
<td align="right">0.6782</td>
<td align="right">69.2049</td>
<td align="right">3.2062</td>
<td align="right">1.7578</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">02B12</td>
<td align="left">Arbidol</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">0.7756</td>
<td align="right">80.6102</td>
<td align="right">3.1908</td>
<td align="right">1.7451</td>
<td align="right">1</td>
<td align="right">NA</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">02C08</td>
<td align="left">Pioglitazone</td>
<td align="left">NA</td>
<td align="right">0.9499</td>
<td align="right">0.7751</td>
<td align="right">80.5590</td>
<td align="right">3.1883</td>
<td align="right">1.7451</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">06A12</td>
<td align="left">Arbidol</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">0.8518</td>
<td align="right">88.1505</td>
<td align="right">3.1319</td>
<td align="right">1.6681</td>
<td align="right">1</td>
<td align="right">NA</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">10E06</td>
<td align="left">Ethoxyquin</td>
<td align="left">Antifungal ’Antineoplastic</td>
<td align="right">0.6516</td>
<td align="right">0.6579</td>
<td align="right">66.7968</td>
<td align="right">3.0639</td>
<td align="right">1.5752</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">07H06</td>
<td align="left">Nifuroxazide</td>
<td align="left">Antibacterial ’Antineoplastic</td>
<td align="right">0.7750</td>
<td align="right">0.6554</td>
<td align="right">67.7468</td>
<td align="right">3.0325</td>
<td align="right">1.5365</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">03E06</td>
<td align="left">Tolfenamic acid</td>
<td align="left">Analgesic ’Anti-inflammatory</td>
<td align="right">0.4812</td>
<td align="right">0.4828</td>
<td align="right">45.6459</td>
<td align="right">3.0187</td>
<td align="right">1.5234</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">02B04</td>
<td align="left">Azacyclonol</td>
<td align="left">Antipsychotic</td>
<td align="right">0.8837</td>
<td align="right">0.7400</td>
<td align="right">77.0208</td>
<td align="right">3.0134</td>
<td align="right">1.5223</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">08G02</td>
<td align="left">Mizolastine</td>
<td align="left">Antihistaminic</td>
<td align="right">0.6881</td>
<td align="right">0.6984</td>
<td align="right">70.7524</td>
<td align="right">2.9920</td>
<td align="right">1.4982</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">08E07</td>
<td align="left">Rimantadine hydrochloride</td>
<td align="left">Antiviral</td>
<td align="right">0.6754</td>
<td align="right">0.6909</td>
<td align="right">69.8764</td>
<td align="right">2.9520</td>
<td align="right">1.4479</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">08B06</td>
<td align="left">Tenatoprazole</td>
<td align="left">Antiulcer</td>
<td align="right">0.6656</td>
<td align="right">0.6851</td>
<td align="right">69.1905</td>
<td align="right">2.9206</td>
<td align="right">1.4103</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">07D09</td>
<td align="left">Budesonide</td>
<td align="left">Anti-inflammatory ’Antineoplastic</td>
<td align="right">0.7260</td>
<td align="right">0.6309</td>
<td align="right">64.8405</td>
<td align="right">2.8761</td>
<td align="right">1.3548</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">06F06</td>
<td align="left">Mebhydroline 1,5-naphtalenedisulfonate</td>
<td align="left">Antihistaminic</td>
<td align="right">0.8344</td>
<td align="right">0.7736</td>
<td align="right">81.0329</td>
<td align="right">2.8538</td>
<td align="right">1.3303</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<div id="venn-diagram" class="section level3">
<h3>Venn diagram</h3>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" data-line-number="1"><span class="co">#### Draw a Venn diagram of the selected molecules ####</span></a>
<a class="sourceLine" id="cb46-2" data-line-number="2"></a>
<a class="sourceLine" id="cb46-3" data-line-number="3"><span class="co">## Venn diagram</span></a>
<a class="sourceLine" id="cb46-4" data-line-number="4">vennTable &lt;-<span class="st"> </span><span class="kw">na.omit</span>(inhibTable[, <span class="kw">c</span>(<span class="st">&quot;selected.FDR&quot;</span>, <span class="st">&quot;selected.arbidolMean&quot;</span>)])</a>
<a class="sourceLine" id="cb46-5" data-line-number="5"><span class="kw">vennDiagram</span>(<span class="dt">object =</span> vennTable, </a>
<a class="sourceLine" id="cb46-6" data-line-number="6">            <span class="dt">names =</span> <span class="kw">c</span>(<span class="kw">paste</span>(<span class="st">&quot;FDR &lt;&quot;</span>, alpha), </a>
<a class="sourceLine" id="cb46-7" data-line-number="7">                      <span class="kw">paste</span>(<span class="st">&quot;I &gt;=&quot;</span>, <span class="dv">1</span>)), </a>
<a class="sourceLine" id="cb46-8" data-line-number="8">            <span class="dt">circle.col =</span> <span class="kw">c</span>(<span class="st">&quot;#00BB00&quot;</span>, <span class="st">&quot;blue&quot;</span>), <span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb46-9" data-line-number="9">            )</a></code></pre></div>
<div class="figure" style="text-align: center">
<img src="figures/touret_sars-cov-2_inhibitorsVenn_candidate_molecules-1.png" alt="Venn diagram of the molecules selected by different criteria. " width="60%" />
<p class="caption">
Venn diagram of the molecules selected by different criteria.
</p>
</div>
</div>
<div id="hits-per-plate" class="section level3">
<h3>Hits per plate</h3>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" data-line-number="1"><span class="co">#### Compute the number of candidates per plate depending on the criterion ####</span></a>
<a class="sourceLine" id="cb47-2" data-line-number="2"></a>
<a class="sourceLine" id="cb47-3" data-line-number="3"><span class="co">## Count the number of candidates per plate for the different criteria</span></a>
<a class="sourceLine" id="cb47-4" data-line-number="4">criteria &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;ii&quot;</span>, <span class="st">&quot;arbidolMean&quot;</span>, <span class="st">&quot;FDR&quot;</span>, <span class="st">&quot;FDRandArbidol&quot;</span>, <span class="st">&quot;FDRorArbidol&quot;</span>, <span class="st">&quot;FDRonly&quot;</span>, <span class="st">&quot;ArbidolOnly&quot;</span>)</a>
<a class="sourceLine" id="cb47-5" data-line-number="5"></a>
<a class="sourceLine" id="cb47-6" data-line-number="6"><span class="co"># table(inhibTable$selected.ii, inhibTable$selected.arbidolMean)</span></a>
<a class="sourceLine" id="cb47-7" data-line-number="7"></a>
<a class="sourceLine" id="cb47-8" data-line-number="8">candidatesPerPlate &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">matrix</span>(</a>
<a class="sourceLine" id="cb47-9" data-line-number="9">  <span class="dt">nrow =</span> nbPlates, </a>
<a class="sourceLine" id="cb47-10" data-line-number="10">  <span class="dt">ncol =</span> <span class="kw">length</span>(criteria), <span class="dv">0</span>))</a>
<a class="sourceLine" id="cb47-11" data-line-number="11"><span class="kw">row.names</span>(candidatesPerPlate) &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span>nbPlates</a>
<a class="sourceLine" id="cb47-12" data-line-number="12"><span class="kw">names</span>(candidatesPerPlate) &lt;-<span class="st"> </span>criteria</a>
<a class="sourceLine" id="cb47-13" data-line-number="13"><span class="cf">for</span> (criterion <span class="cf">in</span> criteria) {</a>
<a class="sourceLine" id="cb47-14" data-line-number="14">  candidates &lt;-<span class="st"> </span><span class="kw">as.data.frame.table</span>(</a>
<a class="sourceLine" id="cb47-15" data-line-number="15">    <span class="kw">table</span>(</a>
<a class="sourceLine" id="cb47-16" data-line-number="16">    <span class="kw">subset</span>(<span class="dt">x =</span> inhibTable, </a>
<a class="sourceLine" id="cb47-17" data-line-number="17">           <span class="dt">subset =</span> inhibTable[<span class="kw">paste0</span>(<span class="st">&quot;selected.&quot;</span>, criterion)] <span class="op">==</span><span class="st"> </span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb47-18" data-line-number="18">           <span class="dt">select =</span> <span class="st">&quot;Plate&quot;</span>)))</a>
<a class="sourceLine" id="cb47-19" data-line-number="19">  <span class="kw">names</span>(candidates) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Plate&quot;</span>, <span class="st">&quot;n&quot;</span>)</a>
<a class="sourceLine" id="cb47-20" data-line-number="20">  candidatesPerPlate[<span class="kw">as.vector</span>(candidates<span class="op">$</span>Plate), criterion] &lt;-<span class="st"> </span>candidates<span class="op">$</span>n</a>
<a class="sourceLine" id="cb47-21" data-line-number="21">}</a>
<a class="sourceLine" id="cb47-22" data-line-number="22"><span class="co"># apply(candidatesPerPlate, 2, sum)</span></a>
<a class="sourceLine" id="cb47-23" data-line-number="23"></a>
<a class="sourceLine" id="cb47-24" data-line-number="24">ccpp &lt;-<span class="st"> </span>candidatesPerPlate</a>
<a class="sourceLine" id="cb47-25" data-line-number="25">ccpp[<span class="st">&quot;Total&quot;</span>, ] &lt;-<span class="st"> </span><span class="kw">apply</span>(ccpp, <span class="dv">2</span>, sum)</a>
<a class="sourceLine" id="cb47-26" data-line-number="26"><span class="kw">kable</span>(ccpp, <span class="dt">row.names =</span> <span class="ot">TRUE</span>, <span class="dt">ccaption =</span> <span class="st">&quot;Candidates per plate depending on the selection criteria&quot;</span>)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">ii</th>
<th align="right">arbidolMean</th>
<th align="right">FDR</th>
<th align="right">FDRandArbidol</th>
<th align="right">FDRorArbidol</th>
<th align="right">FDRonly</th>
<th align="right">ArbidolOnly</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">14</td>
<td align="right">2</td>
<td align="right">14</td>
<td align="right">12</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td>2</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">3</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td>3</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">7</td>
<td align="right">2</td>
<td align="right">7</td>
<td align="right">5</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td>4</td>
<td align="right">7</td>
<td align="right">9</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">9</td>
<td align="right">0</td>
<td align="right">9</td>
</tr>
<tr class="odd">
<td>5</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">0</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td>6</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">5</td>
<td align="right">2</td>
<td align="right">5</td>
<td align="right">3</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td>7</td>
<td align="right">4</td>
<td align="right">5</td>
<td align="right">13</td>
<td align="right">5</td>
<td align="right">13</td>
<td align="right">8</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td>8</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="right">9</td>
<td align="right">4</td>
<td align="right">9</td>
<td align="right">5</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td>9</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">12</td>
<td align="right">3</td>
<td align="right">12</td>
<td align="right">9</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td>10</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">7</td>
<td align="right">2</td>
<td align="right">7</td>
<td align="right">5</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td>11</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">4</td>
<td align="right">0</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td>12</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td>13</td>
<td align="right">9</td>
<td align="right">10</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">10</td>
<td align="right">0</td>
<td align="right">10</td>
</tr>
<tr class="even">
<td>14</td>
<td align="right">14</td>
<td align="right">15</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">15</td>
<td align="right">0</td>
<td align="right">15</td>
</tr>
<tr class="odd">
<td>15</td>
<td align="right">16</td>
<td align="right">17</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">17</td>
<td align="right">0</td>
<td align="right">17</td>
</tr>
<tr class="even">
<td>16</td>
<td align="right">9</td>
<td align="right">11</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">11</td>
<td align="right">0</td>
<td align="right">11</td>
</tr>
<tr class="odd">
<td>17</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">4</td>
<td align="right">0</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td>18</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">4</td>
<td align="right">0</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td>19</td>
<td align="right">8</td>
<td align="right">9</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">9</td>
<td align="right">0</td>
<td align="right">9</td>
</tr>
<tr class="even">
<td>Total</td>
<td align="right">90</td>
<td align="right">111</td>
<td align="right">72</td>
<td align="right">22</td>
<td align="right">161</td>
<td align="right">50</td>
<td align="right">89</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" data-line-number="1"><span class="co">#### Compare number of candidates per plate according to the criteria ####</span></a>
<a class="sourceLine" id="cb48-2" data-line-number="2"><span class="kw">names</span>(candidatesPerPlate)</a></code></pre></div>
<pre><code>[1] &quot;ii&quot;            &quot;arbidolMean&quot;   &quot;FDR&quot;           &quot;FDRandArbidol&quot; &quot;FDRorArbidol&quot;  &quot;FDRonly&quot;       &quot;ArbidolOnly&quot;  </code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" data-line-number="1">maxc &lt;-<span class="st">  </span><span class="kw">max</span>(candidatesPerPlate)</a>
<a class="sourceLine" id="cb50-2" data-line-number="2"><span class="kw">plot</span>(candidatesPerPlate[, <span class="kw">c</span>(<span class="st">&quot;FDR&quot;</span>, <span class="st">&quot;arbidolMean&quot;</span>)],</a>
<a class="sourceLine" id="cb50-3" data-line-number="3">     <span class="dt">main =</span> <span class="st">&quot;Candidates per plate&quot;</span>,</a>
<a class="sourceLine" id="cb50-4" data-line-number="4">     <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>,</a>
<a class="sourceLine" id="cb50-5" data-line-number="5">     <span class="dt">xlab =</span> <span class="kw">paste</span>(<span class="st">&quot;FDR &lt; &quot;</span>, alpha),</a>
<a class="sourceLine" id="cb50-6" data-line-number="6">     <span class="dt">ylab =</span> <span class="kw">paste</span>(<span class="st">&quot;Relative viability arbidol mean&quot;</span>),</a>
<a class="sourceLine" id="cb50-7" data-line-number="7">     <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, maxc <span class="op">*</span><span class="st"> </span><span class="fl">1.1</span>),</a>
<a class="sourceLine" id="cb50-8" data-line-number="8">     <span class="dt">las =</span> <span class="dv">1</span>, <span class="dt">pch =</span> <span class="dv">20</span>,</a>
<a class="sourceLine" id="cb50-9" data-line-number="9">     <span class="dt">panel.first =</span> </a>
<a class="sourceLine" id="cb50-10" data-line-number="10">       <span class="kw">c</span>(<span class="kw">abline</span>(<span class="dt">h =</span> <span class="kw">seq</span>(<span class="dv">0</span>, maxc, <span class="dt">by =</span> <span class="dv">1</span>), <span class="dt">col =</span> <span class="st">&quot;#DDDDDD&quot;</span>),</a>
<a class="sourceLine" id="cb50-11" data-line-number="11">         <span class="kw">abline</span>(<span class="dt">h =</span> <span class="kw">seq</span>(<span class="dv">0</span>, maxc, <span class="dt">by =</span> <span class="dv">5</span>), <span class="dt">col =</span> <span class="st">&quot;#BBBBBB&quot;</span>),</a>
<a class="sourceLine" id="cb50-12" data-line-number="12">         <span class="kw">abline</span>(<span class="dt">v =</span> <span class="kw">seq</span>(<span class="dv">0</span>, maxc, <span class="dt">by =</span> <span class="dv">1</span>), <span class="dt">col =</span> <span class="st">&quot;#EEEEEE&quot;</span>),</a>
<a class="sourceLine" id="cb50-13" data-line-number="13">         <span class="kw">abline</span>(<span class="dt">v =</span> <span class="kw">seq</span>(<span class="dv">0</span>, maxc, <span class="dt">by =</span> <span class="dv">5</span>), <span class="dt">col =</span> <span class="st">&quot;#BBBBBB&quot;</span>)),</a>
<a class="sourceLine" id="cb50-14" data-line-number="14">     <span class="dt">col =</span> plateColor[<span class="kw">rownames</span>(candidatesPerPlate)])</a>
<a class="sourceLine" id="cb50-15" data-line-number="15"><span class="kw">text</span>(candidatesPerPlate[, <span class="kw">c</span>(<span class="st">&quot;FDR&quot;</span>, <span class="st">&quot;arbidolMean&quot;</span>)], <span class="kw">rownames</span>(candidatesPerPlate), <span class="dt">col =</span> plateColor)</a>
<a class="sourceLine" id="cb50-16" data-line-number="16"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">legend =</span> <span class="kw">names</span>(plateColor), </a>
<a class="sourceLine" id="cb50-17" data-line-number="17">       <span class="dt">title =</span> <span class="st">&quot;Plate&quot;</span>, <span class="dt">col =</span> plateColor, <span class="dt">pch =</span> <span class="dv">20</span>, <span class="dt">cex =</span> <span class="fl">0.8</span>)</a></code></pre></div>
<div class="figure" style="text-align: center">
<img src="figures/touret_sars-cov-2_inhibitorscandidates_per_plate_plot-1.png" alt="Number of candidate molecules per plate depending on the method. " width="60%" />
<p class="caption">
Number of candidate molecules per plate depending on the method.
</p>
</div>
<hr />
</div>
</div>
<div id="result-files" class="section level1">
<h1>Result files</h1>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" data-line-number="1"><span class="co">#### Export result tables ####</span></a>
<a class="sourceLine" id="cb51-2" data-line-number="2"></a>
<a class="sourceLine" id="cb51-3" data-line-number="3"><span class="co">## Define output file names</span></a>
<a class="sourceLine" id="cb51-4" data-line-number="4">outFiles &lt;-<span class="st"> </span><span class="kw">list</span>(</a>
<a class="sourceLine" id="cb51-5" data-line-number="5">  <span class="st">&quot;All results (tsv)&quot;</span> =<span class="st">  </span></a>
<a class="sourceLine" id="cb51-6" data-line-number="6"><span class="st">    </span><span class="kw">file.path</span>(dir[<span class="st">&quot;results&quot;</span>], <span class="st">&quot;result_table_all-molecules.tsv&quot;</span>),</a>
<a class="sourceLine" id="cb51-7" data-line-number="7">  <span class="st">&quot;All results (xlsx)&quot;</span> =<span class="st">  </span></a>
<a class="sourceLine" id="cb51-8" data-line-number="8"><span class="st">    </span><span class="kw">file.path</span>(dir[<span class="st">&quot;results&quot;</span>], <span class="st">&quot;result_table_all-molecules.xlsx&quot;</span>),</a>
<a class="sourceLine" id="cb51-9" data-line-number="9">  <span class="st">&quot;FDR-based hits (xlsx)&quot;</span> =<span class="st">  </span></a>
<a class="sourceLine" id="cb51-10" data-line-number="10"><span class="st">    </span><span class="kw">file.path</span>(dir[<span class="st">&quot;results&quot;</span>], <span class="st">&quot;result_table_FDR-hits.xlsx&quot;</span>),</a>
<a class="sourceLine" id="cb51-11" data-line-number="11">  <span class="st">&quot;Arbidol-based hits (xlsx)&quot;</span> =<span class="st">  </span></a>
<a class="sourceLine" id="cb51-12" data-line-number="12"><span class="st">    </span><span class="kw">file.path</span>(dir[<span class="st">&quot;results&quot;</span>], <span class="st">&quot;result_table_arbidol-hits.xlsx&quot;</span>),</a>
<a class="sourceLine" id="cb51-13" data-line-number="13">  <span class="st">&quot;High confidence hits (xlsx)&quot;</span> =<span class="st">  </span></a>
<a class="sourceLine" id="cb51-14" data-line-number="14"><span class="st">    </span><span class="kw">file.path</span>(dir[<span class="st">&quot;results&quot;</span>], <span class="st">&quot;result_table_HiConfidence-hits.xlsx&quot;</span>)</a>
<a class="sourceLine" id="cb51-15" data-line-number="15">)</a>
<a class="sourceLine" id="cb51-16" data-line-number="16"></a>
<a class="sourceLine" id="cb51-17" data-line-number="17"></a>
<a class="sourceLine" id="cb51-18" data-line-number="18"><span class="kw">write.table</span>(<span class="dt">x =</span> inhibTable, </a>
<a class="sourceLine" id="cb51-19" data-line-number="19">            <span class="dt">file =</span> outFiles<span class="op">$</span><span class="st">`</span><span class="dt">All results (tsv)</span><span class="st">`</span>,  </a>
<a class="sourceLine" id="cb51-20" data-line-number="20">            <span class="dt">sep =</span> <span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>, <span class="dt">quote =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb51-21" data-line-number="21">            <span class="dt">row.names =</span> <span class="ot">FALSE</span>, <span class="dt">col.names =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb51-22" data-line-number="22"></a>
<a class="sourceLine" id="cb51-23" data-line-number="23"><span class="kw">write.xlsx2</span>(<span class="dt">x =</span> inhibTable, </a>
<a class="sourceLine" id="cb51-24" data-line-number="24">            <span class="dt">file =</span> outFiles<span class="op">$</span><span class="st">`</span><span class="dt">All results (xlsx)</span><span class="st">`</span>, </a>
<a class="sourceLine" id="cb51-25" data-line-number="25">            <span class="dt">row.names =</span> <span class="ot">FALSE</span>, <span class="dt">col.names =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb51-26" data-line-number="26"></a>
<a class="sourceLine" id="cb51-27" data-line-number="27"><span class="kw">write.xlsx2</span>(<span class="dt">x =</span> inhibTable[inhibTable<span class="op">$</span>selected.FDR, ], </a>
<a class="sourceLine" id="cb51-28" data-line-number="28">            <span class="dt">file =</span> outFiles<span class="op">$</span><span class="st">`</span><span class="dt">FDR-based hits (xlsx)</span><span class="st">`</span>, </a>
<a class="sourceLine" id="cb51-29" data-line-number="29">            <span class="dt">row.names =</span> <span class="ot">FALSE</span>, <span class="dt">col.names =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb51-30" data-line-number="30"></a>
<a class="sourceLine" id="cb51-31" data-line-number="31"><span class="kw">write.xlsx2</span>(<span class="dt">x =</span> inhibTable[inhibTable<span class="op">$</span>selected.arbidolMean, ], </a>
<a class="sourceLine" id="cb51-32" data-line-number="32">            <span class="dt">file =</span> outFiles<span class="op">$</span><span class="st">`</span><span class="dt">Arbidol-based hits (xlsx)</span><span class="st">`</span>, </a>
<a class="sourceLine" id="cb51-33" data-line-number="33">            <span class="dt">row.names =</span> <span class="ot">FALSE</span>, <span class="dt">col.names =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb51-34" data-line-number="34"></a>
<a class="sourceLine" id="cb51-35" data-line-number="35"><span class="kw">write.xlsx2</span>(<span class="dt">x =</span> inhibTable[inhibTable<span class="op">$</span>selected.FDRandArbidol, ], </a>
<a class="sourceLine" id="cb51-36" data-line-number="36">            <span class="dt">file =</span> outFiles<span class="op">$</span><span class="st">`</span><span class="dt">High confidence hits (xlsx)</span><span class="st">`</span>, </a>
<a class="sourceLine" id="cb51-37" data-line-number="37">            <span class="dt">row.names =</span> <span class="ot">FALSE</span>, <span class="dt">col.names =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb51-38" data-line-number="38"></a>
<a class="sourceLine" id="cb51-39" data-line-number="39"><span class="co"># system(paste(&quot;open&quot;, dir[&quot;results&quot;]))</span></a>
<a class="sourceLine" id="cb51-40" data-line-number="40"></a>
<a class="sourceLine" id="cb51-41" data-line-number="41"><span class="co">## Prepare a data frame with the relative links to output files</span></a>
<a class="sourceLine" id="cb51-42" data-line-number="42">fileLinks &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb51-43" data-line-number="43">  <span class="dt">name =</span> <span class="kw">names</span>(outFiles),</a>
<a class="sourceLine" id="cb51-44" data-line-number="44">  <span class="dt">path =</span> <span class="kw">unlist</span>(outFiles),</a>
<a class="sourceLine" id="cb51-45" data-line-number="45">  <span class="dt">basename =</span> <span class="kw">basename</span>(<span class="kw">unlist</span>(outFiles))</a>
<a class="sourceLine" id="cb51-46" data-line-number="46">)</a>
<a class="sourceLine" id="cb51-47" data-line-number="47"></a>
<a class="sourceLine" id="cb51-48" data-line-number="48">fileLinks<span class="op">$</span>link &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;&lt;a href=&#39;&quot;</span>, fileLinks<span class="op">$</span>path, <span class="st">&quot;&#39;&gt;&quot;</span>, fileLinks<span class="op">$</span>basename, <span class="st">&quot;&lt;/a&gt;&quot;</span>)</a>
<a class="sourceLine" id="cb51-49" data-line-number="49"></a>
<a class="sourceLine" id="cb51-50" data-line-number="50"><span class="kw">kable</span>(fileLinks[, <span class="kw">c</span>(<span class="st">&quot;name&quot;</span>, <span class="st">&quot;link&quot;</span>)], <span class="dt">row.names =</span> <span class="ot">FALSE</span>, <span class="dt">caption =</span> <span class="st">&quot;Links to the result tables. &quot;</span>)</a></code></pre></div>
<table>
<caption>Links to the result tables.</caption>
<thead>
<tr class="header">
<th align="left">name</th>
<th align="left">link</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">All results (tsv)</td>
<td align="left"><a href='../results/result_table_all-molecules.tsv'>result_table_all-molecules.tsv</a></td>
</tr>
<tr class="even">
<td align="left">All results (xlsx)</td>
<td align="left"><a href='../results/result_table_all-molecules.xlsx'>result_table_all-molecules.xlsx</a></td>
</tr>
<tr class="odd">
<td align="left">FDR-based hits (xlsx)</td>
<td align="left"><a href='../results/result_table_FDR-hits.xlsx'>result_table_FDR-hits.xlsx</a></td>
</tr>
<tr class="even">
<td align="left">Arbidol-based hits (xlsx)</td>
<td align="left"><a href='../results/result_table_arbidol-hits.xlsx'>result_table_arbidol-hits.xlsx</a></td>
</tr>
<tr class="odd">
<td align="left">High confidence hits (xlsx)</td>
<td align="left"><a href='../results/result_table_HiConfidence-hits.xlsx'>result_table_HiConfidence-hits.xlsx</a></td>
</tr>
</tbody>
</table>
<hr />
</div>
<div id="libraries-and-versions" class="section level1">
<h1>Libraries and versions</h1>
<p>For the sake of reproducibility, we list hereafter the R libraries used to generate this report, as well as their versions.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" data-line-number="1"><span class="kw">sessionInfo</span>()</a></code></pre></div>
<pre><code>R version 3.6.1 (2019-07-05)
Platform: x86_64-apple-darwin15.6.0 (64-bit)
Running under: macOS Mojave 10.14.6

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRblas.0.dylib
LAPACK: /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRlapack.dylib

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] grid      stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] vioplot_0.3.4       zoo_1.8-7           sm_2.2-5.6          fitdistrplus_1.0-14 npsurv_0.4-0        lsei_1.2-0          survival_3.1-11     MASS_7.3-51.5       limma_3.40.6        VennDiagram_1.6.20  futile.logger_1.4.3 knitr_1.28          readxl_1.3.1        xlsx_0.6.3         

loaded via a namespace (and not attached):
 [1] Rcpp_1.0.4           highr_0.8            pillar_1.4.3         cellranger_1.1.0     compiler_3.6.1       formatR_1.7          futile.options_1.0.1 tools_3.6.1          digest_0.6.25        evaluate_0.14        tibble_3.0.0         lifecycle_0.2.0      lattice_0.20-40      pkgconfig_2.0.3     
[15] rlang_0.4.5          Matrix_1.2-18        cli_2.0.2            yaml_2.2.1           xfun_0.12            rJava_0.9-12         stringr_1.4.0        vctrs_0.2.4          xlsxjars_0.6.1       glue_1.3.2           rematch_1.0.1        fansi_0.4.1          tcltk_3.6.1          rmarkdown_2.1       
[29] lambda.r_1.2.4       magrittr_1.5         htmltools_0.4.0      ellipsis_0.3.0       splines_3.6.1        assertthat_0.2.1     stringi_1.4.6        crayon_1.3.4        </code></pre>
<hr />
<!-- ## To do -->
<!-- - Vérifier si les plaques où il y a plein de molécules comportent des molécules de la même famille structurelle -->
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
